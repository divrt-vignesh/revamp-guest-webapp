{"remainingRequest":"/home/vignesh/DIVRT/guest-webapp/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vignesh/DIVRT/guest-webapp/src/views/CheckedIn.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vignesh/DIVRT/guest-webapp/src/views/CheckedIn.vue","mtime":1687256519179},{"path":"/home/vignesh/DIVRT/guest-webapp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vignesh/DIVRT/guest-webapp/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/vignesh/DIVRT/guest-webapp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vignesh/DIVRT/guest-webapp/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBDYWxlbmRhciBmcm9tICcuLi91aUNvbXBvbmVudHMvQ2FsZW5kYXIvQ2FsZW5kYXInOwppbXBvcnQgRXN0aW1hdGUgZnJvbSAnLi4vY29tcG9uZW50cy9Fc3RpbWF0ZS52dWUnCmltcG9ydCBBUElIZWxwZXIgZnJvbSAiLi4vYXBpSGVscGVyIjsKaW1wb3J0ICJwcmltZXZ1ZS9yZXNvdXJjZXMvdGhlbWVzL3NhZ2EtYmx1ZS90aGVtZS5jc3MiICAgICAgIC8vdGhlbWUKaW1wb3J0ICJwcmltZXZ1ZS9yZXNvdXJjZXMvcHJpbWV2dWUubWluLmNzcyIgICAgICAgICAgICAgICAgIC8vY29yZSBjc3MKaW1wb3J0ICJwcmltZWljb25zL3ByaW1laWNvbnMuY3NzIgppbXBvcnQgR29vZ2xlUGF5IGZyb20gIi4vR29vZ2xlUGF5LnZ1ZSI7Ci8vIGltcG9ydCBsb2dnZXJIZWxwZXIgZnJvbSAiLi4vbG9nZ2VySGVscGVyIjsKaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gInZ1ZXgiOwovLyBpbXBvcnQgeyBRcmNvZGVTdHJlYW0gfSBmcm9tICJ2dWUtcXJjb2RlLXJlYWRlciI7CmltcG9ydCBRckNvZGVTY2FubmVyIGZyb20gIkAvdmlld3MvUXJDb2RlU2Nhbm5lci52dWUiOwppbXBvcnQgVmFsaWRhdGlvblFyQ29kZVNjYW5uZXIgZnJvbSAiQC92aWV3cy9WYWxpZGF0aW9uUXJDb2RlU2Nhbm5lci52dWUiOwppbXBvcnQgQXBwbGVQYXkgZnJvbSAiQC92aWV3cy9BcHBsZVBheS52dWUiOwppbXBvcnQgeyBmb3JtYXREYXRlVGltZSB9IGZyb20gIkAvdXRpbHMvZm9ybWF0RGF0ZVRpbWUiOwppbXBvcnQgeyBFdmVudEJ1cyB9IGZyb20gIkAvbGliL0V2ZW50QnVzIjsKaW1wb3J0IHsgc2Vjb25kc1RvSG1zIH0gZnJvbSAiQC91dGlscy9mb3JtYXREYXRlVGltZSI7CmltcG9ydCB7IGFkZE1pbnV0ZXMsIGFkZERheXMsIGFkZEhvdXJzLCBzZXQgfSBmcm9tICJkYXRlLWZucyI7CmltcG9ydCB7IGZvcm1hdCwgaXNWYWxpZCB9IGZyb20gImRhdGUtZm5zIjsKaW1wb3J0IHsgZGF0ZVRvVGltZVpvbmVEYXRlIH0gZnJvbSAiQC91dGlscy9mb3JtYXREYXRlVGltZSI7Ci8vIGltcG9ydCBRclNjYW5uZXIgZnJvbSAncXItc2Nhbm5lcic7CmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJDaGVja0luIiwKICAgIGNvbXBvbmVudHM6IHsgUXJDb2RlU2Nhbm5lciwgVmFsaWRhdGlvblFyQ29kZVNjYW5uZXIsIEFwcGxlUGF5LCBHb29nbGVQYXksIENhbGVuZGFyLCBFc3RpbWF0ZSB9LAogICAgZGF0YTogKCkgPT4gKHsKICAgICAgICAvLyBydWxlczogewogICAgICAgIC8vICAgY291bnRlcjogdmFsdWUgPT4gdmFsdWUubGVuZ3RoIDw9IDYgfHwgIk1heCA2IGNoYXJhY3RlcnMiCiAgICAgICAgLy8gfSwKICAgICAgICB0aW1lOiAiIiwKICAgICAgICBvcGVuVGltZVBpY2tlcjogZmFsc2UsCiAgICAgICAgb3BlbkRhdGVQaWNrZXI6IGZhbHNlLAogICAgICAgIG1pblRpbWVEYXRlOiBudWxsLAogICAgICAgIG1heFRpbWVEYXRlOiBudWxsLAogICAgICAgIGJlZm9yZUVzdGltYXRlOiBudWxsLAogICAgICAgIGN1cnJlbnREYXRlOiBmb3JtYXQoKG5ldyBEYXRlKCkpLCAneXl5eS1NTS1kZCcpLAogICAgICAgIGxveWFsdHkyNGtudW06ICIiLAogICAgICAgIGFsZXJ0SWNvbjogIm1kaS1jaGVjay1jaXJjbGUiLAogICAgICAgIGFsZXJ0RGlhbG9nOiBmYWxzZSwKICAgICAgICBhbGVydE1zZzogIiIsCiAgICAgICAgbG95YWx0eTogZmFsc2UsCiAgICAgICAgZXh0RGF0ZUFuZFRpbWU6IG51bGwsCiAgICAgICAgZXh0ZW5kQnRuTG9hZGluZzogZmFsc2UsCiAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgZXh0ZW5zaW9uRGlhbG9nOiBmYWxzZSwKICAgICAgICBzdG9wVGltZTogIiIsCiAgICAgICAgZXhpdFRpbWVTZWxlY3RlZDoge30sCiAgICAgICAgdGltZVBpY2tlckhyUmFuZ2U6IG51bGwsCiAgICAgICAgdGltZUV4Y2VlZGVkOiBmYWxzZSwKICAgICAgICB0aW1lUGlja2VyTWluUmFuZ2U6IG51bGwsCiAgICAgICAgbWluRGF0ZTogbnVsbCwKICAgICAgICBtYXhEYXRlOiBudWxsLAogICAgICAgIFRpbWVtZW51OiBmYWxzZSwKICAgICAgICBzdGFydERhdGU6ICIiLAogICAgICAgIG1heERhdGVUaW1lOiBudWxsLAogICAgICAgIGVzdGltYXRlOiBudWxsLAogICAgICAgIERhdGVtZW51OiBmYWxzZSwKICAgICAgICBleGl0RGF0ZTogbnVsbCwKICAgICAgICBkYXRlRm9ybWF0dGVkOiBudWxsLAogICAgICAgIGV4aXREYXRlVGltZTogMCwKICAgICAgICBleGl0VGltZUludGVydmFsOiBudWxsLAogICAgICAgIGlvc0RldmljZTogZmFsc2UsCiAgICAgICAgaW52YWxpZFZhbGlkYXRpb25RUkRpYWxvZzogZmFsc2UsCiAgICAgICAgY2FtZXJhU3RhdHVzOiBmYWxzZSwKICAgICAgICB2YWxpZGF0aW9uQ2FtZXJhU3RhdHVzOiBmYWxzZSwKICAgICAgICB2YWxpZGF0ZWREYXRlVGltZTogMCwKICAgICAgICBncmFjZVBlcmlvZFRpbWU6IDAsCiAgICAgICAgdmFsaWRhdGVkSW50ZXJ2YWw6ICIiLAogICAgICAgIGR1cmF0aW9uOiAzMDAsCiAgICAgICAgb2Zmc2V0OiAwLAogICAgICAgIHBlZGVzdHJpYW5BY2Nlc3NEaWFsb2c6IGZhbHNlLAogICAgICAgIHBlZGVzdHJpYW5BY2Nlc3NUZXh0OiAiIiwKICAgICAgICBlYXNpbmc6ICJlYXNlSW5PdXRDdWJpYyIsCiAgICAgICAgcGFnZUhlaWdodDogd2luZG93Lm91dGVySGVpZ2h0LAogICAgICAgIHFyQ29kZURpYWxvZzogZmFsc2UsCiAgICAgICAgY291bnRVcFRpbWU6ICIiLAogICAgICAgIGludGVydmFsOiAiIiwKICAgICAgICBpc1ZhbGlkOiB1bmRlZmluZWQsCiAgICAgICAgY2FtZXJhOiAiYXV0byIsCiAgICAgICAgc21zVGV4dDogIiIsCiAgICAgICAgc21zRGlhbG9nOiBmYWxzZSwKICAgICAgICBkaWFsZXJEaWFsb2c6IGZhbHNlLAogICAgICAgIGludmFsaWRRUk1zZzogIiIsCiAgICAgICAgaW52YWxpZFZhbGlkYXRpb25RUk1zZzogIiIsCiAgICAgICAgaW52YWxpZFFSRGlhbG9nOiBmYWxzZSwKICAgICAgICBpbnZhbGlkU01TTXNnOiAiIiwKCiAgICAgICAgaW52YWxpZFNNU0RpYWxvZzogZmFsc2UsCiAgICAgICAgc21zUGVuZGluZzogZmFsc2UsCiAgICAgICAgdmFsaWRhdGVCb29raW5nUGVuZGluZzogZmFsc2UsCiAgICAgICAgdmFsaWRhdGVCb29raW5nRGlhbG9nOiBmYWxzZSwKICAgICAgICB2YWxpZGF0ZUJvb2tpbmdUeHQ6ICIiLAogICAgICAgIHZhbGlkYXRlUVJDb2RlUGVuZGluZzogZmFsc2UsCiAgICAgICAgdmFsaWRhdGVRUkNvZGVEaWFsb2c6IGZhbHNlLAogICAgfSksCiAgICBjb21wdXRlZDogewogICAgICAgIC4uLm1hcEdldHRlcnMoewogICAgICAgICAgICBib29raW5nSWQ6ICJnZXR0ZXJCb29raW5nSWQiLAogICAgICAgICAgICBib29raW5nRGV0YWlsczogImdldHRlckJvb2tpbmdEZXRhaWxzIiwKICAgICAgICAgICAgem9uZURldGFpbHM6ICJnZXR0ZXJab25lRGV0YWlscyIsCiAgICAgICAgICAgIGVudHJ5VGltZTogImdldHRlckVudHJ5VGltZSIsCiAgICAgICAgICAgIGV4aXRHYXRlQ29kZXM6ICJnZXR0ZXJFeGl0R2F0ZUNvZGVzIiwKICAgICAgICAgICAgaXNQUVJFbmRSZXNlcnZhdGlvbjogImdldHRlclpvbmVJc1BRUkVuZFJlc2VydmF0aW9uIiwKCiAgICAgICAgfSksCiAgICAgICAgbG9nb0hlaWdodCgpIHsKICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuYm9va2luZ0RldGFpbHMsICdib29raW5nJykgJiYgT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodGhpcy5ib29raW5nRGV0YWlscy5ib29raW5nLCAnVHlwZU9mQm9va2luZycpICYmIHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy5UeXBlT2ZCb29raW5nID09ICdTZWxmIHJlc2VydmF0aW9uJyA/ICcxMDBweCcgOiAnMTUwcHgnOwogICAgICAgIH0sCiAgICAgICAgY29tcHV0ZWREYXRlRm9ybWF0dGVkKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy50aW1lICE9PSBudWxsICYmIHRoaXMudGltZSAhPT0gIiIgJiYgdGhpcy50aW1lICE9PSB1bmRlZmluZWQgPyBmb3JtYXQodGhpcy50aW1lLCAneXl5eS9NTS9kZCcpIDogbmV3IERhdGUoKQogICAgICAgIH0sCiAgICAgICAgZm9ybWF0dGVkVGltZSgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMudGltZSA/IGZvcm1hdCh0aGlzLnRpbWUsICdoaDptbSBhYScpIDogIiIKICAgICAgICB9LAogICAgICAgIGZvcm1hdHRlZERhdGVUaW1lKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy50aW1lICE9PSBudWxsICYmIHRoaXMudGltZSAhPT0gIiIgPyBmb3JtYXQodGhpcy50aW1lLCAnaWlpLCBMTEwgZGQnKSA6ICIiCiAgICAgICAgfSwKICAgICAgICBmb3JtYXR0ZWRZZWFyKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy50aW1lICE9PSBudWxsICYmIHRoaXMudGltZSAhPT0gIiIgPyBmb3JtYXQodGhpcy50aW1lLCAneXl5eScpIDogIiIKICAgICAgICB9LAogICAgICAgIGZvcm1hdHRlZEVudHJ5RGlzcGxheVRpbWUoKSB7CiAgICAgICAgICAgIHJldHVybiBPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLmJvb2tpbmdEZXRhaWxzLCAnYm9va2luZycpICYmIE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZywgJ2VudHJ5dGltZScpICYmIHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy5lbnRyeXRpbWUgIT09IG51bGwgJiYgdGhpcy5ib29raW5nRGV0YWlscy5ib29raW5nLmVudHJ5dGltZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy5lbnRyeXRpbWUgIT09ICIiID8gZm9ybWF0KG5ldyBEYXRlKHRoaXMuZm9ybWF0RXhpdERhdGVUaW1lKHRoaXMuYm9va2luZ0RldGFpbHM/LmJvb2tpbmc/LmVudHJ5dGltZSwgJ2RhdGUnKSksICJoaDptbSBhIikgOiBmb3JtYXQoZGF0ZVRvVGltZVpvbmVEYXRlKG5ldyBEYXRlKCksIHRoaXMuYm9va2luZ0RldGFpbHM/LnpvbmU/LnRpbWV6b25lKSwgJ2hoOm1tIGEnKTsKICAgICAgICB9LAogICAgICAgIHNpbmdsZVF1b3RlcygpIHsKCiAgICAgICAgICAgIHJldHVybiBPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLmJvb2tpbmdEZXRhaWxzLCAnem9uZScpICYmIE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuYm9va2luZ0RldGFpbHMuem9uZSwgJ3RpbWVQaWNrZXJDb25maWd1cmF0aW9uJykgJiYgdGhpcy5ib29raW5nRGV0YWlscy56b25lLnRpbWVQaWNrZXJDb25maWd1cmF0aW9uID09ICIwIiA/ICgodGhpcy50aW1lICE9PSBudWxsICYmIHRoaXMudGltZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMudGltZSAhPT0gIiIgJiYgdGhpcy5taW5EYXRlICE9PSBudWxsICYmIHRoaXMubWluRGF0ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMubWluRGF0ZSAhPT0gIiIgJiYgZm9ybWF0KHRoaXMudGltZSwgJ3l5eXktTU0tZGQnKSA9PSBmb3JtYXQodGhpcy5taW5EYXRlLCAneXl5eS1NTS1kZCcpKSB8fCAodGhpcy5iZWZvcmVFc3RpbWF0ZSAhPT0gbnVsbCAmJiB0aGlzLmJlZm9yZUVzdGltYXRlICE9PSB1bmRlZmluZWQgJiYgdGhpcy5iZWZvcmVFc3RpbWF0ZSAhPT0gIiIgJiYgdGhpcy5lc3RpbWF0ZSAhPT0gbnVsbCAmJiB0aGlzLmVzdGltYXRlICE9PSB1bmRlZmluZWQgJiYgdGhpcy5lc3RpbWF0ZSAhPT0gIiIgJiYgdGhpcy5iZWZvcmVFc3RpbWF0ZS5ncmFuZFRvdGFsID09IHRoaXMuZXN0aW1hdGUuZ3JhbmRUb3RhbCkpIDogdHJ1ZQogICAgICAgIH0sCiAgICAgICAgZG91YmxlUXVvdGVzKCkgewogICAgICAgICAgICByZXR1cm4gT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodGhpcy5ib29raW5nRGV0YWlscywgJ3pvbmUnKSAmJiBPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUsICd0aW1lUGlja2VyQ29uZmlndXJhdGlvbicpICYmIHRoaXMuYm9va2luZ0RldGFpbHMuem9uZS50aW1lUGlja2VyQ29uZmlndXJhdGlvbiA9PSAiMCIgPyAoKHRoaXMudGltZSAhPT0gbnVsbCAmJiB0aGlzLnRpbWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRpbWUgIT09ICIiICYmIHRoaXMubWluRGF0ZSAhPT0gbnVsbCAmJiB0aGlzLm1pbkRhdGUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLm1pbkRhdGUgIT09ICIiICYmIGZvcm1hdCh0aGlzLnRpbWUsICd5eXl5LU1NLWRkJykgIT0gZm9ybWF0KHRoaXMubWluRGF0ZSwgJ3l5eXktTU0tZGQnKSkgJiYgKHRoaXMuYmVmb3JlRXN0aW1hdGUgIT09IG51bGwgJiYgdGhpcy5iZWZvcmVFc3RpbWF0ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuYmVmb3JlRXN0aW1hdGUgIT09ICIiICYmIHRoaXMuZXN0aW1hdGUgIT09IG51bGwgJiYgdGhpcy5lc3RpbWF0ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuZXN0aW1hdGUgIT09ICIiICYmIHRoaXMuYmVmb3JlRXN0aW1hdGUuZ3JhbmRUb3RhbCAhPSB0aGlzLmVzdGltYXRlLmdyYW5kVG90YWwpKSA6IGZhbHNlCiAgICAgICAgfSwKICAgICAgICBkaXNhYmxlTG95YWx0eSgpIHsKICAgICAgICAgICAgbGV0IGRpc2FibGVkID0gdGhpcy5sb3lhbHR5MjRrbnVtID09PSB1bmRlZmluZWQgfHwgdGhpcy5sb3lhbHR5MjRrbnVtID09PSBudWxsIHx8IHRoaXMubG95YWx0eTI0a251bSA9PSAiIgogICAgICAgICAgICByZXR1cm4gZGlzYWJsZWQKICAgICAgICB9LAogICAgICAgIGRpc2FibGVFeHRlbmQoKSB7CiAgICAgICAgICAgIGxldCBkaXNhYmxlZCA9ICgKICAgICAgICAgICAgICAgIHRoaXMudGltZSA9PT0gbnVsbCB8fCB0aGlzLnRpbWUgPT09ICIiIHx8IHRoaXMudGltZSA9PT0gdW5kZWZpbmVkIHx8IHRoaXMuZXN0aW1hdGUgPT09IG51bGwgfHwgdGhpcy5lc3RpbWF0ZSA9PT0gdW5kZWZpbmVkIHx8IE9iamVjdC5rZXlzKHRoaXMuZXN0aW1hdGUpLmxlbmd0aCA9PT0gMCkgfHwgKHRoaXMuYm9va2luZ0RldGFpbHM/LnpvbmU/LnRpbWVQaWNrZXJDb25maWd1cmF0aW9uID09ICcwJyAmJiAoZm9ybWF0KHRoaXMudGltZSwgJ3l5eXktTU0tZGQnKSA9PSBmb3JtYXQodGhpcy5tYXhEYXRlLCAneXl5eS1NTS1kZCcpKSA/IHRydWUgOiBmYWxzZSkKICAgICAgICAgICAgcmV0dXJuIGRpc2FibGVkOwogICAgICAgIH0sCiAgICAgICAgY291bnREb3duRXhpdFRpbWUoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmV4aXREYXRlVGltZSA8IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgiU0VUX1ZBTElEQVRFRF9USU1FX1NUQVRVUyIsIHRydWUpOwogICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmV4aXRUaW1lSW50ZXJ2YWwpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBzZWNvbmRzVG9IbXModGhpcy5leGl0RGF0ZVRpbWUgLyAxMDAwICsgNTkpOwogICAgICAgIH0sCiAgICAgICAgY291bnREb3duRXN0aW1hdGVUaW1lKCkgewogICAgICAgICAgICBpZiAodGhpcy5leGl0RGF0ZVRpbWUgPCAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoIlNFVF9WQUxJREFURURfVElNRV9TVEFUVVMiLCB0cnVlKTsKICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5leGl0VGltZUludGVydmFsKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gc2Vjb25kc1RvSG1zKHRoaXMuZXhpdERhdGVUaW1lIC8gMTAwMCArIDU5KTsKICAgICAgICB9LAogICAgICAgIGlzRXh0cmEoKSB7CiAgICAgICAgICAgIHJldHVybiB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuaW5jbHVkZXMoIi9neC8iKTsKICAgICAgICB9LAogICAgICAgIG9wdGlvbnMoKSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBkdXJhdGlvbjogdGhpcy5kdXJhdGlvbiwKICAgICAgICAgICAgICAgIG9mZnNldDogdGhpcy5vZmZzZXQsCiAgICAgICAgICAgICAgICBlYXNpbmc6IHRoaXMuZWFzaW5nLAogICAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgc2hvd1BheW1lbnRDYXJkQWRkZWQ6IGZ1bmN0aW9uIGdldENhcmRTdGF0dXMoKSB7CiAgICAgICAgICAgIHZhciBjYXJkT25GaWxlID0gdGhpcy5ib29raW5nRGV0YWlscz8uYm9va2luZz8uY2FyZE9uZmlsZQogICAgICAgICAgICAgICAgPyB0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcuY2FyZE9uZmlsZQogICAgICAgICAgICAgICAgOiBudWxsOwogICAgICAgICAgICB2YXIgdmFsaWRhdGVkU3RhdGUgPSB0aGlzLmJvb2tpbmdEZXRhaWxzPy5ib29raW5nPy52YWxpZGF0ZWQKICAgICAgICAgICAgICAgID8gdGhpcy5ib29raW5nRGV0YWlscy5ib29raW5nLnZhbGlkYXRlZAogICAgICAgICAgICAgICAgOiBudWxsOwogICAgICAgICAgICB2YXIgc3RhdGUgPQogICAgICAgICAgICAgICAgY2FyZE9uRmlsZSA9PSAiMSIKICAgICAgICAgICAgICAgICAgICA/IHRydWUKICAgICAgICAgICAgICAgICAgICA6IGNhcmRPbkZpbGUgPT0gIjIiICYmCiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVkU3RhdGUgPT0gIjEiICYmCiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWxpZGF0ZWREYXRlVGltZSA+IDA7CiAgICAgICAgICAgIHJldHVybiBzdGF0ZTsKICAgICAgICB9LAogICAgICAgIHRpbWVBZ286IGZ1bmN0aW9uIGdldFRpbWVBZ28oKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvdW50VXBUaW1lOwogICAgICAgIH0sCiAgICAgICAgdmFsaWRhdGlvblBlbmRpbmc6IGZ1bmN0aW9uIHFyVmFsaWRhdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNWYWxpZCA9PT0gdW5kZWZpbmVkICYmIHRoaXMuY2FtZXJhID09PSAib2ZmIjsKICAgICAgICB9LAogICAgICAgIGJvb2tpbmdfY29udGVudCgpIHsKICAgICAgICAgICAgbGV0IGRhdGVUaW1lID0gZm9ybWF0RGF0ZVRpbWUoCiAgICAgICAgICAgICAgICBOdW1iZXIodGhpcy5ib29raW5nRGV0YWlscy5ib29raW5nLmVudHJ5dGltZSkKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuIGRhdGVUaW1lWzBdICsgIiBvbiAiICsgZGF0ZVRpbWVbMV0gKyAiICIgKyBkYXRlVGltZVsyXTsKICAgICAgICB9LAogICAgICAgIGNoZWNraW5fY29udGVudCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0RXhpdERhdGVUaW1lKHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy5lbnRyeXRpbWUsICdjaGVja2luJyk7CiAgICAgICAgfSwKICAgICAgICBjaGVja291dF9jb250ZW50KCkgewogICAgICAgICAgICByZXR1cm4gJ0NoZWNrb3V0IGJlZm9yZSAnICsgdGhpcy5mb3JtYXRFeGl0RGF0ZVRpbWUodGhpcy5ib29raW5nRGV0YWlscy5ib29raW5nLnJldkVuZCwgJ2V4cGlyZScpCiAgICAgICAgfSwKICAgICAgICB2YWxpZGF0ZWRfY29udGVudCgpIHsKICAgICAgICAgICAgaWYgKHRoaXMuYm9va2luZ0RldGFpbHM/LnpvbmU/LnRpbWV6b25lb2Zmc2V0KSB7CiAgICAgICAgICAgICAgICBsZXQgZGF0ZVRpbWUgPSB0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcudHlwZSA9PSAiMTMiID8gZm9ybWF0RGF0ZVRpbWUoCiAgICAgICAgICAgICAgICAgICAgTnVtYmVyKHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy5yZXZTdGFydCkgKwogICAgICAgICAgICAgICAgICAgIE51bWJlcih0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcuY291cG9uVmFsaWRUaW1lKQogICAgICAgICAgICAgICAgKSA6IGZvcm1hdERhdGVUaW1lKAogICAgICAgICAgICAgICAgICAgIE51bWJlcih0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcuZW50cnl0aW1lKSArCiAgICAgICAgICAgICAgICAgICAgTnVtYmVyKHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy5jb3Vwb25WYWxpZFRpbWUpCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgcmV0dXJuIGRhdGVUaW1lWzBdICsgIiwgIiArIGRhdGVUaW1lWzFdICsgIiAiICsgZGF0ZVRpbWVbMl07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICIiOwogICAgICAgIH0sCiAgICAgICAgY291bnREb3duVmFsaWRhdGVkVGltZSgpIHsKICAgICAgICAgICAgaWYgKHRoaXMudmFsaWRhdGVkRGF0ZVRpbWUgPCAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoIlNFVF9WQUxJREFURURfVElNRV9TVEFUVVMiLCB0cnVlKTsKICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy52YWxpZGF0ZWRJbnRlcnZhbCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2Vjb25kc1RvSG1zKHRoaXMudmFsaWRhdGVkRGF0ZVRpbWUgLyAxMDAwICsgNTkpOwogICAgICAgIH0sCiAgICAgICAgY291bnREb3duR3JhY2VQZXJpb2RUaW1lKCkgewogICAgICAgICAgICBpZiAodGhpcy5ncmFjZVBlcmlvZFRpbWUgPCAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoIlNFVF9HUkFDRV9QRVJJT0RfVElNRV9TVEFUVVMiLCB0cnVlKTsKICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5ncmFjZVBlcmlvZEludGVydmFsKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL2FkZCA1OSBzZWMgdG8gZ3JhY2VwZXJpb2QgdGltZSB0byBza2lwIDAgbWluLgogICAgICAgICAgICByZXR1cm4gdGhpcy5zZWNvbmRzVG9IbXModGhpcy5ncmFjZVBlcmlvZFRpbWUgLyAxMDAwICsgNTkpOwogICAgICAgIH0sCiAgICAgICAgLy8gZ3JhY2VQZXJpb2RDb3VudERvd25UaW1lLAogICAgICAgIC8vIGNvdW50RG93blZhbGlkYXRpb250aW1lKCl7CiAgICAgICAgLy8gICByZXR1cm4KICAgICAgICAvLyB9CiAgICB9LAogICAgd2F0Y2g6IHsKICAgICAgICB0aW1lKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgICAgICAgIGlmIChvbGRWYWwgIT0gbnVsbCAmJiBuZXdWYWwgIT0gbnVsbCAmJiBvbGRWYWwgIT0gbmV3VmFsICYmIG9sZFZhbCAhPSAiIiAmJiBuZXdWYWwgIT0gIiIgJiYgKGlzVmFsaWQobmV3VmFsKSkpIHsKICAgICAgICAgICAgICAgIHRoaXMuYm9va2luZ0RldGFpbHM/LnpvbmU/LnRpbWVQaWNrZXJDb25maWd1cmF0aW9uID09ICcxJyA/IHRoaXMucm91bmQobmV3VmFsKSA6IHNldChuZXdWYWwsIHsgaG91cjogMjMsIG1pbnV0ZXM6IDU5LCBzZWNvbmRzOiA1OSB9KQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgIH0sCiAgICBjcmVhdGVkKCkgeyB9LAogICAgbW91bnRlZDogZnVuY3Rpb24gKCkgewogICAgICAgIEV2ZW50QnVzLiRvbignU0VUX1RJTUUnLCAoKSA9PiB7CiAgICAgICAgICAgIHRoaXMub25UaW1lUGlja2VyQ2hhbmdlKCk7CiAgICAgICAgfSkKICAgICAgICB0aGlzLmV4aXREYXRlVGltZSA9IHRoaXMuY2FsY3VsYXRlRXhpdERhdGVUaW1lKCk7CiAgICAgICAgdGhpcy5leGl0VGltZUludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICB0aGlzLmJvb2tpbmdEZXRhaWxzPy56b25lPy50aW1lem9uZQoKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICB0aGlzLmV4aXREYXRlVGltZSA9IHRoaXMuY2FsY3VsYXRlRXhpdERhdGVUaW1lKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCAxMDAwKTsKICAgICAgICBpZiAoCiAgICAgICAgICAgIHRoaXMuZW50cnlUaW1lICE9IG51bGwgJiYKICAgICAgICAgICAgIXRoaXMuYm9va2luZ0RldGFpbHM/LmJvb2tpbmc/LmV4aXR0aW1lICYmCiAgICAgICAgICAgIHRoaXMuYm9va2luZ0RldGFpbHM/LnpvbmU/LnRpbWV6b25lICYmCiAgICAgICAgICAgIHRoaXMuYm9va2luZ0RldGFpbHM/LmJvb2tpbmc/LmdyYWNlUGVyaW9kCiAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuY291bnRVcFRpbWUgPSB0aGlzLmNhbGN1bGF0ZVBhcmtpbmdUaW1lKAogICAgICAgICAgICAgICAgdGhpcy5lbnRyeVRpbWUsCiAgICAgICAgICAgICAgICB0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcuZ3JhY2VQZXJpb2QsCiAgICAgICAgICAgICAgICB0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUudGltZXpvbmUKICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgdGhpcy5lbnRyeVRpbWUgIT0gbnVsbCAmJgogICAgICAgICAgICAgICAgIXRoaXMuYm9va2luZ0RldGFpbHM/LmJvb2tpbmc/LmV4aXR0aW1lICYmCiAgICAgICAgICAgICAgICB0aGlzLmJvb2tpbmdEZXRhaWxzPy56b25lPy50aW1lem9uZSAmJgogICAgICAgICAgICAgICAgdGhpcy5ib29raW5nRGV0YWlscz8uYm9va2luZz8uZ3JhY2VQZXJpb2QKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICB0aGlzLmNvdW50VXBUaW1lID0gdGhpcy5jYWxjdWxhdGVQYXJraW5nVGltZSgKICAgICAgICAgICAgICAgICAgICB0aGlzLmVudHJ5VGltZSwKICAgICAgICAgICAgICAgICAgICB0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcuZ3JhY2VQZXJpb2QsCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib29raW5nRGV0YWlscy56b25lLnRpbWV6b25lCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgaWYgKAogICAgICAgICAgICB0aGlzLmJvb2tpbmdEZXRhaWxzPy5ib29raW5nPy5leGl0dGltZSAmJgogICAgICAgICAgICB0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcuZXhpdHRpbWUgIT0gbnVsbCAmJgogICAgICAgICAgICB0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcuZXhpdHRpbWUgIT0gIiIKICAgICAgICApIHsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTsKICAgICAgICB9CiAgICAgICAgaWYgKAogICAgICAgICAgICB0aGlzLmJvb2tpbmdEZXRhaWxzPy5ib29raW5nPy52YWxpZGF0ZWQgJiYKICAgICAgICAgICAgdGhpcy5ib29raW5nRGV0YWlscy5ib29raW5nLnZhbGlkYXRlZCA9PSAiMSIgJiYKICAgICAgICAgICAgdGhpcy5ib29raW5nRGV0YWlscz8uYm9va2luZz8udmFsaWRhdGlvblR5cGUgJiYKICAgICAgICAgICAgdGhpcy5ib29raW5nRGV0YWlscy5ib29raW5nLnZhbGlkYXRpb25UeXBlID09ICJESVZSVCIKICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy52YWxpZGF0ZWREYXRlVGltZSA9IHRoaXMuY2FsY3VsYXRlVmFsaWRhdGVkVGltZSgpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy52YWxpZGF0ZWRJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgdGhpcy5ib29raW5nRGV0YWlscz8uem9uZT8udGltZXpvbmUgJiYKICAgICAgICAgICAgICAgIHRoaXMuYm9va2luZ0RldGFpbHM/LmJvb2tpbmc/LnZhbGlkYXRlZCAmJgogICAgICAgICAgICAgICAgdGhpcy5ib29raW5nRGV0YWlscy5ib29raW5nLnZhbGlkYXRlZCA9PSAiMSIgJiYKICAgICAgICAgICAgICAgIHRoaXMuYm9va2luZ0RldGFpbHM/LmJvb2tpbmc/LnZhbGlkYXRpb25UeXBlICYmCiAgICAgICAgICAgICAgICB0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcudmFsaWRhdGlvblR5cGUgPT0gIkRJVlJUIgogICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGVkRGF0ZVRpbWUgPSB0aGlzLmNhbGN1bGF0ZVZhbGlkYXRlZFRpbWUoKTsKICAgICAgICAgICAgfQogICAgICAgIH0sIDEwMDApOwogICAgICAgIGlmICgKICAgICAgICAgICAgdGhpcy5ib29raW5nRGV0YWlscz8uYm9va2luZz8udmFsaWRhdGVkICYmCiAgICAgICAgICAgIHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy52YWxpZGF0ZWQgPT0gIjEiICYmCiAgICAgICAgICAgIHRoaXMuYm9va2luZ0RldGFpbHM/LmJvb2tpbmc/LnZhbGlkYXRpb25UeXBlICYmCiAgICAgICAgICAgIHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy52YWxpZGF0aW9uVHlwZSA9PSAiRElWUlQiCiAgICAgICAgKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkYXRlZERhdGVUaW1lIDwgMCkgewogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJTRVRfVkFMSURBVEVEX1RJTUVfU1RBVFVTIiwgdHJ1ZSk7CiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudmFsaWRhdGVkSW50ZXJ2YWwpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5ib29raW5nRGV0YWlscz8uYm9va2luZz8uZ3JhY2VQZXJpb2QgPiAwKSB7CiAgICAgICAgICAgIHRoaXMuZ3JhY2VQZXJpb2RUaW1lID0gdGhpcy5jYWxjdWxhdGVHcmFjZVBlcmlvZFRpbWUoKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuZ3JhY2VQZXJpb2RJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHsKICAgICAgICAgICAgaWYgKHRoaXMuYm9va2luZ0RldGFpbHM/LnpvbmU/LnRpbWV6b25lKSB7CiAgICAgICAgICAgICAgICB0aGlzLmdyYWNlUGVyaW9kVGltZSA9IHRoaXMuY2FsY3VsYXRlR3JhY2VQZXJpb2RUaW1lKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCAxMDAwKTsKICAgICAgICBpZiAodGhpcy5ib29raW5nRGV0YWlscz8uYm9va2luZz8uZ3JhY2VQZXJpb2QgPiAwKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmdyYWNlUGVyaW9kVGltZSA8IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgiU0VUX0dSQUNFX1BFUklPRF9USU1FX1NUQVRVUyIsIHRydWUpOwogICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmdyYWNlUGVyaW9kSW50ZXJ2YWwpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIEV2ZW50QnVzLiRvbigic21zLXFyLXJlc3VsdCIsIChyZXN1bHQpID0+IHsKICAgICAgICAgICAgdGhpcy5vbkRlY29kZShyZXN1bHQpOwogICAgICAgIH0pOwogICAgICAgIEV2ZW50QnVzLiRvbigidmFsaWRhdGlvbi1xci1yZXN1bHQiLCAocmVzdWx0KSA9PiB7CiAgICAgICAgICAgIHRoaXMub25WYWxpZGF0ZVFSQ29kZShyZXN1bHQpOwogICAgICAgIH0pOwoKICAgICAgICAvLyBpZih0aGlzLmJvb2tpbmdEZXRhaWxzPy56b25lPy5pc1BlZGVzdHJpYW49PScxJyl7CiAgICAgICAgLy8gICB0aGlzLnBlZGVzdHJpYW5BY2Nlc3M9dHJ1ZQogICAgICAgIC8vIH0KICAgIH0sCiAgICBkZXN0cm95ZWQoKSB7CiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTsKICAgICAgICBjbGVhckludGVydmFsKHRoaXMudmFsaWRhdGVkSW50ZXJ2YWwpOwogICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5ncmFjZVBlcmlvZEludGVydmFsKTsKICAgIH0sCiAgICBiZWZvcmVSb3V0ZUVudGVyKHRvLCBmcm9tLCBuZXh0KSB7CiAgICAgICAgbmV4dChhc3luYyAodm0pID0+IHsKICAgICAgICAgICAgdm0uZ2V0TW9iaWxlT3BlcmF0aW5nU3lzdGVtKCkgPT09ICdpT1MnID8gdm0uaW9zRGV2aWNlID0gdHJ1ZSA6IHZtLmlvc0RldmljZSA9IGZhbHNlOwogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICB2bS5ib29raW5nRGV0YWlscz8uYm9va2luZz8uZXhpdHRpbWUgJiYKICAgICAgICAgICAgICAgIHZtLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcuZXhpdHRpbWUgIT0gbnVsbCAmJgogICAgICAgICAgICAgICAgdm0uYm9va2luZ0RldGFpbHMuYm9va2luZy5leGl0dGltZSAhPSAiIgogICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodm0uaW50ZXJ2YWwpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh2bS5ib29raW5nRGV0YWlscz8uYm9va2luZz8udmFsaWRhdGVkID09ICIwIikgewogICAgICAgICAgICAgICAgaWYgKHZtLnZhbGlkYXRlZERhdGVUaW1lIDwgMCkgewogICAgICAgICAgICAgICAgICAgIHZtLiRzdG9yZS5jb21taXQoIlNFVF9WQUxJREFURURfVElNRV9TVEFUVVMiLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHZtLnZhbGlkYXRlZEludGVydmFsKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBmb3JtYXRFeGl0RGF0ZVRpbWUodGltZSwgdmFsKSB7CiAgICAgICAgICAgIGlmICh0aW1lICE9PSBudWxsICYmIHRpbWUgIT09IHVuZGVmaW5lZCAmJiB0aW1lICE9ICcnKSB7CiAgICAgICAgICAgICAgICBsZXQgdXRjRGF0ZSA9IG5ldyBEYXRlKHRpbWUgKiAxMDAwKS50b1VUQ1N0cmluZygpOyAvLyJXZWQsIDI3IEphbiAyMDIxIDEzOjU5OjA0IEdNVCIKICAgICAgICAgICAgICAgIGxldCBtb250aCA9IHV0Y0RhdGUuc3BsaXQoIiwiKVsxXS5zcGxpdCgiICIpWzJdOyAvLyBKYW4KICAgICAgICAgICAgICAgIGxldCBkYXRlID0gdXRjRGF0ZS5zcGxpdCgiLCIpWzFdLnNwbGl0KCIgIilbMV07IC8vIDI3CiAgICAgICAgICAgICAgICBsZXQgeWVhciA9IHV0Y0RhdGUuc3BsaXQoIiwiKVsxXS5zcGxpdCgiICIpWzNdOwogICAgICAgICAgICAgICAgbGV0IGhyID0gdXRjRGF0ZS5zcGxpdCgiLCIpWzFdLnNwbGl0KCIgIilbNF0uc3BsaXQoIjoiKVswXTsgLy8gMTMKICAgICAgICAgICAgICAgIGxldCBtaW4gPSB1dGNEYXRlLnNwbGl0KCIsIilbMV0uc3BsaXQoIiAiKVs0XS5zcGxpdCgiOiIpWzFdOyAvLzU5CiAgICAgICAgICAgICAgICBsZXQgZm9ybWF0SHIgPSBOdW1iZXIoaHIpID4gMTIgPyBOdW1iZXIoaHIpIC0gMTIgOiBOdW1iZXIoaHIpOyAvLyAxCiAgICAgICAgICAgICAgICBmb3JtYXRIciA9IE51bWJlcihocikgPT0gMCA/IDEyIDogZm9ybWF0SHI7CgogICAgICAgICAgICAgICAgZm9ybWF0SHIgPSBOdW1iZXIoZm9ybWF0SHIpID49IDEwID8gTnVtYmVyKGZvcm1hdEhyKSA6ICcwJyArIGZvcm1hdEhyOyAvLzAxCiAgICAgICAgICAgICAgICBsZXQgYW1PcnBtID0gTnVtYmVyKGhyKSA+PSAxMiA/ICJwIiA6ICJhIjsgLy9QTQogICAgICAgICAgICAgICAgbGV0IGFtcG0gPSBOdW1iZXIoaHIpID49IDEyID8gIlBNIiA6ICJBTSI7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKHZhbCkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2hvdXInOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmb3JtYXRIciArIGFtT3JwbTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWlucyc6IHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1pbgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXNlICdkYXRlJzogewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9udGggKyAiICIgKyBkYXRlICsgIiwgIiArIHllYXIgKyAiICIgKyBmb3JtYXRIciArICI6IiArIG1pbiArICIgIiArIGFtcG07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2V4cGlyZSc6IHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZvcm1hdEhyICsgIjoiICsgbWluICsgIiAiICsgYW1wbSArICcgb24gJyArIG1vbnRoICsgIiAiICsgZGF0ZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXNlICdjaGVja2luJzogewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0SHIgKyAiOiIgKyBtaW4gKyAiICIgKyBhbXBtICsgJyBvbiAnICsgbW9udGggKyAiICIgKyBkYXRlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vSmFuIDI3LCAwMTo1OSBQTQogICAgICAgIH0sCiAgICAgICAgcm91bmQodGltZSkgewogICAgICAgICAgICBsZXQgZXhpdGRhdGUgPSB0aW1lICE9PSBudWxsICYmIHRpbWUgIT09ICcnID8gZm9ybWF0KHRpbWUsICd5eXl5L01NL2RkJykgOiBuZXcgRGF0ZSgpOwogICAgICAgICAgICBsZXQgc2VsZWN0ZWRNaW5zID0gdGltZSAhPT0gbnVsbCAmJiB0aW1lICE9PSAnJyA/IGZvcm1hdCh0aW1lLCAnbW0nKSA6IG5ldyBEYXRlKCk7CiAgICAgICAgICAgIGxldCBzZWxlY3RlZEhvdXJzID0gdGltZSAhPT0gbnVsbCAmJiB0aW1lICE9PSAnJyA/IGZvcm1hdCh0aW1lLCAnaGgnKSA6IG5ldyBEYXRlKCk7CiAgICAgICAgICAgIGxldCBzZWxlY3RlZEFNUE0gPSB0aW1lICE9PSBudWxsICYmIHRpbWUgIT09ICcnID8gZm9ybWF0KHRpbWUsICdhJykgOiBuZXcgRGF0ZSgpOwogICAgICAgICAgICBpZiAoZXhpdGRhdGUgIT0gbnVsbCAmJiBzZWxlY3RlZE1pbnMgIT0gJzE1JyAmJiBzZWxlY3RlZE1pbnMgIT0gJzMwJyAmJiBzZWxlY3RlZE1pbnMgIT0gJzQ1JyAmJiBzZWxlY3RlZE1pbnMgIT0gJzAwJyAmJiBzZWxlY3RlZE1pbnMgIT0gbnVsbCAmJiBzZWxlY3RlZE1pbnMgIT0gIiIgJiYgc2VsZWN0ZWRIb3VycyAhPSBudWxsICYmIHNlbGVjdGVkSG91cnMgIT0gIiIgJiYgc2VsZWN0ZWRBTVBNICE9IG51bGwgJiYgc2VsZWN0ZWRBTVBNICE9ICIiKSB7CiAgICAgICAgICAgICAgICBsZXQgaW50ZXJ2YWxNaWxsaXNlY29uZHMgPSA5MDAwMDAKICAgICAgICAgICAgICAgIGxldCBkYXRldGltZSA9IG5ldyBEYXRlKGV4aXRkYXRlICsgIiAiICsgc2VsZWN0ZWRIb3VycyArICI6IiArIHNlbGVjdGVkTWlucyArICIgIiArIHNlbGVjdGVkQU1QTSkKICAgICAgICAgICAgICAgIGxldCBpbnRlcnZhbCA9IGRhdGV0aW1lLmdldFRpbWUoKSAlIGludGVydmFsTWlsbGlzZWNvbmRzOwogICAgICAgICAgICAgICAgbGV0IGRlbHRhID0gaW50ZXJ2YWwgPT09IDAgPyAwIDogZGF0ZXRpbWUuZ2V0VGltZSgpIC0gaW50ZXJ2YWw7CiAgICAgICAgICAgICAgICBkZWx0YSArPSBpbnRlcnZhbE1pbGxpc2Vjb25kczsKICAgICAgICAgICAgICAgIC8vIHRoaXMuZXhpdFRpbWVTZWxlY3RlZCA9IE9iamVjdC5hc3NpZ24odGhpcy5leGl0VGltZVNlbGVjdGVkLCB7IGhoOiBmb3JtYXQobmV3IERhdGUoZGVsdGEpLCAnaGgnKSwgbW06IGZvcm1hdChuZXcgRGF0ZShkZWx0YSksICdtbScpLCBhOiBmb3JtYXQobmV3IERhdGUoZGVsdGEpLCAnYScpLCB9KQogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGRlbHRhKQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBsb3lhbHR5VmFsaWQoKSB7CiAgICAgICAgICAgIGlmICghKC9eW2EtejAtOV0rJC9pKS50ZXN0KHRoaXMubG95YWx0eTI0a251bSkpIHsKICAgICAgICAgICAgICAgIHRoaXMubG95YWx0eTI0a251bSA9IHRoaXMubG95YWx0eTI0a251bS5yZXBsYWNlKC9bXlx3XHNdL2dpLCAnJykKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgc3VibWl0TG95YWx0eShjb2RlKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB0aGlzLnZhbGlkYXRlQm9va2luZ1BlbmRpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHRoaXMudmFsaWRhdGVCb29raW5nKGNvZGUpOwogICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuZGF0YS5zdGF0dXMpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRTTVNNc2cgPSByZXN1bHQ/LmRhdGE/Lm1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICAgICAgPyByZXN1bHQuZGF0YS5tZXNzYWdlCiAgICAgICAgICAgICAgICAgICAgICAgIDogIlZhbGlkYXRpb24gbm90IHJlY29nbml6ZWQuIFBsZWFzZSB0cnkgYWdhaW4iOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZFNNU0RpYWxvZyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWxpZGF0ZUJvb2tpbmdQZW5kaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3N0VG9Mb2dnZXJBUEkoewogICAgICAgICAgICAgICAgICAgICAgICBwaG9uZTogdGhpcy5ib29raW5nRGV0YWlscy51c2VyLmNvbnRhY3QsCiAgICAgICAgICAgICAgICAgICAgICAgIHJlZklkOiB0aGlzLmJvb2tpbmdJZCwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHRoaXMuaW52YWxpZFNNU01zZywKICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogInJlZGVlbSIsCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRXJyb3IgaW4gdmFsaWRhdGluZyB0aGUgc2Vzc2lvbiBvbiBlbnRlcmluZyB2YWxpZGF0aW9uIGNvZGUgLSAiICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGVCb29raW5nVHh0LAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc3RUb0xvZ2dlckFQSSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHBob25lOiB0aGlzLmJvb2tpbmdEZXRhaWxzLnVzZXIuY29udGFjdCwKICAgICAgICAgICAgICAgICAgICAgICAgcmVmSWQ6IHRoaXMuYm9va2luZ0lkLAogICAgICAgICAgICAgICAgICAgICAgICBpY29uOiAicmVkZWVtIiwKICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJQYXJrZXIgdmFsaWRhdGVkIHRoZSBzZXNzaW9uIHN1Y2Nlc3NmdWxseSBieSBlbnRlcmluZyB2YWxpZGF0aW9uIGNvZGUgLSAiICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGVCb29raW5nVHh0LAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGVCb29raW5nUGVuZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGVCb29raW5nRGlhbG9nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KAogICAgICAgICAgICAgICAgICAgICAgICAiU0VUX1ZBTElEQVRFRF9NRVJDSEFOVCIsCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdD8uZGF0YT8ubWVyY2hhbnROYW1lCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSh7IHBhdGg6ICIvdmFsaWRhdGVzdWNjZXNzIiB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGVCb29raW5nUGVuZGluZyA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBjbG9zZUFsZXJ0RGlhbG9nKCkgewogICAgICAgICAgICB0aGlzLmFsZXJ0RGlhbG9nID0gZmFsc2U7CgogICAgICAgIH0sCiAgICAgICAgZ2V0UGF5bWVudFR5cGUodHlwZSkgewogICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgJ0FQUExFX1BBWSc6IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ0FwcGxlIFBheSc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXNlICdHT09HTEVfUEFZJzogewogICAgICAgICAgICAgICAgICAgIHJldHVybiAnR29vZ2xlIFBheScKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhc2UgJ0NhcmQnOiB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdDYXJkJwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgLyoqIEBtZXRob2RzIHRvIGZpbmQgdGhlIHRoZSBVVEMgZGF0ZSAKICAgIEBwYXJhbXMgdGhlIGJvb2tpbmdzIGRhdGUgdmFsdWUgLCB0eXBlICdleGl0ICgyMDIzLTEyLTAyKScgb3IgJ2Zvcm1hdGRhdGUgKDEyLzAyLzIwMjMpJwogICAgKi8KICAgICAgICBmb3JtYXRVVENEZWZhdWx0RGF0ZShkZWZhdWx0RGF0ZSwgdHlwZSkgewogICAgICAgICAgICBsZXQgdXRjRGF0ZSA9IG5ldyBEYXRlKGRlZmF1bHREYXRlICogMTAwMCkudG9VVENTdHJpbmcoKTsKICAgICAgICAgICAgbGV0IG1vbnRoID0gdXRjRGF0ZS5zcGxpdCgiLCIpWzFdLnNwbGl0KCIgIilbMl07IC8vIEphbgogICAgICAgICAgICBsZXQgZGF0ZSA9IHV0Y0RhdGUuc3BsaXQoIiwiKVsxXS5zcGxpdCgiICIpWzFdOyAvLyAyNwogICAgICAgICAgICBsZXQgeWVhciA9IHV0Y0RhdGUuc3BsaXQoIiwiKVsxXS5zcGxpdCgiICIpWzNdOyAvLzIwMjMKICAgICAgICAgICAgbGV0IGV4aXRmb3JtYXQgPSBmb3JtYXQobmV3IERhdGUobW9udGggKyAiICIgKyBkYXRlICsgIiAiICsgeWVhciksICd5eXl5LU1NLWRkJyk7CiAgICAgICAgICAgIGxldCBkYXRlZm9ybWF0ID0gZm9ybWF0KG5ldyBEYXRlKG1vbnRoICsgIiAiICsgZGF0ZSArICIgIiArIHllYXIpLCAiTU0vZGQveXl5eSIpOwogICAgICAgICAgICByZXR1cm4gdHlwZSA9PT0gImV4aXQiID8gZXhpdGZvcm1hdCA6IGRhdGVmb3JtYXQ7CgogICAgICAgIH0sCiAgICAgICAgYXN5bmMgZXh0ZW5kRURUKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgLy9mb3JtYXQobmV3IERhdGUodGhpcy5jaGVja2luRGF0ZSksICJ5eXl5LU1NLWRkJ1QnSEg6bW06c3MiKTsKICAgICAgICAgICAgICAgIHRoaXMuZXh0ZW5kQnRuTG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgICAgICBsZXQgdGltZWNvbmZpZyA9IGZvcm1hdCh0aGlzLnRpbWUsICd5eXl5L01NL2RkJykgKyAiICIgKyAiMTE6NTkgUE0iOwogICAgICAgICAgICAgICAgbGV0IHRpbWUgPSB0aGlzLmJvb2tpbmdEZXRhaWxzPy56b25lPy50aW1lUGlja2VyQ29uZmlndXJhdGlvbiA9PSAnMCcgPyBuZXcgRGF0ZSh0aW1lY29uZmlnKSA6IHRoaXMudGltZQogICAgICAgICAgICAgICAgbGV0IGV4aXREYXRlVGltZSA9IHRpbWUgIT0gbnVsbCB8fCB0aW1lICE9PSB1bmRlZmluZWQgfHwgdGltZSAhPSAiIiA/CiAgICAgICAgICAgICAgICAgICAgZm9ybWF0KHRpbWUsICd5eXl5L01NL2RkJykKICAgICAgICAgICAgICAgICAgICArCiAgICAgICAgICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgICAgICAgICBmb3JtYXQodGltZSwgJ2hoOm1tIGEnKSA6IG5ldyBEYXRlKCk7CiAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICBiaWQ6IHRoaXMuYm9va2luZ0RldGFpbHM/LmJvb2tpbmc/LmJpZCwKICAgICAgICAgICAgICAgICAgICBleHRlbmRlZFRpbWU6IGZvcm1hdChuZXcgRGF0ZShleGl0RGF0ZVRpbWUpLCAieXl5eS1NTS1kZCBISDptbTpzcyIpLy8iMjAyMi0xMi0yOVQwMjoyNjowMC4wMDAiLAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHZhciBleHRlbmRTZXNzaW9uUmVzID0gYXdhaXQgQVBJSGVscGVyKAogICAgICAgICAgICAgICAgICAgICJQT1NUIiwKICAgICAgICAgICAgICAgICAgICAiL2FwaS92MS9wcmVwYWlkL2V4dGVuZFJlc2VydmF0aW9uIiwgZGF0YQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGlmIChleHRlbmRTZXNzaW9uUmVzPy5kYXRhPy5tZXNzYWdlID09ICJTdWNjZXNzZnVsbHkgdXBkYXRlZCEhIikgewogICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZ2V0Qm9va2luZ0RldGFpbHMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmV4dGVuZEJ0bkxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmV4dGVuc2lvbkRpYWxvZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsZXJ0RGlhbG9nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsZXJ0TXNnID0gZXh0ZW5kU2Vzc2lvblJlcz8uZGF0YT8ubWVzc2FnZSB8fCAiRXJyb3IgaW4gZXh0ZW5kaW5nIHRoZSBzZXNzaW9uIgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIHRoaXMuZXh0ZW5kQnRuTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBmb3JtYXREYXRlKGRhdGUpIHsKICAgICAgICAgICAgbGV0IHN0cmluZ2RhdGUgPSBkYXRlLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIGlmICghZGF0ZSkgcmV0dXJuIG51bGw7CgogICAgICAgICAgICBjb25zdCBbeWVhciwgbW9udGgsIGRheV0gPSBzdHJpbmdkYXRlLnNwbGl0KCItIik7CiAgICAgICAgICAgIHJldHVybiBgJHttb250aH0vJHtkYXl9LyR7eWVhcn1gOwogICAgICAgIH0sCiAgICAgICAgcGFyc2VEYXRlKGRhdGUpIHsKICAgICAgICAgICAgaWYgKCFkYXRlKSByZXR1cm4gbnVsbDsKCiAgICAgICAgICAgIGNvbnN0IFttb250aCwgZGF5LCB5ZWFyXSA9IGRhdGUuc3BsaXQoIi8iKTsKICAgICAgICAgICAgcmV0dXJuIGAke3llYXJ9LSR7bW9udGgucGFkU3RhcnQoMiwgIjAiKX0tJHtkYXkucGFkU3RhcnQoMiwgIjAiKX1gOwogICAgICAgIH0sCiAgICAgICAgYXN5bmMgb3BlbkV4dERpYWxvZygpIHsKCiAgICAgICAgICAgIC8vIGF3YWl0IGF4aW9zLmdldCgKICAgICAgICAgICAgLy8gICBwcm9jZXNzLmVudi5WVUVfQVBQX09OX0RFTUFORF9VUkwgKyAiLyIgKyAiMzI4OTkiKyAiLmpzb24iCiAgICAgICAgICAgIC8vICk7CiAgICAgICAgICAgIHRoaXMuc2V0RGVmYXVsdERhdGUoKTsKICAgICAgICAgICAgdGhpcy5zZXREYXRlUGlja2VyKCk7CiAgICAgICAgICAgIC8vIHRoaXMuc2V0VGltZVBpY2tlcigpOwogICAgICAgICAgICB0aGlzLmV4dGVuc2lvbkRpYWxvZyA9IHRydWU7CiAgICAgICAgICAgIHRoaXMuZXh0ZW5kQnRuTG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0sCgogICAgICAgIHNldERlZmF1bHREYXRlKCkgewogICAgICAgICAgICAvL2Zvcm1hdHRlZCBleGl0IGRhdGUgdmFsdWUgdG8gZGlzcGxheQogICAgICAgICAgICB0aGlzLmRhdGVGb3JtYXR0ZWQgPQogICAgICAgICAgICAgICAgdGhpcy5ib29raW5nRGV0YWlscz8uYm9va2luZz8ucmVzZXJ2YXRpb25FbmREYXRlID8gdGhpcy5mb3JtYXRVVENEZWZhdWx0RGF0ZSh0aGlzLmJvb2tpbmdEZXRhaWxzPy5ib29raW5nPy5yZXZFbmQKICAgICAgICAgICAgICAgICAgICAsICdmb3JtYXQnKSA6ICIiOwogICAgICAgICAgICB0aGlzLnRpbWUgPSBuZXcgRGF0ZSh0aGlzLmZvcm1hdEV4aXREYXRlVGltZSh0aGlzLmJvb2tpbmdEZXRhaWxzPy5ib29raW5nPy5yZXZFbmQsICdkYXRlJykpCiAgICAgICAgICAgIHRoaXMuZXhpdERhdGUgPSB0aGlzLnRpbWU7CiAgICAgICAgICAgIGxldCBmaWZ0ZWVuVGltZSA9IHRoaXMudGltZTsKCiAgICAgICAgICAgIHRoaXMudGltZSA9IGZvcm1hdCh0aGlzLnRpbWUsICdtbScpID09ICcxNScgfHwgZm9ybWF0KHRoaXMudGltZSwgJ21tJykgPT0gJzMwJyB8fCBmb3JtYXQodGhpcy50aW1lLCAnbW0nKSA9PSAnNDUnIHx8IGZvcm1hdCh0aGlzLnRpbWUsICdtbScpID09ICcwMCcgPyBmaWZ0ZWVuVGltZSA6IHRoaXMuYm9va2luZ0RldGFpbHM/LnpvbmU/LnRpbWVQaWNrZXJDb25maWd1cmF0aW9uID09ICcxJyA/IHRoaXMucm91bmQodGhpcy50aW1lKSA6IHNldCh0aGlzLnRpbWUsIHsgaG91cjogMjMsIG1pbnV0ZXM6IDU5LCBzZWNvbmRzOiA1OSB9KTsKICAgICAgICAgICAgLy8gdGhpcy5kYXRlVGltZUNoYW5nZSgpCiAgICAgICAgICAgIC8vIE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZywgJ2lzR2F0ZWQnKSAmJiB0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmc/LmlzR2F0ZWQgPT0gIjEiICYmIGZvcm1hdCh0aGlzLnRpbWUsICd5eXl5LU1NLWRkJykgIT0gZm9ybWF0KGRhdGVUb1RpbWVab25lRGF0ZShuZXcgRGF0ZSgpLCB0aGlzLmJvb2tpbmdEZXRhaWxzPy56b25lPy50aW1lem9uZSksICd5eXl5LU1NLWRkJykgPyB0aGlzLmJlZm9yZURhdGVUaW1lQ2hhbmdlKCkgOiAiIjsKCiAgICAgICAgfSwKICAgICAgICBvblRpbWVQaWNrZXJDaGFuZ2UoKSB7CiAgICAgICAgICAgIGxldCBleGl0ZGF0ZSA9IHRoaXMudGltZSAhPT0gbnVsbCAmJiB0aGlzLnRpbWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRpbWUgIT09ICIiID8gZm9ybWF0KHRoaXMudGltZSwgJ3l5eXkvTU0vZGQnKSA6ICIiOwogICAgICAgICAgICBsZXQgc2VsZWN0ZWRNaW5zID0gdGhpcy50aW1lICE9PSBudWxsICYmIHRoaXMudGltZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMudGltZSAhPT0gIiIgPyBmb3JtYXQodGhpcy50aW1lLCAnbW0nKSA6ICIiOwogICAgICAgICAgICBsZXQgc2VsZWN0ZWRIb3VycyA9IHRoaXMudGltZSAhPT0gbnVsbCAmJiB0aGlzLnRpbWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRpbWUgIT09ICIiID8gZm9ybWF0KHRoaXMudGltZSwgJ0hIJykgOiAiIjsKICAgICAgICAgICAgbGV0IHNlbGVjdGVkQU1QTSA9IHRoaXMudGltZSAhPT0gbnVsbCAmJiB0aGlzLnRpbWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRpbWUgIT09ICIiID8gZm9ybWF0KHRoaXMudGltZSwgJ2EnKSA6ICIiOwogICAgICAgICAgICB0aGlzLnN0b3BUaW1lID0gc2VsZWN0ZWRNaW5zICE9IG51bGwgJiYgc2VsZWN0ZWRNaW5zICE9ICIiICYmIHNlbGVjdGVkSG91cnMgIT0gbnVsbCAmJiBzZWxlY3RlZEhvdXJzICE9ICIiICYmIHNlbGVjdGVkQU1QTSAhPSBudWxsICYmIHNlbGVjdGVkQU1QTSAhPSAiIiA/IHNlbGVjdGVkSG91cnMgKyAiOiIgKyBzZWxlY3RlZE1pbnMgKyAiOiIgKyAiMDAiIDogIiI7CiAgICAgICAgICAgIGxldCBjdXJyZW5UaW1lID0gdGhpcy5ib29raW5nRGV0YWlscy56b25lLnRpbWV6b25lCiAgICAgICAgICAgICAgICA/IGZvcm1hdCgKICAgICAgICAgICAgICAgICAgICBkYXRlVG9UaW1lWm9uZURhdGUobmV3IERhdGUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib29raW5nRGV0YWlscy56b25lLnRpbWV6b25lCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAieXl5eS1NTS1kZCBISDptbTpzcyIKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIDogZm9ybWF0KG5ldyBEYXRlKCksICJ5eXl5LU1NLWRkICBISDptbTpzcyIpOwogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBzZWxlY3RlZE1pbnMgIT0gbnVsbCAmJiBzZWxlY3RlZE1pbnMgIT0gIiIgJiYgc2VsZWN0ZWRIb3VycyAhPSBudWxsICYmIHNlbGVjdGVkSG91cnMgIT0gIiIgJiYgc2VsZWN0ZWRBTVBNICE9IG51bGwgJiYgc2VsZWN0ZWRBTVBNICE9ICIiICYmCiAgICAgICAgICAgICAgICBuZXcgRGF0ZShleGl0ZGF0ZSArICIgIiArIHRoaXMuc3RvcFRpbWUpLmdldFRpbWUoKSA+CiAgICAgICAgICAgICAgICBuZXcgRGF0ZShjdXJyZW5UaW1lKS5nZXRUaW1lKCkKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICBmb3JtYXQodGhpcy50aW1lLCAneXl5eS1NTS1kZCcpICE9IGZvcm1hdCh0aGlzLm1pbkRhdGUsICd5eXl5LU1NLWRkJykgPyB0aGlzLmJlZm9yZURhdGVUaW1lQ2hhbmdlKCkgOiAiIjsKICAgICAgICAgICAgICAgIHRoaXMuZGF0ZVRpbWVDaGFuZ2UoKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgc2V0RGF0ZVBpY2tlcigpIHsKICAgICAgICAgICAgLy9zZXQgdGhlIG1pbmltdW0gZGF0ZSB0byB0b2RheSBkYXRlKHpvbmUgdGltZSB6b25lIGRhdGUpCiAgICAgICAgICAgIHRoaXMubWluRGF0ZSA9IHRoaXMuYm9va2luZ0RldGFpbHMuem9uZS50aW1lem9uZQogICAgICAgICAgICAgICAgPwogICAgICAgICAgICAgICAgbmV3IERhdGUodGhpcy5mb3JtYXRFeGl0RGF0ZVRpbWUodGhpcy5ib29raW5nRGV0YWlscz8uYm9va2luZz8ucmV2RW5kLCAnZGF0ZScpKQogICAgICAgICAgICAgICAgOgogICAgICAgICAgICAgICAgZGF0ZVRvVGltZVpvbmVEYXRlKAogICAgICAgICAgICAgICAgICAgIG5ldyBEYXRlKE51bWJlcih0aGlzLmJvb2tpbmdEZXRhaWxzPy5ib29raW5nPy5yZXZFbmQpICogMTAwMCAtIE51bWJlcih0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUudGltZXpvbmVvZmZzZXQpICogMTAwMCkKICAgICAgICAgICAgICAgICAgICAsIHRoaXMuYm9va2luZ0RldGFpbHMuem9uZS50aW1lem9uZQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgLy9jYWxjdWxhdGUgbWF4IHBhcmtpZ24gdGltZSBpbiBzZWNvbmRzCiAgICAgICAgICAgIGxldCBtYXhQYXJrID0gdGhpcy5ib29raW5nRGV0YWlscyAhPSBudWxsID8gdGhpcy5ib29raW5nRGV0YWlscz8uem9uZT8ubWF4UGFya2luZ1RpbWUgOiBudWxsOwoKICAgICAgICAgICAgbGV0IGFkZGVkZGF5cyA9IGFkZERheXMobmV3IERhdGUoKSwgbWF4UGFyaz8uZGF5cyk7CiAgICAgICAgICAgIGxldCBhZGRlZGhvdXJzID0gYWRkSG91cnMoYWRkZWRkYXlzLCBtYXhQYXJrPy5ob3Vycyk7CiAgICAgICAgICAgIGxldCBhZGRlZG1pbnMgPSBhZGRNaW51dGVzKGFkZGVkaG91cnMsIG1heFBhcms/Lm1pbnV0ZXMpOwogICAgICAgICAgICAvL2dldCBtYXggZGF0ZSBpbiBzZWNvbmRzIGJhc2VkIG9uIG1heCBwYXJraW5nIHRpbWUKICAgICAgICAgICAgbGV0IG1heFpvbmVEYXRlID0gYWRkZWRtaW5zOwogICAgICAgICAgICB0aGlzLm1heERhdGUgPSB0aGlzLmJvb2tpbmdEZXRhaWxzPy56b25lLnRpbWV6b25lCiAgICAgICAgICAgICAgICA/CiAgICAgICAgICAgICAgICBkYXRlVG9UaW1lWm9uZURhdGUoCiAgICAgICAgICAgICAgICAgICAgbWF4Wm9uZURhdGUsCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib29raW5nRGV0YWlscz8uem9uZT8udGltZXpvbmUKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIDogbmV3IERhdGUobWF4Wm9uZURhdGUpOwogICAgICAgICAgICAvL2dldCBtYXggZGF0ZSB3aXRoIHRpbWUgYW5kIHNldCBpdCB0byBtYXhEYXRlVGltZQogICAgICAgICAgICB0aGlzLm1heERhdGVUaW1lID0gdGhpcy5ib29raW5nRGV0YWlscz8uem9uZT8udGltZXpvbmUKICAgICAgICAgICAgICAgID8gZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIGRhdGVUb1RpbWVab25lRGF0ZSgKICAgICAgICAgICAgICAgICAgICAgICAgbmV3IERhdGUobWF4Wm9uZURhdGUpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJvb2tpbmdEZXRhaWxzPy56b25lPy50aW1lem9uZQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgInl5eXktTU0tZGQgaGg6bW0gYWFhYWEiCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICA6IGZvcm1hdChuZXcgRGF0ZSgpLCAieXl5eS1NTS1kZCBoaDptbSBhYWFhYSIpOwogICAgICAgIH0sCiAgICAgICAgLy8gb25PcGVuKCkgewogICAgICAgIC8vICAgdGhpcy5zZXRUaW1lUGlja2VyKHRoaXMuZXhpdFRpbWVTZWxlY3RlZCk7CiAgICAgICAgLy8gfSwKICAgICAgICAvKiogQG1ldGhvZHMgdG8gZmluZCB0aGUgZXN0aW1hdGUgcmF0ZSAKICAgICAgIEBwYXJhbXMgc3RhcnREYXRlICwgc3RvcERhdGUsemNvZGUsIHR5cGUgLCBlbnZfb3ZlclJpZGUKICAgICAgICovCiAgICAgICAgYXN5bmMgYmVmb3JlRGF0ZVRpbWVDaGFuZ2UoKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5ib29raW5nRGV0YWlscy56b25lLnpjb2RlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgLy8gZm9ybWF0KG5ldyBEYXRlKHRoaXMuY2hlY2tpbkRhdGUpLCAieXl5eS1NTS1kZCdUJ0hIOm1tOnNzIik7CgogICAgICAgICAgICAgICAgbGV0IGVkdEVudHJ5VGltZSA9IHRoaXMuYm9va2luZ0RldGFpbHM/LmJvb2tpbmc/LmVudHJ5dGltZQogICAgICAgICAgICAgICAgdGhpcy5zdGFydERhdGUgPSBlZHRFbnRyeVRpbWUgIT09IG51bGwgJiYgZWR0RW50cnlUaW1lICE9PSB1bmRlZmluZWQgJiYgZWR0RW50cnlUaW1lICE9PSAiIiA/IGZvcm1hdChuZXcgRGF0ZSh0aGlzLmZvcm1hdEV4aXREYXRlVGltZShlZHRFbnRyeVRpbWUsICdkYXRlJykpLCAieXl5eS1NTS1kZCdUJ0hIOm1tOnNzIikgOiB0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUudGltZXpvbmUKICAgICAgICAgICAgICAgICAgICA/IGZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRvVGltZVpvbmVEYXRlKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IERhdGUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYm9va2luZ0RldGFpbHMuem9uZS50aW1lem9uZQogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAieXl5eS1NTS1kZCdUJ0hIOm1tOnNzIgogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICA6IGZvcm1hdChuZXcgRGF0ZSgpLCAieXl5eS1NTS1kZCdUJ0hIOm1tOnNzIik7CiAgICAgICAgICAgICAgICBsZXQgc3RvcFRpbWUgPSB0aGlzLnN0b3BUaW1lCiAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWRIb3VycyA9IHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy5lbnRyeXRpbWUgIT0gbnVsbCAmJiB0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcuZW50cnl0aW1lICE9PSB1bmRlZmluZWQgJiYgdGhpcy5ib29raW5nRGV0YWlscy5ib29raW5nLmVudHJ5dGltZSAhPSAiIiA/IGZvcm1hdChuZXcgRGF0ZSh0aGlzLmZvcm1hdEV4aXREYXRlVGltZSh0aGlzLmJvb2tpbmdEZXRhaWxzPy5ib29raW5nPy5lbnRyeXRpbWUsICdkYXRlJykpLCAiSEgiKSA6IGZvcm1hdChkYXRlVG9UaW1lWm9uZURhdGUobmV3IERhdGUoKSwgdGhpcy5ib29raW5nRGV0YWlscy56b25lLnRpbWV6b25lKSwgJ0hIJyk7CiAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWRNaW5zID0gdGhpcy5ib29raW5nRGV0YWlscy5ib29raW5nLmVudHJ5dGltZSAhPSBudWxsICYmIHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy5lbnRyeXRpbWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcuZW50cnl0aW1lICE9ICIiID8gZm9ybWF0KG5ldyBEYXRlKHRoaXMuZm9ybWF0RXhpdERhdGVUaW1lKHRoaXMuYm9va2luZ0RldGFpbHM/LmJvb2tpbmc/LmVudHJ5dGltZSwgJ2RhdGUnKSksICJtbSIpIDogZm9ybWF0KGRhdGVUb1RpbWVab25lRGF0ZShuZXcgRGF0ZSgpLCB0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUudGltZXpvbmUpLCAnbW0nKTsKICAgICAgICAgICAgICAgIGxldCBleGl0dGltZSA9IE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuYm9va2luZ0RldGFpbHMsICd6b25lJykgJiYgT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodGhpcy5ib29raW5nRGV0YWlscy56b25lLCAndGltZVBpY2tlckNvbmZpZ3VyYXRpb24nKSAmJiB0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUudGltZVBpY2tlckNvbmZpZ3VyYXRpb24gPT0gJzEnID8gJ1QnICsgc3RvcFRpbWUgOiAnVCcgKyBzZWxlY3RlZEhvdXJzICsgIjoiICsgc2VsZWN0ZWRNaW5zICsgIjowMCI7CiAgICAgICAgICAgICAgICBsZXQgZXhpdGRhdGUgPSBmb3JtYXQodGhpcy50aW1lLCAneXl5eS1NTS1kZCcpOwogICAgICAgICAgICAgICAgbGV0IHN0b3BEYXRlID0gZXhpdGRhdGUgKyBleGl0dGltZTsKICAgICAgICAgICAgICAgIGxldCBkYXRhID0gewogICAgICAgICAgICAgICAgICAgIHN0YXJ0QXQ6IHRoaXMuc3RhcnREYXRlLAogICAgICAgICAgICAgICAgICAgIHN0b3BBdDogc3RvcERhdGUsCiAgICAgICAgICAgICAgICAgICAgemNvZGU6IHRoaXMuYm9va2luZ0RldGFpbHMuem9uZS56Y29kZSwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB0aGlzLmFkZFBheW1lbnRCdG5Mb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHZhciBnZXRSYXRlID0gYXdhaXQgQVBJSGVscGVyKCJQT1NUIiwgIi9hcGkvdjIvZ2V0UmF0ZSIsIGRhdGEpOwogICAgICAgICAgICAgICAgLy9jb25kaXRpb24gdG8gY2hlY2sgaWYgdGhlIGRhdGUgdGltZSBzZWxlY3RlZCBpcyBsZXNzZXIgdGhhbiBjdXJyZW50IHRpbWUKICAgICAgICAgICAgICAgIGlmICghZ2V0UmF0ZT8uZGF0YT8uc3RhdHVzICYmICF0aGlzLmdldFJhdGVDYWxsKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlQWRkUGF5bWVudEJ0biA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGVydERpYWxvZyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGVydE1zZyA9CiAgICAgICAgICAgICAgICAgICAgICAgIGdldFJhdGU/LmRhdGE/Lm1lc3NhZ2UgfHwgIkVycm9yIGluIGdldHRpbmcgcmF0ZSBkZXRhaWxzIjsKICAgICAgICAgICAgICAgICAgICB0aGlzLm9wZW5EYXRlUGlja2VyID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcGVuVGltZVBpY2tlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVBZGRQYXltZW50QnRuID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcGVuRGF0ZVBpY2tlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHRoaXMub3BlblRpbWVQaWNrZXIgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMuYmVmb3JlRXN0aW1hdGUgPSBPYmplY3QuYXNzaWduKHt9LCBnZXRSYXRlPy5kYXRhPy5kYXRhKTsKICAgICAgICAgICAgICAgIC8vIGVzdGltYXRlZFZhbCAhPSAiIiAmJgogICAgICAgICAgICAgICAgLy8gZXN0aW1hdGVkVmFsICE9IG51bGwgJiYKICAgICAgICAgICAgICAgIC8vIGVzdGltYXRlZFZhbCAhPSB1bmRlZmluZWQKICAgICAgICAgICAgICAgIC8vICAgPyBOdW1iZXIoZXN0aW1hdGVkVmFsKS50b0ZpeGVkKDIpCiAgICAgICAgICAgICAgICAvLyAgIDogZXN0aW1hdGVkVmFsOwogICAgICAgICAgICAgICAgdGhpcy5hZGRQYXltZW50QnRuTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgdGhpcy5hZGRQYXltZW50QnRuTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBhc3luYyBkYXRlVGltZUNoYW5nZSgpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUuemNvZGUpIHsKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuZXh0ZW5kQnRuTG9hZGluZyA9IHRydWU7CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgLy8gZm9ybWF0KG5ldyBEYXRlKHRoaXMuY2hlY2tpbkRhdGUpLCAieXl5eS1NTS1kZCdUJ0hIOm1tOnNzIik7CiAgICAgICAgICAgICAgICBsZXQgZWR0RW50cnlUaW1lID0gdGhpcy5ib29raW5nRGV0YWlscz8uYm9va2luZz8uZW50cnl0aW1lCiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0RGF0ZSA9IGVkdEVudHJ5VGltZSAhPT0gbnVsbCAmJiBlZHRFbnRyeVRpbWUgIT09IHVuZGVmaW5lZCAmJiBlZHRFbnRyeVRpbWUgIT09ICIiID8gZm9ybWF0KG5ldyBEYXRlKHRoaXMuZm9ybWF0RXhpdERhdGVUaW1lKGVkdEVudHJ5VGltZSwgJ2RhdGUnKSksICJ5eXl5LU1NLWRkJ1QnSEg6bW06c3MiKSA6IHRoaXMuYm9va2luZ0RldGFpbHMuem9uZS50aW1lem9uZQogICAgICAgICAgICAgICAgICAgID8gZm9ybWF0KAogICAgICAgICAgICAgICAgICAgICAgICBkYXRlVG9UaW1lWm9uZURhdGUoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib29raW5nRGV0YWlscy56b25lLnRpbWV6b25lCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgICJ5eXl5LU1NLWRkJ1QnSEg6bW06c3MiCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIDogZm9ybWF0KGRhdGVUb1RpbWVab25lRGF0ZShuZXcgRGF0ZSgpLCB0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUudGltZXpvbmUpLCAieXl5eS1NTS1kZCdUJ0hIOm1tOnNzIik7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmV4aXRUaW1lU2VsZWN0ZWQ/LmhoKyI6Iit0aGlzLmV4aXRUaW1lU2VsZWN0ZWQubW0rIjowMCIpCiAgICAgICAgICAgICAgICAvLyB0aGlzLmV4aXREYXRlICsgIlQyMzo1OTowMCI7CiAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWRIb3VycyA9IHRoaXMudGltZSAhPT0gbnVsbCAmJiB0aGlzLnRpbWUgIT09ICIiICYmIHRoaXMudGltZSAhPT0gdW5kZWZpbmVkID8gZm9ybWF0KHRoaXMudGltZSwgJ0hIJykgOiBmb3JtYXQoZGF0ZVRvVGltZVpvbmVEYXRlKG5ldyBEYXRlKCksIHRoaXMuYm9va2luZ0RldGFpbHMuem9uZS50aW1lem9uZSksICdISCcpCiAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWRNaW5zID0gdGhpcy50aW1lICE9PSBudWxsICYmIHRoaXMudGltZSAhPT0gIiIgJiYgdGhpcy50aW1lICE9PSB1bmRlZmluZWQgPyBmb3JtYXQodGhpcy50aW1lLCAnbW0nKSA6IGZvcm1hdChkYXRlVG9UaW1lWm9uZURhdGUobmV3IERhdGUoKSwgdGhpcy5ib29raW5nRGV0YWlscy56b25lLnRpbWV6b25lKSwgJ21tJykKICAgICAgICAgICAgICAgIGxldCBleGl0ZGF0ZSA9IHRoaXMudGltZSAhPT0gbnVsbCAmJiB0aGlzLnRpbWUgIT09ICIiICYmIHRoaXMudGltZSAhPT0gdW5kZWZpbmVkID8gZm9ybWF0KHRoaXMudGltZSwgJ3l5eXktTU0tZGQnKSA6ICIiOwogICAgICAgICAgICAgICAgbGV0IGV4aXR0aW1lID0gT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodGhpcy5ib29raW5nRGV0YWlscywgJ3pvbmUnKSAmJiBPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUsICd0aW1lUGlja2VyQ29uZmlndXJhdGlvbicpICYmIHRoaXMuYm9va2luZ0RldGFpbHM/LnpvbmU/LnRpbWVQaWNrZXJDb25maWd1cmF0aW9uID09ICcxJyA/ICdUJyArIHNlbGVjdGVkSG91cnMgKyAiOiIgKyBzZWxlY3RlZE1pbnMgKyAiOjAwIiA6ICJUMjM6NTk6MDAiCiAgICAgICAgICAgICAgICBsZXQgc3RvcERhdGUgPSBleGl0ZGF0ZSArIGV4aXR0aW1lOwoKICAgICAgICAgICAgICAgIGxldCBkYXRhID0gewogICAgICAgICAgICAgICAgICAgIHN0YXJ0QXQ6IHRoaXMuc3RhcnREYXRlLAogICAgICAgICAgICAgICAgICAgIHN0b3BBdDogc3RvcERhdGUsCiAgICAgICAgICAgICAgICAgICAgemNvZGU6IHRoaXMuYm9va2luZ0RldGFpbHM/LnpvbmU/Lnpjb2RlLAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHRoaXMuYWRkUGF5bWVudEJ0bkxvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgdmFyIGdldFJhdGUgPSBhd2FpdCBBUElIZWxwZXIoIlBPU1QiLCAiL2FwaS92Mi9nZXRSYXRlIiwgZGF0YSk7CiAgICAgICAgICAgICAgICB0aGlzLmV4dGVuZEJ0bkxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMuZXh0RGF0ZUFuZFRpbWUgPSBzdG9wRGF0ZTsKICAgICAgICAgICAgICAgIC8vY29uZGl0aW9uIHRvIGNoZWNrIGlmIHRoZSBkYXRlIHRpbWUgc2VsZWN0ZWQgaXMgbGVzc2VyIHRoYW4gY3VycmVudCB0aW1lCiAgICAgICAgICAgICAgICBpZiAoIWdldFJhdGU/LmRhdGE/LnN0YXR1cyAmJiAhdGhpcy5nZXRSYXRlQ2FsbCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZUFkZFBheW1lbnRCdG4gPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxlcnREaWFsb2cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxlcnRNc2cgPQogICAgICAgICAgICAgICAgICAgICAgICBnZXRSYXRlPy5kYXRhPy5tZXNzYWdlIHx8ICJFcnJvciBpbiBnZXR0aW5nIHJhdGUgZGV0YWlscyI7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcGVuRGF0ZVBpY2tlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHRoaXMub3BlblRpbWVQaWNrZXIgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnZGF0ZXRpbWUtc2V0Jyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZUFkZFBheW1lbnRCdG4gPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB0aGlzLm9wZW5EYXRlUGlja2VyID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcGVuVGltZVBpY2tlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdkYXRldGltZS1zZXQnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMuZXN0aW1hdGUgPSBPYmplY3QuYXNzaWduKHt9LCBnZXRSYXRlPy5kYXRhPy5kYXRhKTsKICAgICAgICAgICAgICAgIC8vIGVzdGltYXRlZFZhbCAhPSAiIiAmJgogICAgICAgICAgICAgICAgLy8gZXN0aW1hdGVkVmFsICE9IG51bGwgJiYKICAgICAgICAgICAgICAgIC8vIGVzdGltYXRlZFZhbCAhPSB1bmRlZmluZWQKICAgICAgICAgICAgICAgIC8vICAgPyBOdW1iZXIoZXN0aW1hdGVkVmFsKS50b0ZpeGVkKDIpCiAgICAgICAgICAgICAgICAvLyAgIDogZXN0aW1hdGVkVmFsOwogICAgICAgICAgICAgICAgdGhpcy5hZGRQYXltZW50QnRuTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgdGhpcy5hZGRQYXltZW50QnRuTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBjYWxjdWxhdGVFeGl0RGF0ZVRpbWUoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmJvb2tpbmdEZXRhaWxzPy56b25lPy50aW1lem9uZSkgewogICAgICAgICAgICAgICAgLy8gICB2YXIgY3VycmVudFRpbWUgPQogICAgICAgICAgICAgICAgLy8gbmV3IERhdGUoKS5nZXRUaW1lKCkgKwogICAgICAgICAgICAgICAgLy8gKE51bWJlcih0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUudGltZXpvbmVvZmZzZXQpICogMTAwMCArCiAgICAgICAgICAgICAgICAvLyAgIE51bWJlcih0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUudGltZXpvbmVkc3RvZmZzZXQpICogMTAwMCk7CiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPQogICAgICAgICAgICAgICAgICAgIG5ldyBEYXRlKCkuZ2V0VGltZSgpICsKICAgICAgICAgICAgICAgICAgICAoTnVtYmVyKHRoaXMuYm9va2luZ0RldGFpbHMuem9uZS50aW1lem9uZW9mZnNldCkgKiAxMDAwICsKICAgICAgICAgICAgICAgICAgICAgICAgTnVtYmVyKHRoaXMuYm9va2luZ0RldGFpbHMuem9uZS50aW1lem9uZWRzdG9mZnNldCkgKiAxMDAwKTsKICAgICAgICAgICAgICAgIHZhciBleGl0VGltZSA9CiAgICAgICAgICAgICAgICAgICAgbmV3IERhdGUodGhpcy5ib29raW5nRGV0YWlscy5ib29raW5nLnJlc2VydmF0aW9uRW5kRGF0ZSkuZ2V0VGltZSgpOwogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJTRVRfRVhJVF9USU1FX1RJTUVfU1RBVFVTIiwgdGhpcy5leGl0RGF0ZVRpbWUgPCAwKTsKICAgICAgICAgICAgICAgIGV4aXRUaW1lIC0gY3VycmVudFRpbWUgPCAwCiAgICAgICAgICAgICAgICAgICAgPyBjbGVhckludGVydmFsKHRoaXMuZXhpdEludGVydmFsKQogICAgICAgICAgICAgICAgICAgIDogIiI7CiAgICAgICAgICAgICAgICByZXR1cm4gZXhpdFRpbWUgLSBjdXJyZW50VGltZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gMAoKICAgICAgICB9LAogICAgICAgIGhvdGVsR3Vlc3QoKSB7CiAgICAgICAgICAgIGxldCB1cmwgPSB3aW5kb3cubG9jYXRpb24ub3JpZ2luICsgJz96Y29kZT0nICsgdGhpcy5ib29raW5nRGV0YWlscz8uem9uZT8ubG9jYXRpb25Db2RlICsgJyMvY3JlYXRlc2Vzc2lvbic7CiAgICAgICAgICAgIGxldCBwbGF0ZSA9IHRoaXMuYm9va2luZ0RldGFpbHM/LmJvb2tpbmc/LnZlaGljbGVObyB8fCAiIjsKICAgICAgICAgICAgbGV0IHBob25lID0gdGhpcy5ib29raW5nRGV0YWlscz8udXNlcj8uY29udGFjdCB8fCAiIjsKICAgICAgICAgICAgbGV0IGJpZCA9IHRoaXMuYm9va2luZ0RldGFpbHM/LmJvb2tpbmc/LmJpZCB8fCAiIjsKICAgICAgICAgICAgbGV0IGNoZWNraW5kYXRlID0gdGhpcy5ib29raW5nRGV0YWlscz8uYm9va2luZz8uZW50cnl0aW1lIHx8ICIiOwogICAgICAgICAgICBsZXQgcGFyYW1zID0gJy8/cGhvbmU9JyArIHBob25lICsgJyZiaWQ9JyArIGJpZCArICcmcGxhdGU9JyArIHBsYXRlICsgJyZlbnRyeXRpbWU9JyArIGNoZWNraW5kYXRlOwogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZSh1cmwgKyBwYXJhbXMpOwogICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIucmVwbGFjZSh7cGF0aDonLyd9KTsKCiAgICAgICAgfSwKICAgICAgICBjbG9zZVFSQ29kZURpYWxvZygpIHsKICAgICAgICAgICAgdGhpcy5xckNvZGVEaWFsb2cgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy5jYW1lcmFTdGF0dXMgPSBmYWxzZTsKICAgICAgICB9LAogICAgICAgIGNsb3NlVmFsaWRhdGlvblFSRGlhbG9nKCkgewogICAgICAgICAgICB0aGlzLnZhbGlkYXRpb25DYW1lcmFTdGF0dXMgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy52YWxpZGF0ZUJvb2tpbmdEaWFsb2cgPSB0cnVlOwogICAgICAgICAgICB0aGlzLnZhbGlkYXRlUVJDb2RlRGlhbG9nID0gZmFsc2U7CiAgICAgICAgfSwKICAgICAgICByZVNjYW5RUigpIHsKICAgICAgICAgICAgdGhpcy5pbnZhbGlkUVJEaWFsb2cgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy5jYW1lcmFTdGF0dXMgPSB0cnVlOwogICAgICAgIH0sCiAgICAgICAgcmVTY2FuVmFsaWRhdGlvblFSKCkgewogICAgICAgICAgICB0aGlzLmludmFsaWRWYWxpZGF0aW9uUVJEaWFsb2cgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy52YWxpZGF0aW9uQ2FtZXJhU3RhdHVzID0gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIG9wZW5TbXNRclNjYW5uZXIoKSB7CiAgICAgICAgICAgIHRoaXMucXJDb2RlRGlhbG9nID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5jYW1lcmFTdGF0dXMgPSB0cnVlOwogICAgICAgIH0sCiAgICAgICAgb3BlblNNU0RpYWxvZygpIHsKICAgICAgICAgICAgdGhpcy5zbXNEaWFsb2cgPSB0cnVlOwogICAgICAgICAgICBsZXQgZXhpdExhbmVzID0KICAgICAgICAgICAgICAgIHRoaXMuZXhpdEdhdGVDb2Rlcy5sZW5ndGggPiAwCiAgICAgICAgICAgICAgICAgICAgPyB0aGlzLmV4aXRHYXRlQ29kZXMuZmlsdGVyKChhKSA9PiBhLmlzUGVkZXN0cmlhbiA9PSAiMCIpCiAgICAgICAgICAgICAgICAgICAgOiBbXTsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgdGhpcy5ib29raW5nRGV0YWlscz8uYm9va2luZz8ucHJlUG9wdWxhdGVHYXRlQ29kZXMgJiYKICAgICAgICAgICAgICAgIHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy5wcmVQb3B1bGF0ZUdhdGVDb2RlcyA9PSAiMSIKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNtc1RleHQgPSBleGl0TGFuZXMubGVuZ3RoID09IDEgPyBleGl0TGFuZXNbMF0uc21zX2NvZGUgOiAiIjsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgc2Nyb2xsVG9TdWJtaXQoKSB7CiAgICAgICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3N1Ym1pdHNtc2J0biIpOwogICAgICAgICAgICBpZiAoZWwpIHsKICAgICAgICAgICAgICAgIGVsLnNjcm9sbEludG9WaWV3KHRoaXMub3B0aW9ucyk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHNjcm9sbFRvVmFsaWRhdGVCdG4oKSB7CiAgICAgICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3ZhbGlkYXRlYm9va2luZ2J0biIpOwogICAgICAgICAgICBpZiAoZWwpIHsKICAgICAgICAgICAgICAgIGVsLnNjcm9sbEludG9WaWV3KHRoaXMub3B0aW9ucyk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGNhbGN1bGF0ZUdyYWNlUGVyaW9kVGltZSgpIHsKICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lID0KICAgICAgICAgICAgICAgIG5ldyBEYXRlKCkuZ2V0VGltZSgpICsKICAgICAgICAgICAgICAgIChOdW1iZXIodGhpcy5ib29raW5nRGV0YWlscy56b25lLnRpbWV6b25lb2Zmc2V0KSAqIDEwMDAgKwogICAgICAgICAgICAgICAgICAgIE51bWJlcih0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUudGltZXpvbmVkc3RvZmZzZXQpICogMTAwMCk7CiAgICAgICAgICAgIHZhciBncmFjZVBlcmlvZFRpbWUgPQogICAgICAgICAgICAgICAgKE51bWJlcih0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcuZW50cnl0aW1lKSArCiAgICAgICAgICAgICAgICAgICAgTnVtYmVyKHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy5ncmFjZVBlcmlvZCkpICoKICAgICAgICAgICAgICAgIDEwMDA7IC8vCiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgKICAgICAgICAgICAgICAgICJTRVRfR1JBQ0VfUEVSSU9EX1RJTUVfU1RBVFVTIiwKICAgICAgICAgICAgICAgIHRoaXMuZ3JhY2VQZXJpb2RUaW1lIDw9IDAKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuIGdyYWNlUGVyaW9kVGltZSAtIGN1cnJlbnRUaW1lOwogICAgICAgIH0sCiAgICAgICAgY2FsY3VsYXRlVmFsaWRhdGVkVGltZSgpIHsKICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lID0KICAgICAgICAgICAgICAgIG5ldyBEYXRlKCkuZ2V0VGltZSgpICsKICAgICAgICAgICAgICAgIChOdW1iZXIodGhpcy5ib29raW5nRGV0YWlscy56b25lLnRpbWV6b25lb2Zmc2V0KSAqIDEwMDAgKwogICAgICAgICAgICAgICAgICAgIE51bWJlcih0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUudGltZXpvbmVkc3RvZmZzZXQpICogMTAwMCk7CiAgICAgICAgICAgIHZhciB2YWxpZGF0ZWRUaW1lID0gdGhpcy5ib29raW5nRGV0YWlscy5ib29raW5nLnR5cGUgPT0gIjEzIiA/CiAgICAgICAgICAgICAgICAoTnVtYmVyKHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy5yZXZTdGFydCkgKwogICAgICAgICAgICAgICAgICAgIE51bWJlcih0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcuY291cG9uVmFsaWRUaW1lKSkgKgogICAgICAgICAgICAgICAgMTAwMCA6IChOdW1iZXIodGhpcy5ib29raW5nRGV0YWlscy5ib29raW5nLmVudHJ5dGltZSkgKwogICAgICAgICAgICAgICAgICAgIE51bWJlcih0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcuY291cG9uVmFsaWRUaW1lKSkgKgogICAgICAgICAgICAgICAgMTAwMAogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoIlNFVF9WQUxJREFURURfVElNRV9TVEFUVVMiLCB0aGlzLnZhbGlkYXRlZFRpbWUgPCAwKTsKICAgICAgICAgICAgdmFsaWRhdGVkVGltZSAtIGN1cnJlbnRUaW1lIDwgMAogICAgICAgICAgICAgICAgPyBjbGVhckludGVydmFsKHRoaXMudmFsaWRhdGVkSW50ZXJ2YWwpCiAgICAgICAgICAgICAgICA6ICIiOwogICAgICAgICAgICByZXR1cm4gdmFsaWRhdGVkVGltZSAtIGN1cnJlbnRUaW1lOwogICAgICAgIH0sCiAgICAgICAgY2FsY3VsYXRlUGFya2luZ1RpbWUocGFya2luZ1N0YXJ0VGltZSwgZ3JhY2VQZXJpb2QsIHpvbmUpIHsKICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lID0gbmV3IERhdGUoKTsKICAgICAgICAgICAgY3VycmVudFRpbWUudG9Mb2NhbGVTdHJpbmcoImVuLVVTIiwgeyB0aW1lWm9uZTogem9uZSB9KTsKICAgICAgICAgICAgdmFyIGRpZmZlcmVuY2VUaW1lID0KICAgICAgICAgICAgICAgIGdyYWNlUGVyaW9kID4gMAogICAgICAgICAgICAgICAgICAgID8gY3VycmVudFRpbWUuZ2V0VGltZSgpIC0gcGFya2luZ1N0YXJ0VGltZSAqIDEwMDAgLy8gLSBncmFjZVBlcmlvZCAqIDEwMDAgdG8gZXhjbHVkZSBncmFjZSBwZXJpb2QKICAgICAgICAgICAgICAgICAgICA6IGN1cnJlbnRUaW1lLmdldFRpbWUoKSAtIHBhcmtpbmdTdGFydFRpbWUgKiAxMDAwOwogICAgICAgICAgICBsZXQgcGFya2VkVGltZSA9IHRoaXMuc2Vjb25kc1RvSG1zKGRpZmZlcmVuY2VUaW1lIC8gMTAwMCk7CiAgICAgICAgICAgIHJldHVybiBwYXJrZWRUaW1lOwogICAgICAgIH0sCiAgICAgICAgc2Vjb25kc1RvSG1zKHRpbWVEaWZmZXJlbmNlKSB7CiAgICAgICAgICAgIHZhciBkID0gTnVtYmVyKHRpbWVEaWZmZXJlbmNlKTsKICAgICAgICAgICAgLy8gaWYgKHRpbWVEaWZmZXJlbmNlID49IDg2NDAwKSB7CiAgICAgICAgICAgIC8vICAgdmFyIGRheXMgPSBNYXRoLmZsb29yKGQgLyA4NjQwMCk7CiAgICAgICAgICAgIC8vICAgdmFyIGhycyA9IE1hdGguZmxvb3IoKGQgJSA4NjQwMCkgLyAzNjAwKTsKICAgICAgICAgICAgLy8gICB2YXIgZGF5RGlzcGxheSA9CiAgICAgICAgICAgIC8vICAgICBkYXlzID4gMCA/IGRheXMgKyAoZGF5cyA9PSAxID8gIiBkYXkgIiA6ICIgZGF5cyAiKSA6ICIiOwogICAgICAgICAgICAvLyAgIHZhciBockRpc3BsYXkgPSBocnMgPiAwID8gaHJzICsgKGhycyA9PSAxID8gIiBociAiIDogIiBocnMgIikgOiAiIjsKICAgICAgICAgICAgLy8gICByZXR1cm4gZGF5RGlzcGxheSArIGhyRGlzcGxheTsKICAgICAgICAgICAgLy8gfQogICAgICAgICAgICB2YXIgaCA9IE1hdGguZmxvb3IoZCAvIDM2MDApOwogICAgICAgICAgICB2YXIgbSA9IE1hdGguZmxvb3IoKGQgJSAzNjAwKSAvIDYwKTsKICAgICAgICAgICAgLy8gdmFyIHMgPSBNYXRoLmZsb29yKGQgJSAzNjAwICUgNjApOwogICAgICAgICAgICB2YXIgaERpc3BsYXkgPSBoID4gMCA/IGggKyAiIGggIiA6ICIiOwogICAgICAgICAgICB2YXIgbURpc3BsYXkgPSBtID4gMCA/IG0gKyAobSA9PSAxID8gIiBtaW4gIiA6ICIgbWluIikgOiAiIDAgbWluIjsKICAgICAgICAgICAgLy8gdmFyIHNEaXNwbGF5ID0gcyA+IDAgPyBzICsgKHMgPT0gMSA/ICIgc2Vjb25kIiA6ICIgc2Vjb25kcyIpIDogIiI7CiAgICAgICAgICAgIHJldHVybiBoRGlzcGxheSArIG1EaXNwbGF5OwogICAgICAgIH0sCiAgICAgICAgaXNDaGVja291dEVuYWJsZWQodHlwZSkgewogICAgICAgICAgICBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodGhpcy5ib29raW5nRGV0YWlscywgJ2V4aXRPcHRpb25zJykgJiYgdGhpcy5ib29raW5nRGV0YWlscy5leGl0T3B0aW9ucy5sZW5ndGggIT0gMCkgewogICAgICAgICAgICAgICAgbGV0IG9wdGlvbiA9IHRoaXMuYm9va2luZ0RldGFpbHMuZXhpdE9wdGlvbnMuc29tZSgKICAgICAgICAgICAgICAgICAgICAodCkgPT4gdC50ZWNoVHlwZSA9PSB0eXBlCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbjsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIH0sCiAgICAgICAgYXN5bmMgZ2V0Qm9va2luZ0RldGFpbHMoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgYm9va2luZ0lkID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnN1YnN0cmluZygzKTsKICAgICAgICAgICAgICAgIHZhciBib29raW5nRGV0YWlscyA9IGF3YWl0IEFQSUhlbHBlcigKICAgICAgICAgICAgICAgICAgICAiR0VUIiwKICAgICAgICAgICAgICAgICAgICAiL2FwaS92MS9ib29raW5nL2NvbmZpZy8iICsgYm9va2luZ0lkCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KAogICAgICAgICAgICAgICAgICAgICJTRVRfQk9PS0lOR19ERVRBSUxTIiwKICAgICAgICAgICAgICAgICAgICBib29raW5nRGV0YWlscy5kYXRhPy5kYXRhID8gYm9va2luZ0RldGFpbHMuZGF0YS5kYXRhIDogbnVsbAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgZ2V0cGVkZXN0cmlhbkFjY2VzcygpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIC8vIGxldCBib29raW5nSWQgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3Vic3RyaW5nKDMpOwogICAgICAgICAgICAgICAgdmFyIHBlZGVzQWNjZXNzID0gYXdhaXQgQVBJSGVscGVyKAogICAgICAgICAgICAgICAgICAgICJQT1NUIiwKICAgICAgICAgICAgICAgICAgICAiYXBpL3YxL29wZW4vIiArIHRoaXMuYm9va2luZ0lkLAogICAgICAgICAgICAgICAgICAgIHsgc291cmNlOiAid2ViVmlldyIgfQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHBlZGVzQWNjZXNzKQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocGVkZXNBY2Nlc3M/LmRhdGE/LnN0YXR1cykKICAgICAgICAgICAgICAgIGlmIChwZWRlc0FjY2Vzcz8uZGF0YT8uc3RhdHVzKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3N0VG9Mb2dnZXJBUEkoewogICAgICAgICAgICAgICAgICAgICAgICBwaG9uZTogdGhpcy5ib29raW5nRGV0YWlscy51c2VyLmNvbnRhY3QsCiAgICAgICAgICAgICAgICAgICAgICAgIHJlZklkOiB0aGlzLmJvb2tpbmdJZCwKICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6ICJodHRwczovL3NwcGwtZGV2LmRpdnJ0LmNvL2ltZy9wZWRlc3RyYWluX2Rvb3IuMDQyZjA5MjcucG5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogIlBhcmtlciBhY2Nlc3NlZCBwZWRlc3RyaWFuIGRvb3Igc3VjY2Vzc2Z1bGx5LiIsCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UoeyBwYXRoOiAiL3BlZGVzdHJpYW5hY2Nlc3MiIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnBlZGVzdHJpYW5BY2Nlc3NUZXh0ID0gcGVkZXNBY2Nlc3MuZGF0YS5tZXNzYWdlOwogICAgICAgICAgICAgICAgICAgIHRoaXMucG9zdFRvTG9nZ2VyQVBJKHsKICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmU6IHRoaXMuYm9va2luZ0RldGFpbHMudXNlci5jb250YWN0LAogICAgICAgICAgICAgICAgICAgICAgICByZWZJZDogdGhpcy5ib29raW5nSWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiB0aGlzLnBlZGVzdHJpYW5BY2Nlc3NUZXh0LAogICAgICAgICAgICAgICAgICAgICAgICBpbWFnZTogImh0dHBzOi8vc3BwbC1kZXYuZGl2cnQuY28vaW1nL3BlZGVzdHJhaW5fZG9vci4wNDJmMDkyNy5wbmciLAogICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OiAiRXJyb3IgaW4gb3BlbmluZyB0aGUgcGVkZXN0cmlhbiBkb29yLiIsCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5wZWRlc3RyaWFuQWNjZXNzRGlhbG9nID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIucmVwbGFjZSh7IHBhdGg6ICIvcGVkZXN0cmlhbmFjY2Vzcy8iK3RydWUgfSk7CiAgICAgICAgfSwKICAgICAgICBuYXZpZ2F0ZVRvQWRkUGF5bWVudCgpIHsKICAgICAgICAgICAgdGhpcy5wb3N0VG9Mb2dnZXJBUEkoewogICAgICAgICAgICAgICAgcGhvbmU6IHRoaXMuYm9va2luZ0RldGFpbHMudXNlci5jb250YWN0LAogICAgICAgICAgICAgICAgcmVmSWQ6IHRoaXMuYm9va2luZ0lkLAogICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogIlBhcmtlciBjbGlja2VkIG9uIEFERCBDUkVESVQgQ0FSRCBidG4uIiwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKHsgcGF0aDogIi9hZGRwYXltZW50IiB9KTsKICAgICAgICB9LAogICAgICAgIG9wZW5WYWxpZGF0aW9uRGlhbG9nKCkgewogICAgICAgICAgICB0aGlzLnZhbGlkYXRlQm9va2luZ0RpYWxvZyA9IHRydWU7CiAgICAgICAgfSwKICAgICAgICBhc3luYyBvcGVuU01TQXBwKCkgewogICAgICAgICAgICB0aGlzLnBvc3RUb0xvZ2dlckFQSSh7CiAgICAgICAgICAgICAgICBwaG9uZTogdGhpcy5ib29raW5nRGV0YWlscy51c2VyLmNvbnRhY3QsCiAgICAgICAgICAgICAgICByZWZJZDogdGhpcy5ib29raW5nSWQsCiAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OiAiUGFya2VyIGNsaWNrZWQgb24gU01TIHN1Ym1pdCBidG4uIiwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmICh0aGlzLnNtc1RleHQgPT0gbnVsbCB8fCB0aGlzLnNtc1RleHQgPT0gIiIpIHsKICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZFNNU01zZyA9ICJHYXRlIGNvZGUgY2Fubm90IGJlIGVtcHR5IjsKICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZFNNU0RpYWxvZyA9IHRydWU7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuc21zUGVuZGluZyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHByZVZhbGlkYXRlU2VuZFNNUyA9IGF3YWl0IEFQSUhlbHBlcigiUE9TVCIsICIvcmVjZWl2ZV9zbXMiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJpZDogdGhpcy5ib29raW5nSWQsCiAgICAgICAgICAgICAgICAgICAgICAgIEZyb206IHRoaXMuYm9va2luZ0RldGFpbHMudXNlci5jb250YWN0LAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0OiB0aGlzLnNtc1RleHQsCiAgICAgICAgICAgICAgICAgICAgICAgIFRvOiB0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUuVG9Nb2JpbGVObywKICAgICAgICAgICAgICAgICAgICAgICAgTW9kZTogIlNNUyIsCiAgICAgICAgICAgICAgICAgICAgICAgIHdlYlZpZXc6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgcHJlVmFsaWRhdGU6IDEsCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zbXNQZW5kaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgICAgICBwcmVWYWxpZGF0ZVNlbmRTTVM/LmRhdGE/LnN0YXR1cyAmJgogICAgICAgICAgICAgICAgICAgICAgICBwcmVWYWxpZGF0ZVNlbmRTTVMuZGF0YS5zdGF0dXMKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zbXNEaWFsb2cgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UoeyBwYXRoOiAiL3N1Y2Nlc3MiIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbmRTTVMgPSBhd2FpdCBBUElIZWxwZXIoIlBPU1QiLCAiL3JlY2VpdmVfc21zIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpZDogdGhpcy5ib29raW5nSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRnJvbTogdGhpcy5ib29raW5nRGV0YWlscy51c2VyLmNvbnRhY3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dDogdGhpcy5zbXNUZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRvOiB0aGlzLmJvb2tpbmdEZXRhaWxzLnpvbmUuVG9Nb2JpbGVObywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RlOiAiU01TIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3ZWJWaWV3OiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZW5kU01TPy5kYXRhPy5zdGF0dXMgJiYgc2VuZFNNUy5kYXRhLnN0YXR1cykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc21zRGlhbG9nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3N0VG9Mb2dnZXJBUEkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaG9uZTogdGhpcy5ib29raW5nRGV0YWlscy51c2VyLmNvbnRhY3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZklkOiB0aGlzLmJvb2tpbmdJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogImxvZ291dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiUGFya2VyIGNoZWNrZWQgb3V0IHN1Y2Nlc3NmdWxseSB1c2luZyBTTVMgLSAiICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc21zVGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnZhbGlkU01TTXNnID0gc2VuZFNNUz8uZGF0YT8ubWVzc2FnZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHNlbmRTTVMuZGF0YS5tZXNzYWdlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogIlBsZWFzZSB0cnkgYWdhaW4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZFNNU0RpYWxvZyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3N0VG9Mb2dnZXJBUEkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaG9uZTogdGhpcy5ib29raW5nRGV0YWlscy51c2VyLmNvbnRhY3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZklkOiB0aGlzLmJvb2tpbmdJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHRoaXMuaW52YWxpZFNNU01zZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogImxvZ291dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRXJyb3Igb2NjdXJlZCB3aGlsZSBjaGVja2luZyBvdXQgdXNpbmcgU01TIC0gIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNtc1RleHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRTTVNNc2cgPSBwcmVWYWxpZGF0ZVNlbmRTTVM/LmRhdGE/Lm1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gcHJlVmFsaWRhdGVTZW5kU01TLmRhdGEubWVzc2FnZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAiUGxlYXNlIHRyeSBhZ2FpbiI7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZFNNU0RpYWxvZyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9zdFRvTG9nZ2VyQVBJKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBob25lOiB0aGlzLmJvb2tpbmdEZXRhaWxzLnVzZXIuY29udGFjdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZklkOiB0aGlzLmJvb2tpbmdJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiB0aGlzLmludmFsaWRTTVNNc2csCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uOiAibG9nb3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkVycm9yIG9jY3VyZWQgd2hpbGUgY2hlY2tpbmcgb3V0IHVzaW5nIFNNUyAtICIgKyB0aGlzLnNtc1RleHQsCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBnZXRNb2JpbGVPcGVyYXRpbmdTeXN0ZW0oKSB7CiAgICAgICAgICAgIHZhciB1c2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50IHx8IG5hdmlnYXRvci52ZW5kb3IgfHwgd2luZG93Lm9wZXJhOwogICAgICAgICAgICAvLyBXaW5kb3dzIFBob25lIG11c3QgY29tZSBmaXJzdCBiZWNhdXNlIGl0cyBVQSBhbHNvIGNvbnRhaW5zICJBbmRyb2lkIgogICAgICAgICAgICBpZiAoL3dpbmRvd3MgcGhvbmUvaS50ZXN0KHVzZXJBZ2VudCkpIHsKICAgICAgICAgICAgICAgIHJldHVybiAiV2luZG93cyBQaG9uZSI7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgvYW5kcm9pZC9pLnRlc3QodXNlckFnZW50KSkgewogICAgICAgICAgICAgICAgcmV0dXJuICJBbmRyb2lkIjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gaU9TIGRldGVjdGlvbiBmcm9tOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS85MDM5ODg1LzE3NzcxMAogICAgICAgICAgICBpZiAoL2lQYWR8aVBob25lfGlQb2QvLnRlc3QodXNlckFnZW50KSAmJiAhd2luZG93Lk1TU3RyZWFtKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gImlPUyI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICJ1bmtub3duIjsKICAgICAgICB9LAogICAgICAgIGdldEV4aXRJY29uKGV4aXRJZCkgewogICAgICAgICAgICBsZXQgZXhpdERldGFpbHMgPSB0aGlzLmJvb2tpbmdEZXRhaWxzLmV4aXRPcHRpb25zLmZpbmQoCiAgICAgICAgICAgICAgICAocCkgPT4gcC50ZWNoVHlwZSA9PSBleGl0SWQKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuIGV4aXREZXRhaWxzLmljb247CiAgICAgICAgfSwKICAgICAgICBnZXRFeGl0VGV4dChleGl0SWQpIHsKICAgICAgICAgICAgbGV0IGV4aXREZXRhaWxzID0gdGhpcy5ib29raW5nRGV0YWlscy5leGl0T3B0aW9ucy5maW5kKAogICAgICAgICAgICAgICAgKHApID0+IHAudGVjaFR5cGUgPT0gZXhpdElkCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybiBleGl0RGV0YWlscy5uYW1lOwogICAgICAgIH0sCiAgICAgICAgb3BlbkRpYWxlckFwcCgpIHsKICAgICAgICAgICAgdGhpcy5wb3N0VG9Mb2dnZXJBUEkoewogICAgICAgICAgICAgICAgcGhvbmU6IHRoaXMuYm9va2luZ0RldGFpbHMudXNlci5jb250YWN0LAogICAgICAgICAgICAgICAgcmVmSWQ6IHRoaXMuYm9va2luZ0lkLAogICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogIlBhcmtlciBjbGlja2VkIG9uIGRpYWxlciBzdWJtaXQgYnRuLiIsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLmRpYWxlckRpYWxvZyA9IGZhbHNlOwogICAgICAgICAgICB2YXIgdXJsID0gInRlbDoiICsgdGhpcy5ib29raW5nRGV0YWlscy56b25lLlRvTW9iaWxlTm87CiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdXJsOwogICAgICAgICAgICBpZiAodGhpcy5nZXRNb2JpbGVPcGVyYXRpbmdTeXN0ZW0oKSA9PSAiQW5kcm9pZCIpIHsKICAgICAgICAgICAgICAgIHdpbmRvdy5jbG9zZSgpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB0dXJuQ2FtZXJhT24oKSB7CiAgICAgICAgICAgIHRoaXMuY2FtZXJhID0gImF1dG8iOwogICAgICAgIH0sCgogICAgICAgIHR1cm5DYW1lcmFPZmYoKSB7CiAgICAgICAgICAgIHRoaXMuY2FtZXJhID0gIm9mZiI7CiAgICAgICAgfSwKICAgICAgICB2YWxpZGF0ZURlY29kZWRTdHJpbmcoc3RyKSB7CiAgICAgICAgICAgIGxldCB2YWxpZGF0ZURpdnJ0U3RyID0gc3RyLnN0YXJ0c1dpdGgoImRpdnJ0Oi8vIik7CiAgICAgICAgICAgIGxldCB2YWxpZGF0ZU1NSUQgPSBzdHIuc3BsaXQoIi8iKVsyXSA9PSB0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcubW1pZDsKICAgICAgICAgICAgbGV0IHZhbGlkYXRlTWFqb3JJZCA9CiAgICAgICAgICAgICAgICBzdHIuc3BsaXQoIi8iKVszXSA9PSB0aGlzLmJvb2tpbmdEZXRhaWxzLmJvb2tpbmcubWFqb3JpZDsKICAgICAgICAgICAgbGV0IHZhbGlkYXRlTWlub3JJZCA9IHRoaXMuYm9va2luZ0RldGFpbHMuYm9va2luZy5taW5vcl9pZHMuaW5jbHVkZXMoCiAgICAgICAgICAgICAgICBzdHIuc3BsaXQoIi8iKVs0XQogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgdmFsaWRhdGVEaXZydFN0ciAmJiB2YWxpZGF0ZU1NSUQgJiYgdmFsaWRhdGVNYWpvcklkICYmIHZhbGlkYXRlTWlub3JJZAogICAgICAgICAgICApOwogICAgICAgIH0sCiAgICAgICAgYXN5bmMgb25EZWNvZGUoZGVjb2RlZFN0cmluZykgewogICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICAgIHRoaXMucXJDb2RlID0gZGVjb2RlZFN0cmluZzsKICAgICAgICAgICAgdGhpcy5jYW1lcmFTdGF0dXMgPSBmYWxzZTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHZhciBwcmVWYWxpZGF0ZVFyUmVzdWx0ID0gYXdhaXQgQVBJSGVscGVyKAogICAgICAgICAgICAgICAgICAgICJQT1NUIiwKICAgICAgICAgICAgICAgICAgICAiL2FwaS92MS9jaGVja291dC8iICsgdGhpcy5ib29raW5nSWQsCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBiZWFjb25JZDogZGVjb2RlZFN0cmluZywKICAgICAgICAgICAgICAgICAgICAgICAgcHJlVmFsaWRhdGU6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgIHppZDogdGhpcy5ib29raW5nRGV0YWlscy56b25lLmxvY2F0aW9uQ29kZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBpZiAocHJlVmFsaWRhdGVRclJlc3VsdC5kYXRhLnN0YXR1cykgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuJHJvdXRlci5yZXBsYWNlKHsgcGF0aDogIi9zdWNjZXNzIiB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFyUmVzdWx0ID0gYXdhaXQgQVBJSGVscGVyKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlBPU1QiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIi9hcGkvdjEvY2hlY2tvdXQvIiArIHRoaXMuYm9va2luZ0lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlYWNvbklkOiBkZWNvZGVkU3RyaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHppZDogdGhpcy5ib29raW5nRGV0YWlscy56b25lLmxvY2F0aW9uQ29kZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAocXJSZXN1bHQuZGF0YS5zdGF0dXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9zdFRvTG9nZ2VyQVBJKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaG9uZTogc2VsZi5ib29raW5nRGV0YWlscy51c2VyLmNvbnRhY3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmSWQ6IHNlbGYuYm9va2luZ0lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb246ICJsb2dvdXQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJQYXJrZXIgc3VjY2Vzc2Z1bGx5IGNoZWNrZWQgb3V0IHVzaW5nIFFSIC0gIiArIGRlY29kZWRTdHJpbmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgiU0VUX0NIRUNLT1VUIiwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRRUk1zZyA9IHFyUmVzdWx0Py5kYXRhPy5tZXNzYWdlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBxclJlc3VsdC5kYXRhLm1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICJQbGVhc2UgdHJ5IGFnYWluIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZFFSRGlhbG9nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9zdFRvTG9nZ2VyQVBJKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaG9uZTogc2VsZi5ib29raW5nRGV0YWlscy51c2VyLmNvbnRhY3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmSWQ6IHNlbGYuYm9va2luZ0lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBzZWxmLmludmFsaWRRUk1zZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uOiAibG9nb3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRXJyb3IgT2NjdXJlZCB3aGlsZSBjaGVja2luZyBvdXQgdXNpbmcgUVIgLSAiICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVjb2RlZFN0cmluZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnZhbGlkUVJNc2cgPSBwcmVWYWxpZGF0ZVFyUmVzdWx0Py5kYXRhPy5tZXNzYWdlCiAgICAgICAgICAgICAgICAgICAgICAgID8gcHJlVmFsaWRhdGVRclJlc3VsdC5kYXRhLm1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICAgICAgOiAiUGxlYXNlIHRyeSBhZ2FpbiI7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnZhbGlkUVJEaWFsb2cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHRoaXMucG9zdFRvTG9nZ2VyQVBJKHsKICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmU6IHNlbGYuYm9va2luZ0RldGFpbHMudXNlci5jb250YWN0LAogICAgICAgICAgICAgICAgICAgICAgICByZWZJZDogc2VsZi5ib29raW5nSWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGljb246ICJsb2dvdXQiLAogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogc2VsZi5pbnZhbGlkUVJNc2csCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRXJyb3IgT2NjdXJlZCB3aGlsZSBjaGVja2luZyBvdXQgdXNpbmcgUVIgLSAiICsgZGVjb2RlZFN0cmluZywKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgb25Jbml0KHByb21pc2UpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGF3YWl0IHByb21pc2U7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBpZiAoZXJyb3IubmFtZSA9PT0gIk5vdEFsbG93ZWRFcnJvciIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRRUk1zZyA9ICJQbGVhc2UgZ3JhbnQgY2FtZXJhIGFjY2VzcyBwZXJtaXNzb24iOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvci5uYW1lID09PSAiTm90Rm91bmRFcnJvciIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRRUk1zZyA9ICJObyBjYW1lcmEgZm91bmQgb24gdGhpcyBkZXZpY2UiOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvci5uYW1lID09PSAiTm90U3VwcG9ydGVkRXJyb3IiKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnZhbGlkUVJNc2cgPSAiU2VjdXJlIGNvbnRleHQgcmVxdWlyZWQgKEhUVFBTLCBsb2NhbGhvc3QpIjsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3IubmFtZSA9PT0gIk5vdFJlYWRhYmxlRXJyb3IiKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnZhbGlkUVJNc2cgPSAiSXMgdGhlIGNhbWVyYSBhbHJlYWR5IGluIHVzZT8gUGxlYXNlIGNoZWNrLiI7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yLm5hbWUgPT09ICJPdmVyY29uc3RyYWluZWRFcnJvciIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRRUk1zZyA9ICJJbnN0YWxsZWQgY2FtZXJhIGlzIG5vdCBzdWl0YWJsZSI7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yLm5hbWUgPT09ICJTdHJlYW1BcGlOb3RTdXBwb3J0ZWRFcnJvciIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRRUk1zZyA9ICJTdHJlYW0gQVBJIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBicm93c2VyIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZFFSRGlhbG9nID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgb25WYWxpZGF0ZVRleHQoKSB7CiAgICAgICAgICAgIHRoaXMudmFsaWRhdGVCb29raW5nUGVuZGluZyA9IHRydWU7CiAgICAgICAgICAgIGxldCByZXN1bHQgPSBhd2FpdCB0aGlzLnZhbGlkYXRlQm9va2luZyh0aGlzLnZhbGlkYXRlQm9va2luZ1R4dCk7CiAgICAgICAgICAgIGlmICghcmVzdWx0LmRhdGEuc3RhdHVzKSB7CiAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRTTVNNc2cgPSByZXN1bHQ/LmRhdGE/Lm1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICA/IHJlc3VsdC5kYXRhLm1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICA6ICJWYWxpZGF0aW9uIG5vdCByZWNvZ25pemVkLiBQbGVhc2UgdHJ5IGFnYWluIjsKICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZFNNU0RpYWxvZyA9IHRydWU7CiAgICAgICAgICAgICAgICB0aGlzLnZhbGlkYXRlQm9va2luZ1BlbmRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMucG9zdFRvTG9nZ2VyQVBJKHsKICAgICAgICAgICAgICAgICAgICBwaG9uZTogdGhpcy5ib29raW5nRGV0YWlscy51c2VyLmNvbnRhY3QsCiAgICAgICAgICAgICAgICAgICAgcmVmSWQ6IHRoaXMuYm9va2luZ0lkLAogICAgICAgICAgICAgICAgICAgIGVycm9yOiB0aGlzLmludmFsaWRTTVNNc2csCiAgICAgICAgICAgICAgICAgICAgaWNvbjogInJlZGVlbSIsCiAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDoKICAgICAgICAgICAgICAgICAgICAgICAgIkVycm9yIGluIHZhbGlkYXRpbmcgdGhlIHNlc3Npb24gb24gZW50ZXJpbmcgdmFsaWRhdGlvbiBjb2RlIC0gIiArCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGVCb29raW5nVHh0LAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLnBvc3RUb0xvZ2dlckFQSSh7CiAgICAgICAgICAgICAgICAgICAgcGhvbmU6IHRoaXMuYm9va2luZ0RldGFpbHMudXNlci5jb250YWN0LAogICAgICAgICAgICAgICAgICAgIHJlZklkOiB0aGlzLmJvb2tpbmdJZCwKICAgICAgICAgICAgICAgICAgICBpY29uOiAicmVkZWVtIiwKICAgICAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OgogICAgICAgICAgICAgICAgICAgICAgICAiUGFya2VyIHZhbGlkYXRlZCB0aGUgc2Vzc2lvbiBzdWNjZXNzZnVsbHkgYnkgZW50ZXJpbmcgdmFsaWRhdGlvbiBjb2RlIC0gIiArCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGVCb29raW5nVHh0LAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB0aGlzLmdvbGRlbk51Z2dldCA9IGZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy52YWxpZGF0ZUJvb2tpbmdQZW5kaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLnZhbGlkYXRlQm9va2luZ0RpYWxvZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KAogICAgICAgICAgICAgICAgICAgICJTRVRfVkFMSURBVEVEX01FUkNIQU5UIiwKICAgICAgICAgICAgICAgICAgICByZXN1bHQ/LmRhdGE/Lm1lcmNoYW50TmFtZQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKHsgcGF0aDogIi92YWxpZGF0ZXN1Y2Nlc3MiIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBhc3luYyB2YWxpZGF0ZUJvb2tpbmcoY29kZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbGV0IHZhbGlkYXRlUmVzdWx0ID0gYXdhaXQgQVBJSGVscGVyKAogICAgICAgICAgICAgICAgICAgICJQT1NUIiwKICAgICAgICAgICAgICAgICAgICAiL2FwaS92MS92YWxpZGF0ZS8iICsgdGhpcy5ib29raW5nSWQsCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBjb3Vwb246IGNvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgIHppZDogdGhpcy5ib29raW5nRGV0YWlscy56b25lLmxvY2F0aW9uQ29kZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICByZXR1cm4gdmFsaWRhdGVSZXN1bHQ7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgICAgICAgICByZXR1cm4gZXJyb3I7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGFzeW5jIG9wZW5TY2FuVmFsaWRhdGlvbkNvZGUoKSB7CiAgICAgICAgICAgIHRoaXMudmFsaWRhdGVCb29raW5nRGlhbG9nID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMudmFsaWRhdGVCb29raW5nVHh0ID0gIiI7CiAgICAgICAgICAgIHRoaXMudmFsaWRhdGVRUkNvZGVEaWFsb2cgPSB0cnVlOwogICAgICAgICAgICB0aGlzLnZhbGlkYXRpb25DYW1lcmFTdGF0dXMgPSB0cnVlOwogICAgICAgIH0sCiAgICAgICAgYXN5bmMgb25WYWxpZGF0ZVFSQ29kZShkZWNvZGVkU3RyaW5nKSB7CiAgICAgICAgICAgIHRoaXMudmFsaWRhdGlvbkNhbWVyYVN0YXR1cyA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLnZhbGlkYXRlUVJDb2RlUGVuZGluZyA9IHRydWU7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgdGhpcy52YWxpZGF0ZUJvb2tpbmcoZGVjb2RlZFN0cmluZyk7CiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdC5kYXRhLnN0YXR1cykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZFZhbGlkYXRpb25RUk1zZyA9IHJlc3VsdD8uZGF0YT8ubWVzc2FnZQogICAgICAgICAgICAgICAgICAgICAgICA/IHJlc3VsdC5kYXRhLm1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICAgICAgOiAiVmFsaWRhdGlvbiBub3QgcmVjb2duaXplZC4gUGxlYXNlIHRyeSBhZ2FpbiI7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnZhbGlkVmFsaWRhdGlvblFSRGlhbG9nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbGlkYXRlUVJDb2RlUGVuZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHRoaXMucG9zdFRvTG9nZ2VyQVBJKHsKICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmU6IHRoaXMuYm9va2luZ0RldGFpbHMudXNlci5jb250YWN0LAogICAgICAgICAgICAgICAgICAgICAgICByZWZJZDogdGhpcy5ib29raW5nSWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiB0aGlzLmludmFsaWRRUk1zZywKICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogInJlZGVlbSIsCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRXJyb3IgaW4gdmFsaWRhdGluZyB0aGUgc2Vzc2lvbiBvbiBzY2FubmluZyB2YWxpZGF0aW9uIFFSIC0gIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNvZGVkU3RyaW5nLAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc3RUb0xvZ2dlckFQSSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHBob25lOiB0aGlzLmJvb2tpbmdEZXRhaWxzLnVzZXIuY29udGFjdCwKICAgICAgICAgICAgICAgICAgICAgICAgcmVmSWQ6IHRoaXMuYm9va2luZ0lkLAogICAgICAgICAgICAgICAgICAgICAgICBpY29uOiAicmVkZWVtIiwKICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJQYXJrZXIgdmFsaWRhdGVkIHRoZSBzZXNzaW9uIHN1Y2Nlc3NmdWxseSBieSBzY2FubmluZyB2YWxpZGF0aW9uIFFSIC0gIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNvZGVkU3RyaW5nLAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGVRUkNvZGVQZW5kaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWxpZGF0ZVFSQ29kZURpYWxvZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgKICAgICAgICAgICAgICAgICAgICAgICAgIlNFVF9WQUxJREFURURfTUVSQ0hBTlQiLAogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ/LmRhdGE/Lm1lcmNoYW50TmFtZQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UoeyBwYXRoOiAiL3ZhbGlkYXRlc3VjY2VzcyIgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgfSwKfQo="},{"version":3,"sources":["CheckedIn.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA67BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CheckedIn.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <v-container class=\"pa-4\" fluid>\n        <v-row class=\"text-center\" no-gutters>\n            <v-col cols=\"12\">\n                <v-img alt=\"PARKING.COM\" class=\"my-3\" height=\"42\" contain src=\"../assets/logo_huge_drk.png\" />\n            </v-col>\n        </v-row>\n        <v-row no-gutters>\n            <v-col>\n                <v-card class=\"mx-auto rounded-lg\" max-width=\"374\">\n                    <v-dialog v-model=\"loading\" persistent>\n                        <v-card class=\"pa-4\">\n                            <v-progress-circular indeterminate color=\"red\"></v-progress-circular>\n                            <span class=\"ml-4\" style=\"font-size: 14px\">Please wait...</span>\n                        </v-card>\n                    </v-dialog>\n                    <!-- <v-responsive :aspect-ratio=\"16/9\"> -->\n\n                    <template slot=\"progress\">\n                        <v-progress-linear color=\"red\" height=\"10\" indeterminate></v-progress-linear>\n                    </template>\n                    <div style=\"position: relative\">\n                        <!-- <v-skeleton-loader\n                  v-show=\"!bookingDetails.hasOwnProperty('zone')\"\n                  height=\"260px\"\n                  class=\"rounded-t-lg\"\n                  type=\"image\"\n                ></v-skeleton-loader>-->\n                        <v-img class=\"rounded-t-lg\" :max-height=\"logoHeight\" style=\"filter: brightness(50%)\" :src=\"bookingDetails.hasOwnProperty('zone') &&\n                            bookingDetails.zone.image != '' &&\n                            bookingDetails.zone.image != null\n                            ? bookingDetails.zone.image\n                            : zoneImgURL\n                            \" :lazy-src=\"bookingDetails.hasOwnProperty('zone') &&\n        bookingDetails.zone.image != '' &&\n        bookingDetails.zone.image != null\n        ? bookingDetails.zone.image\n        : zoneImgURL\n        \" alt=\"Parking.com garage\">\n                            <template v-slot:placeholder>\n                                <v-row class=\"fill-height ma-0\" align=\"center\" justify=\"center\" no-gutters>\n                                    <v-progress-circular indeterminate color=\"grey lighten-5\"></v-progress-circular>\n                                </v-row>\n                            </template>\n                        </v-img>\n                        <div class=\"booking_header white--text text-left mr-4\">\n                            <span>\n                                {{\n                                    bookingDetails.hasOwnProperty(\"booking\")\n                                    ? bookingDetails.booking.header\n                                    : \"\"\n                                }}\n                            </span>\n                        </div>\n                        <div class=\"booking_divider_div\"\n                            v-if=\"Object.hasOwnProperty.call(bookingDetails, 'booking') && Object.hasOwnProperty.call(bookingDetails.booking, 'TypeOfBooking') && (bookingDetails.booking.TypeOfBooking != 'Self reservation')\">\n                            <v-divider class=\"booking_divider mx-4\"></v-divider>\n                        </div>\n                        <div class=\"booking_content white--text\"\n                            v-if=\"Object.hasOwnProperty.call(bookingDetails, 'booking') && Object.hasOwnProperty.call(bookingDetails.booking, 'TypeOfBooking') && bookingDetails.booking.TypeOfBooking != 'Self reservation'\">\n                            Checked in at\n                            {{\n                                bookingDetails.hasOwnProperty(\"booking\") ? booking_content : \"\"\n                            }}\n                            <span v-if=\"bookingDetails.hasOwnProperty('booking') &&\n                                bookingDetails.hasOwnProperty('zone') &&\n                                bookingDetails.booking.vehicleNo != null &&\n                                bookingDetails.booking.vehicleNo != ''\n                                \">\n                                with license plate\n                                {{\n                                    bookingDetails.hasOwnProperty(\"booking\")\n                                    ? bookingDetails.booking.vehicleNo\n                                    : \"\"\n                                }}\n                            </span>\n                        </div>\n                    </div>\n                    <v-fab-transition>\n                        <v-btn v-show=\"Object.hasOwnProperty.call(bookingDetails, 'zone') &&\n                                bookingDetails.zone.isPedestrian == 1\n                                \" class=\"fabIcon\" color=\"#f2555c !important\" fab dark raised large right\n                            @click=\"getpedestrianAccess()\" style=\"bottom: 35px; float: right; right: 10px\">\n                            <v-img src=\"../assets/pedestrain_door.png\" style=\"opacity: 1\" width=\"32\" height=\"32\"\n                                contain></v-img>\n                            <!-- <v-icon class=\"material-icons-outlined\">directions_walk</v-icon> -->\n                        </v-btn>\n                    </v-fab-transition>\n\n                    <v-card-title class=\"pa-1\"></v-card-title>\n                    <v-card-text class=\"pa-1\">\n                        <v-row align=\"center\" class=\"mx-0 pb-0\" no-gutters v-if=\"bookingDetails.hasOwnProperty('booking') &&\n                            bookingDetails.booking.hasOwnProperty('TypeOfBooking') &&\n                            bookingDetails.booking.TypeOfBooking != 'Self reservation'\">\n                            <v-col cols=\"2\">\n                                <v-icon style=\"font-size: 50px\">mdi-clock-outline</v-icon>\n                            </v-col>\n                            <v-col cols=\"10\" class=\"pl-1\">\n                                <v-row no-gutters class=\"counter-content-position\">\n                                    <v-col cols=\"12\" class=\"pa-0\">\n                                        <v-skeleton-loader v-show=\"!bookingDetails.hasOwnProperty('booking') ||\n                                            timeAgo == '' ||\n                                            timeAgo == null\n                                            \" height=\"40px\" max-width=\"200\" type=\"heading\"></v-skeleton-loader>\n                                        <span class=\"grey--text text--darken-1 time_ago\"\n                                            v-show=\"!(validatedDateTime > 0)\">{{\n                                                timeAgo\n                                            }}</span>\n                                        <!-- <span\n                          class=\"grey--text text--darken-1 time_ago\"\n                          v-show=\"gracePeriodTime > 0\"\n                          >{{ countDownGracePeriodTime }}</span\n                        >-->\n                                        <span class=\"grey--text text--darken-1 time_ago\" v-show=\"bookingDetails.hasOwnProperty('booking') &&\n                                                bookingDetails.booking.hasOwnProperty('validated') &&\n                                                bookingDetails.booking.validated == '1' &&\n                                                validatedDateTime > 0\n                                                \">{{ countDownValidatedTime }}</span>\n                                    </v-col>\n                                    <v-col cols=\"12\" v-if=\"bookingDetails.hasOwnProperty('booking') &&\n                                        validatedDateTime <= 0\n                                        \">\n                                        <span class=\"grey--text text--darken-1 time_ago_context\">Since you parked</span>\n                                    </v-col>\n                                    <!-- <v-col cols=\"12\" v-else-if=\"bookingDetails.hasOwnProperty('booking') && gracePeriodTime > 0\">\n                        <span class=\"grey--text text--darken-1 time_ago_context\"\n                          >Grace period remaining</span\n                        >\n                      </v-col>-->\n                                    <v-col cols=\"12\" v-else-if=\"bookingDetails.hasOwnProperty('booking') &&\n                                        bookingDetails.booking.hasOwnProperty('validated') &&\n                                        bookingDetails.booking.validated == '1' &&\n                                        validatedDateTime > 0\n                                        \">\n                                        <span class=\"grey--text text--darken-1 time_ago_context\">Validation time\n                                            remaining</span>\n                                    </v-col>\n                                    <v-col cols=\"12\" v-show=\"bookingDetails.hasOwnProperty('booking') &&\n                                        bookingDetails.booking.hasOwnProperty('validated') &&\n                                        bookingDetails.booking.validated == '1' &&\n                                        bookingDetails.booking.hasOwnProperty(\n                                            'validationType'\n                                        ) &&\n                                        bookingDetails.booking.validationType == 'DIVRT'\n                                        \">\n                                        <span class=\"grey--text text--darken-1 validated_time\">Validated until {{\n                                            validated_content\n                                        }}</span>\n                                    </v-col>\n                                </v-row>\n                            </v-col>\n                            <v-col cols class=\"align-self-center text-center\" v-show=\"bookingDetails.hasOwnProperty('booking') &&\n                                    bookingDetails.booking.hasOwnProperty('TypeOfBooking') &&\n                                    bookingDetails.booking.TypeOfBooking == 'Monthly'\n                                    \">\n                                <v-btn class=\"elevation-0 white--text\" tile x-small color=\"green darken-2\">Monthly</v-btn>\n                            </v-col>\n                            <v-col cols class=\"align-self-center text-center\" v-show=\"bookingDetails.hasOwnProperty('booking') &&\n                                bookingDetails.booking.hasOwnProperty('TypeOfBooking') &&\n                                bookingDetails.booking.TypeOfBooking == 'Employee'\n                                \">\n                                <v-btn class=\"elevation-0 white--text\" tile x-small color=\"green darken-2\">Employee</v-btn>\n                            </v-col>\n                        </v-row>\n                        <v-row class=\"mx-0 pb-0 black--text pl-2\" no-gutters v-if=\"bookingDetails.hasOwnProperty('booking') &&\n                            bookingDetails.booking.hasOwnProperty('TypeOfBooking') &&\n                            bookingDetails.booking.TypeOfBooking == 'Self reservation'\">\n                            <v-row no-gutters class=\"pb-4\"><v-col>\n                                    <div>\n                                        Checked in at\n                                        {{\n                                            bookingDetails.hasOwnProperty(\"booking\") ? checkin_content : \"\"\n                                        }}\n\n                                    </div>\n                                    <span v-if=\"bookingDetails.hasOwnProperty('booking') &&\n                                        bookingDetails.hasOwnProperty('zone') &&\n                                        bookingDetails.booking.revEnd != null &&\n                                        bookingDetails.booking.revEnd != ''\n                                        \">\n\n                                        {{ checkout_content }}\n                                    </span>\n                                </v-col></v-row>\n                        </v-row>\n                        <v-container fluid pa-0 style=\"margin-left: 4.5rem;\" v-if=\"bookingDetails.hasOwnProperty('booking') &&\n                            bookingDetails.booking.hasOwnProperty('TypeOfBooking') &&\n                            bookingDetails.booking.TypeOfBooking == 'Self reservation'\">\n                            <v-row no-gutters>\n                                <v-col cols=\"12\" class=\"pl-1    \">\n                                    <v-row no-gutters class=\"counter-content-position\">\n                                        <v-col cols=\"12\" class=\"pa-0\">\n                                            <v-icon class=\"material-icons-outlined pr-2\"\n                                                style=\"font-size: 50px\">history_toggle_off</v-icon>\n                                            <v-skeleton-loader v-show=\"!bookingDetails.hasOwnProperty('booking')\n                                                \" height=\"40px\" max-width=\"200\" type=\"heading\"></v-skeleton-loader>\n                                            <span class=\"grey--text text--darken-1 time_ago\" v-show=\"exitDateTime > 0\n                                                \">{{ countDownExitTime }}</span>\n                                            <p class=\"grey--text text--darken-1 time_ago_context pl-15 \"\n                                                style=\"margin-top: -15px;\" v-if=\"exitDateTime > 0\">Remaining</p>\n                                        </v-col>\n                                    </v-row>\n                                </v-col>\n                            </v-row>\n                        </v-container>\n                        <v-row no-gutters align=\"center\" class=\"my-1\">\n                            <v-col cols=\"12\" class=\"pa-0 align-self-center text-center\">\n                                <v-btn class=\"elevation-0 white--text\" tile x-small color=\"green darken-2\" v-show=\"bookingDetails.hasOwnProperty('booking') &&\n                                    bookingDetails.booking.hasOwnProperty('validated') &&\n                                    bookingDetails.booking.validated == '1'\n                                    \">VALIDATED</v-btn>\n                                <!-- <v-icon color=\"red\" class=\"ml-2\" v-show=\"(bookingDetails.hasOwnProperty('booking') && bookingDetails.booking.validated == '1' && showPaymentCardAdded == '1')\" >approval</v-icon> -->\n                            </v-col>\n                        </v-row>\n                        <v-row class=\"justify-center mb-3\" no-gutters v-show=\"Object.hasOwnProperty.call(bookingDetails, 'zone') &&\n                            !(bookingDetails.zone.isGated == '0')\n                            \">\n                            <span class=\"grey--text text--darken-1 font-weight-bold\"\n                                v-if=\"showPaymentCardAdded && (isCheckoutEnabled(1) || isCheckoutEnabled(2) || isCheckoutEnabled(3))\">Click\n                                an option below to exit</span>\n                        </v-row>\n                        <v-row class=\"justify-center my-3\" no-gutters\n                            v-show=\"!(isCheckoutEnabled(1) || isCheckoutEnabled(2) || isCheckoutEnabled(3))\">\n                            <span class=\"black--text text--darken-1 font-weight-bold text-h5\">Checked In</span>\n                        </v-row>\n                    </v-card-text>\n                    <!-- <v-card-text class=\"text-center\">Click an option to exit</v-card-text> -->\n                    <v-card-actions class=\"text-center justify-center px-0 pb-4  \" v-if=\"Object.hasOwnProperty.call(bookingDetails, 'booking') &&\n                        !showPaymentCardAdded\n                        \">\n                        <v-container class=\"pa-0\" fluid>\n                            <v-row no-gutters>\n                                <v-col cols=\"12\" class=\"px-4\"\n                                    v-if=\"iosDevice && Object.hasOwnProperty.call(bookingDetails, 'zone') && Object.hasOwnProperty.call(bookingDetails.zone, 'paymentServices') && Object.hasOwnProperty.call(bookingDetails.zone.paymentServices, 'apple_pay') && bookingDetails.zone.paymentServices.apple_pay == '1'\">\n                                    <apple-pay width='75%' height=\"43px\"\n                                        :ios-device=\"iosDevice && Object.hasOwnProperty.call(bookingDetails, 'zone') && Object.hasOwnProperty.call(bookingDetails.zone, 'paymentServices') && Object.hasOwnProperty.call(bookingDetails.zone.paymentServices, 'apple_pay') && bookingDetails.zone.paymentServices.apple_pay == '1'\"></apple-pay>\n                                </v-col>\n                                <v-col cols=\"12\" class=\"px-4\"\n                                    v-if=\"!iosDevice && Object.hasOwnProperty.call(bookingDetails, 'zone') && Object.hasOwnProperty.call(bookingDetails.zone, 'paymentServices') && Object.hasOwnProperty.call(bookingDetails.zone.paymentServices, 'google_pay') && bookingDetails.zone.paymentServices.google_pay == '1'\">\n                                    <google-pay width='75%' height=\"43px\"></google-pay>\n                                </v-col>\n                                <v-col cols=\"12\" class=\"px-4\">\n                                    <v-btn style=\"font-weight:700\" elevation=\"20\" rounded width=\"75%\"\n                                        class=\"add_credit_card_btn white--text  \" @click=\"navigateToAddPayment\"> Add Credit\n                                        Card</v-btn>\n                                </v-col>\n                                <v-col cols=\"12\" class=\"mt-4 text-center \"\n                                    v-if=\"bookingDetails.zone.isPQREndReservation == 1 && (bookingDetails.booking.TypeOfBooking == 'Guest' || bookingDetails.booking.TypeOfBooking == 'Transient')\">\n                                    <v-btn text color=\"primary\"\n                                        style=\"font-size: 14.5px;font-weight: bolder;text-decoration: underline;\"\n                                        @click=\"hotelGuest\">\n                                        <font-awesome-icon class=\"mr-1\" icon=\"fa-solid fa-hotel\"\n                                            style=\"font-size: 1.5rem; color: black;\" /> I am an\n                                        overnight\n                                        hotel guest</v-btn>\n\n                                </v-col>\n                                <v-col cols=\"12\" class=\"mt-10 pa-0\">\n                                    <v-card flat color=\"#ececec\" class=\"ma-0\" tile max-width=\"100%\">\n                                        <v-card-text>\n                                            <v-row class=\"text-center pt-0\" no-gutters>\n                                                <v-col cols=\"12\" class=\"pa-0\">\n                                                    <p style=\"font-size: 15px;color: #F2555C;font-weight: bolder;\">CLAIM\n                                                        YOUR PARKING DISCOUNT</p>\n                                                </v-col>\n                                                <v-col cols=\"12\"\n                                                    v-if=\"Object.hasOwnProperty.call(bookingDetails, 'zone') && Object.hasOwnProperty.call(bookingDetails.zone, 'isLoyaltySupported') && bookingDetails.zone.isLoyaltySupported == '1' && bookingDetails.booking.validated != '1' && (bookingDetails.booking.TypeOfBooking == 'Guest' || bookingDetails.booking.TypeOfBooking == 'Transient')\">\n                                                    <v-btn color=\"black\" class=\"pa-0 ma-0\" rounded width=\"270\" height=\"70\"\n                                                        elevation=\"20\" @click=\"loyalty = true\">\n                                                        <v-avatar tile width=\"200\" height=\"100\">\n                                                            <v-img src=\"../assets/GNLoyalty.png\" height=\"60px\"\n                                                                width=\"400px\"></v-img>\n                                                        </v-avatar>\n                                                    </v-btn>\n                                                </v-col>\n                                            </v-row>\n                                            <v-col cols=\"12\" class=\"mt-4 px-4\" v-show=\"bookingDetails.hasOwnProperty('booking') &&\n                                                bookingDetails.booking.hasOwnProperty('validated') &&\n                                                bookingDetails.booking.validated != '1' &&\n                                                bookingDetails.booking.isValidationEnabled == '1'\n                                                \">\n                                                <v-btn rounded elevation=\"20\" dense width=\"90%\" height=\"40px\"\n                                                    style=\"font-size:18px\"\n                                                    class=\"validate_btn white--text blue darken-2 no-upper-case px-4\"\n                                                    @click=\"openValidationDialog()\">Apply\n                                                    Your Validation</v-btn>\n                                            </v-col>\n                                        </v-card-text>\n                                    </v-card>\n                                </v-col>\n                                <v-divider style=\"color:black\"></v-divider>\n                                <v-col cols=\"12\" class=\"mt-4 text-center color-black px-4\" style=\"font-size: 12px;\" v-show=\"Object.hasOwnProperty.call(bookingDetails, 'zone') &&\n                                    !(bookingDetails.zone.isGated == '0')\n                                    \">\n                                    <p>\n                                        Credit card is required unless otherwise specified. Please enter your card number\n                                        now to avoid a slow\n                                        down at the exit.\n                                    </p>\n                                </v-col>\n                                <v-col cols=\"12\" class=\"mt-4 text-center color-black px-4\" style=\"font-size: 12px\" v-show=\"Object.hasOwnProperty.call(bookingDetails, 'zone') &&\n                                    !(bookingDetails.zone.isGated == '1') &&\n                                    validatedDateTime <= 0\n                                    \">\n                                    <p>\n                                        A valid credit card is required to park. Without one, you\n                                        could be subject to a parking violation and issued a\n                                        citation.\n                                    </p>\n                                </v-col>\n                                <v-col cols=\"12\" class=\"mt-4 color-black text-center px-4\" style=\"font-size: 12px\" v-show=\"bookingDetails.hasOwnProperty('booking') &&\n                                    bookingDetails.booking.hasOwnProperty('validated') &&\n                                    bookingDetails.booking.validated == '1' &&\n                                    validatedDateTime > 0\n                                    \">\n                                    <p>\n                                        Exiting after the validated time period will require a valid\n                                        credit card to continue parking. Without one, you could be\n                                        subject to a parking violation and issued a citation.\n                                    </p>\n                                </v-col>\n                                <v-col cols=\"12\" class=\"px-4 mt-2 color-black text-center\" style=\"font-size: 12px\"\n                                    v-show=\"iosDevice\">\n                                    <p>\n                                        You're only authorizing payment now. We'll charge you automatically when you\n                                        checkout based on the\n                                        duration of stay.\n                                    </p>\n                                </v-col>\n                            </v-row>\n\n                        </v-container>\n                    </v-card-actions>\n                    <v-card-actions class=\"justify-center pb-10 px-0\" v-if=\"showPaymentCardAdded\">\n                        <v-container class=\"pa-0\" fluid>\n                            <v-row no-gutters class=\"text-center px-10\" v-if=\"bookingDetails.hasOwnProperty('exitOptions') &&\n                                Object.hasOwnProperty.call(bookingDetails, 'zone') &&\n                                !(bookingDetails.zone.isGated == '0') && bookingDetails.exitOptions.length > 0\n                                \">\n                                <v-col v-if=\"isCheckoutEnabled(1)\">\n                                    <v-avatar color=\"red\" class=\"pa-6\" @click=\"openSMSDialog()\">\n                                        <v-icon medium color=\"white accent-2\" class=\"px-4\" dark>\n                                            {{\n                                                getExitIcon(1)\n                                            }}\n                                        </v-icon>\n                                    </v-avatar>\n                                    <p class=\"grey--text text--darken-1 exit-option-text\">\n                                        {{ getExitText(1) }}\n                                    </p>\n                                </v-col>\n                                <v-col v-if=\"isCheckoutEnabled(2)\">\n                                    <v-avatar color=\"red\" class=\"pa-6\" @click.stop=\"openSmsQrScanner()\">\n                                        <v-icon medium color=\"white accent-2\" class=\"px-4\" dark>\n                                            {{\n                                                getExitIcon(2)\n                                            }}\n                                        </v-icon>\n                                    </v-avatar>\n                                    <p class=\"grey--text text--darken-1 exit-option-text\">\n                                        {{ getExitText(2) }}\n                                    </p>\n                                </v-col>\n                                <v-col v-if=\"isCheckoutEnabled(3)\">\n                                    <v-avatar color=\"red\" class=\"pa-6\" @click=\"dialerDialog = true\">\n                                        <v-icon medium color=\"white accent-2\" class=\"px-4\" dark>\n                                            {{\n                                                getExitIcon(3)\n                                            }}\n                                        </v-icon>\n                                    </v-avatar>\n                                    <p class=\"grey--text text--darken-1 exit-option-text\">{{ getExitText(3) }}</p>\n                                </v-col>\n                            </v-row>\n                            <v-row no-gutters\n                                v-if=\"bookingDetails.zone.isPQREndReservation == 1 && bookingDetails.booking.TypeOfBooking == 'Self reservation'\">\n                                <v-col cols=\"12\" class=\"px-2 mt-4\">\n                                    <v-btn rounded elevation=\"20\" class=\"add_licence_plate_btn white--text\"\n                                        @click=\"openExtDialog()\">Extend\n                                        Parking</v-btn>\n                                </v-col>\n                            </v-row>\n                            <v-row no-gutters v-show=\"Object.hasOwnProperty.call(bookingDetails, 'zone') &&\n                                !(bookingDetails.zone.isGated == '0') && (isCheckoutEnabled(1) || isCheckoutEnabled(2) || isCheckoutEnabled(3))\n                                \">\n                                <v-col cols=\"12\" class=\"mt-2 text-center color-black\" style=\"font-size: 12px\">\n                                    <p class=\"mb-0\">\n                                        When you're ready to leave, please look for the\n                                        <strong>3 digit</strong> gate code on the sign in the exit\n                                        lane. Type that code when prompted. Have a good day!\n                                    </p>\n                                </v-col>\n                            </v-row>\n                            <v-row no-gutters class=\"mt-4\"\n                                v-if=\"Object.hasOwnProperty.call(bookingDetails, 'booking') && Object.hasOwnProperty.call(bookingDetails.booking, 'paymentType') && bookingDetails.booking.paymentType != '' && (bookingDetails.booking.paymentType == 'APPLE_PAY' || bookingDetails.booking.paymentType == 'GOOGLE_PAY')\">\n                                <v-col cols=\"12\" class=\"text-center font-weight-bold\">\n                                    <span style=\"font-size: 13px;\">Authorized with {{\n                                        getPaymentType(bookingDetails.booking.paymentType) }}</span>\n                                </v-col>\n                            </v-row>\n                            <v-row no-gutters>\n                                <v-col cols=\"12\" class=\"px-4 mt-4 text-center color-black font-weight-bold\"\n                                    style=\"font-size: 13px\" v-show=\"(bookingDetails.hasOwnProperty('booking') &&\n                                        bookingDetails.booking.hasOwnProperty('cardNo') &&\n                                        bookingDetails.booking.hasOwnProperty('accountType') &&\n                                        bookingDetails.booking.accountType == '2') ||\n                                        (bookingDetails.booking.cardOnfile == '1' &&\n                                            (bookingDetails.booking.accountType == '0' ||\n                                                bookingDetails.booking.accountType == '1') &&\n                                            !(\n                                                bookingDetails.booking.cardNo == '0' ||\n                                                bookingDetails.booking.cardNo == '' ||\n                                                bookingDetails.booking.cardNo == null\n                                            ))\n                                        \">\n                                    <p class=\"mb-0\">\n                                        Card ending with *{{\n                                            bookingDetails.hasOwnProperty(\"booking\") &&\n                                            bookingDetails.booking.hasOwnProperty(\"cardNo\")\n                                            ? bookingDetails.booking.cardNo\n                                            : \"\"\n                                        }}\n                                        on file\n                                    </p>\n                                </v-col>\n                            </v-row>\n                            <v-row no-gutters\n                                v-if=\"bookingDetails.zone.isPQREndReservation == 1 &&\n                                        (bookingDetails.booking.cardOnfile == '1' || bookingDetails.booking.cardOnfile == '2') && (bookingDetails.booking.TypeOfBooking == 'Guest' || bookingDetails.booking.TypeOfBooking == 'Transient')\">\n                                <v-col cols=\"12\" class=\"mt-4 text-center\">\n                                    <v-btn text color=\"primary\"\n                                        style=\"font-size: 14.5px;font-weight: bolder;text-decoration: underline;\"\n                                        @click=\"hotelGuest\">\n                                        <font-awesome-icon class=\"mr-1\" icon=\"fa-solid fa-hotel\"\n                                            style=\"font-size: 1.5rem;color: black;\" /> I am an\n                                        overnight\n                                        hotel guest</v-btn>\n                                </v-col>\n                            </v-row>\n                            <v-col cols=\"12\" class=\"mt-10 pa-0\">\n                                <v-card flat color=\"#ececec\" class=\"ma-0\" tile max-width=\"100%\">\n                                    <v-card-text>\n                                        <v-row class=\"text-center pt-0\" no-gutters>\n                                            <v-col cols=\"12\" class=\"pa-0\">\n                                                <p style=\"font-size: 15px;color: #F2555C;font-weight: bolder;\">CLAIM\n                                                    YOUR PARKING DISCOUNT</p>\n                                            </v-col>\n                                            <v-col cols=\"12\"\n                                                v-if=\"Object.hasOwnProperty.call(bookingDetails, 'zone') && Object.hasOwnProperty.call(bookingDetails.zone, 'isLoyaltySupported') && bookingDetails.zone.isLoyaltySupported == '1' && bookingDetails.booking.validated != '1' && (bookingDetails.booking.TypeOfBooking == 'Guest' || bookingDetails.booking.TypeOfBooking == 'Transient')\">\n                                                <v-btn color=\"black\" class=\"pa-0 ma-0\" rounded width=\"270\" height=\"70\"\n                                                    elevation=\"20\" @click=\"loyalty = true\">\n                                                    <v-avatar tile width=\"200\" height=\"100\">\n                                                        <v-img src=\"../assets/GNLoyalty.png\" height=\"60px\"\n                                                            width=\"400px\"></v-img>\n                                                    </v-avatar>\n                                                </v-btn>\n                                            </v-col>\n                                        </v-row>\n                                        <v-col cols=\"12\" class=\"mt-4 px-4 text-center\" v-show=\"bookingDetails.hasOwnProperty('booking') &&\n                                            bookingDetails.booking.hasOwnProperty('validated') &&\n                                            bookingDetails.booking.validated != '1' &&\n                                            bookingDetails.booking.isValidationEnabled == '1'\n                                            \">\n                                            <v-btn rounded elevation=\"20\" dense width=\"90%\" height=\"40px\"\n                                                style=\"font-size:18px\"\n                                                class=\"validate_btn white--text blue darken-2 no-upper-case px-4\"\n                                                @click=\"openValidationDialog()\">Apply\n                                                Your Validation</v-btn>\n                                        </v-col>\n                                    </v-card-text>\n                                </v-card>\n                            </v-col>\n                            <v-row no-gutters class=\"text-center mt-1\" v-show=\"Object.hasOwnProperty.call(bookingDetails, 'zone') &&\n                                bookingDetails.zone.isGated == '0' &&\n                                bookingDetails.booking.cardOnfile == '1' &&\n                                validatedDateTime <= 0\n                                \">\n                                <v-col cols=\"12\" class=\"mt-2 color-black\" style=\"font-size: 12px\">\n                                    <p class=\"mb-0\">\n                                        The card on file will be automatically charged for the time\n                                        parked when you exit the garage.\n                                    </p>\n                                </v-col>\n                            </v-row>\n\n                            <v-row no-gutters>\n                                <v-col cols=\"12\" class=\"mt-1 text-center\" v-show=\"bookingDetails.hasOwnProperty('booking') &&\n                                    bookingDetails.booking.hasOwnProperty('cardNo') &&\n                                    bookingDetails.booking.hasOwnProperty('accountType') &&\n                                    bookingDetails.booking.hasOwnProperty('cardUpdated') &&\n                                    !(bookingDetails.booking.cardUpdated == '1') &&\n                                    (bookingDetails.booking.accountType == '2' ||\n                                        (bookingDetails.booking.cardOnfile == '1' &&\n                                            bookingDetails.booking.accountType == '0')) &&\n                                    !(bookingDetails.booking.tapToChangeCard == '0') && !(bookingDetails.booking.paymentType == 'APPLE_PAY' || bookingDetails.booking.paymentType == 'GOOGLE_PAY')\n                                    \">\n                                    <a class=\"text-caption\" @click=\"navigateToAddPayment()\">Tap to change card</a>\n                                </v-col>\n                            </v-row>\n                            <v-row no-gutters>\n                                <v-col cols=\"12\" class=\"mt-4 text-center color-black\" style=\"font-size: 12px\" v-show=\"Object.hasOwnProperty.call(bookingDetails, 'zone') &&\n                                    !(bookingDetails.zone.isGated == '1') &&\n                                    validatedDateTime <= 0 &&\n                                    bookingDetails.booking.cardOnfile != '1'\n                                    \">\n                                    <p>\n                                        A valid credit card is required to park. Without one, you\n                                        could be subject to a parking violation and issued a\n                                        citation.\n                                    </p>\n                                </v-col>\n                            </v-row>\n                            <v-row no-gutters>\n                                <v-col cols=\"12\" class=\"mt-4 text-center color-black\" style=\"font-size: 12px\" v-show=\"bookingDetails.hasOwnProperty('booking') &&\n                                    bookingDetails.booking.hasOwnProperty('validated') &&\n                                    bookingDetails.booking.validated == '1' &&\n                                    validatedDateTime > 0\n                                    \">\n                                    <p>\n                                        Exiting after the validated time period will require a valid\n                                        credit card to continue parking. Without one, you could be\n                                        subject to a parking violation and issued a citation.\n                                    </p>\n                                </v-col>\n                            </v-row>\n                        </v-container>\n                    </v-card-actions>\n                    <!-- <v-row v-if=\"showPaymentCardAdded\">\n                <v-col>\n                  <v-icon\n                    x-small\n                    color=\"green\"\n                    class=\"px-4\"\n                    dark\n                    @click=\"navigateToCheckOut\"\n                  >mdi-exit-to-app</v-icon>\n                </v-col>\n              </v-row>-->\n                    <!-- </v-responsive> -->\n                </v-card>\n            </v-col>\n        </v-row>\n        <v-dialog v-model=\"alertDialog\" persistent max-width=\"290\">\n            <v-card class=\"pa-0\">\n                <v-card-title class=\"justify-center\" style=\"position: relative\">\n                    <v-icon x-large color=\"green accent-2\">{{ alertIcon }}</v-icon>\n                </v-card-title>\n                <v-card-text class=\"text-center mt-5\">\n                    <span style=\"font-size: 20px\">{{ alertMsg }}</span>\n                </v-card-text>\n                <v-card-actions class=\"text-center pb-6\">\n                    <v-container pa-0 fluid>\n                        <v-row no-gutters>\n                            <v-col cols=\"12\">\n                                <v-btn rounded block elevation=\"0\" class=\"white--text exit_dialog_btn\"\n                                    @click=\"closeAlertDialog()\">Close</v-btn>\n                            </v-col>\n                        </v-row>\n                    </v-container>\n                </v-card-actions>\n            </v-card>\n        </v-dialog> <v-dialog v-model=\"loyalty\" width=\"750px\">\n            <v-card>\n                <v-row no-gutters style=\"background-color: black;\" class=\"text-center\">\n                    <v-col class=\"text-center pt-1 \">\n                        <img src=\"../assets/GNLoyalty.png\" width=\"200px\" height=\"65px\">\n                    </v-col>\n                </v-row>\n                <v-card-text>\n                    <v-row no-gutters class=\"mt-4\">\n                        <v-col>\n                            <p style=\"font-size:large;color: black;\">Enter the 24K Select number found on your Loyalty Card\n                            </p>\n                        </v-col>\n                    </v-row>\n                    <v-row no-gutters class=\"mt-2\">\n                        <v-col>\n                            <v-text-field label=\"24K Select Number\" outlined v-model=\"loyalty24knum\"\n                                @keyup=\"loyaltyValid\"></v-text-field>\n                        </v-col>\n                    </v-row>\n                    <v-row no-gutters class=\"mt-2 text-center\">\n                        <v-col>\n                            <v-btn color=\"#F2555C\" width=\"180\" rounded class=\"white--text\" :disabled=\"disableLoyalty\"\n                                @click=\"submitLoyalty(loyalty24knum)\">Submit</v-btn>\n                        </v-col>\n                    </v-row>\n                </v-card-text>\n            </v-card>\n        </v-dialog>\n        <v-dialog v-model=\"qrCodeDialog\" width=\"fit-content\" persistent>\n            <v-card>\n                <v-card-title>\n                    <v-spacer></v-spacer>\n                    <v-icon @click=\"closeQRCodeDialog()\">mdi-close</v-icon>\n                </v-card-title>\n                <v-card-text class=\"pa-1\">\n                    <qr-code-scanner :scan=\"'sms'\" v-bind:qrbox=\"250\" v-bind:fps=\"30\"\n                        :cameraStatus=\"cameraStatus\"></qr-code-scanner>\n                    <v-progress-circular v-if=\"!cameraStatus\" class=\"validation-pending\" indeterminate\n                        color=\"red\"></v-progress-circular>\n                </v-card-text>\n                <v-card-actions>\n                    <v-container class=\"pa-0\" fluid>\n                        <v-row no-gutters>\n                            <v-col cols=\"7\">\n                                <p class=\"grey--text font-weight-bold qr_text mr-4\">Scan the QR code affixed to exit the\n                                    gate</p>\n                            </v-col>\n                            <v-spacer></v-spacer>\n                            <v-img src=\"../assets/qr-code.png\" style=\"opacity: 0.7\" max-width=\"52\"></v-img>\n                        </v-row>\n                    </v-container>\n                </v-card-actions>\n            </v-card>\n        </v-dialog>\n        <div>\n            <v-dialog v-model=\"smsDialog\" width=\"fit-content\">\n                <v-card class=\"pa-0\" ref=\"smscontainer\">\n                    <v-card-title class=\"justify-center\" style=\"position: relative\">\n                        <v-btn class elevation=\"0\" color=\"white\" dark fab x-large>\n                            <v-icon x-large color=\"red accent-2\">mdi-message-text</v-icon>\n                        </v-btn>\n                    </v-card-title>\n                    <v-card-text class=\"pa-0\">\n                        <v-container class=\"px-4\" fluid>\n                            <v-row no-gutters>\n                                <v-col cols=\"12\" class=\"text-left\">\n                                    <p class=\"color-black\" style=\"font-size: 24px; line-height: 35px\">Enter the gate code\n                                        shown in the\n                                        lane to exit.</p>\n                                    <!-- <p class=\"sms-caption color-black\">\n                        We'll copy the code into a text message for you. You'll need\n                        to tap send on the message to open the gate.\n                      </p>-->\n                                </v-col>\n                                <v-col cols=\"12\" class=\"mt-2\">\n                                    <v-text-field class=\"sms-input\" color=\"red\" v-model=\"smsText\" outlined label=\"Gate code\"\n                                        maxlength=\"6\" type=\"tel\" autofocus v-on:keyup.enter=\"openSMSApp()\"\n                                        @focus=\"scrollToSubmit()\" @mouseup=\"scrollToSubmit()\" @keydown=\"scrollToSubmit()\"\n                                        clearable height=\"80px\"></v-text-field>\n                                </v-col>\n                            </v-row>\n                        </v-container>\n                        <v-progress-circular v-if=\"smsPending\" class=\"validation-pending\" indeterminate\n                            color=\"red\"></v-progress-circular>\n                    </v-card-text>\n                    <v-card-actions class=\"text-center\">\n                        <v-container pa-0 fluid>\n                            <v-row no-gutters>\n                                <v-col cols=\"12\">\n                                    <v-btn id=\"submitsmsbtn\" rounded block elevation=\"20\"\n                                        :disabled=\"smsText == '' || smsPending\" class=\"white--text exit_dialog_btn\"\n                                        @click=\"openSMSApp()\">SUBMIT</v-btn>\n                                </v-col>\n                                <v-col cols=\"12\" class=\"mt-2\">\n                                    <p style=\"cursor: pointer\" @click=\"smsDialog = false\">\n                                        Close\n                                    </p>\n                                </v-col>\n                            </v-row>\n                        </v-container>\n                    </v-card-actions>\n                </v-card>\n            </v-dialog>\n        </div>\n        <div>\n            <v-dialog v-model=\"validateQRCodeDialog\" width=\"fit-content\" persistent>\n                <v-card>\n                    <v-card-title>\n                        <v-spacer></v-spacer>\n                        <v-icon @click=\"closeValidationQRDialog()\">mdi-close</v-icon>\n                    </v-card-title>\n                    <v-card-text class=\"pa-1\">\n                        <validation-qr-code-scanner :scan=\"'validationCode'\" v-bind:qrbox=\"250\" v-bind:fps=\"30\"\n                            :cameraStatus=\"validationCameraStatus\"></validation-qr-code-scanner>\n                        <v-progress-circular v-if=\"!validationCameraStatus\" class=\"validation-pending\" indeterminate\n                            color=\"red\"></v-progress-circular>\n                    </v-card-text>\n                    <v-card-actions>\n                        <v-container class=\"pa-0\" fluid>\n                            <v-row no-gutters>\n                                <v-col cols=\"7\">\n                                    <p class=\"grey--text font-weight-bold qr_text mr-4\">Please scan the validation QR code\n                                    </p>\n                                </v-col>\n                                <v-spacer></v-spacer>\n                                <v-img src=\"../assets/qr-code.png\" style=\"opacity: 0.7\" max-width=\"52\"></v-img>\n                            </v-row>\n                        </v-container>\n                    </v-card-actions>\n                </v-card>\n            </v-dialog>\n        </div>\n        <div>\n            <v-dialog v-model=\"validateBookingDialog\" width=\"fit-content\">\n                <v-card class=\"pa-0\" ref=\"validatecontainer\">\n                    <v-card-title class=\"justify-center\" style=\"position: relative\">\n                        <v-btn class elevation=\"0\" color=\"white\" dark fab large>\n                            <v-icon x-large color=\"red accent-2\">mdi-ticket-percent</v-icon>\n                        </v-btn>\n                    </v-card-title>\n                    <v-card-text class=\"pa-0\">\n                        <v-container class=\"px-4 py-0\" fluid>\n                            <v-row no-gutters>\n                                <v-col cols=\"12\" class=\"text-left\">\n                                    <p class=\"color-black text-center\" style=\"font-size: 24px; line-height: 35px\">\n                                        If the Merchant provided you a validation code, you may scan\n                                        it or enter it here.\n                                    </p>\n                                </v-col>\n                                <v-col cols=\"12\">\n                                    <v-btn rounded block elevation=\"20\" class=\"white--text exit_dialog_btn\"\n                                        @click=\"openScanValidationCode()\">Scan Validation Code</v-btn>\n                                </v-col>\n                                <v-col cols=\"12\" class=\"text-left mt-4\">\n                                    <p class=\"color-black\" style=\"font-size: 24px; line-height: 35px\">or enter it below</p>\n                                </v-col>\n                                <v-col cols=\"12\">\n                                    <v-text-field class=\"sms-input\" color=\"red\" v-model=\"validateBookingTxt\" outlined\n                                        label=\"Validation code\" hide-details=\"auto\" v-on:keyup.enter=\"validateBooking()\"\n                                        @focus=\"scrollToValidateBtn()\" @mouseup=\"scrollToValidateBtn()\"\n                                        @keydown=\"scrollToValidateBtn()\" clearable height=\"80px\"></v-text-field>\n                                </v-col>\n                            </v-row>\n                        </v-container>\n                        <v-progress-circular v-if=\"validateBookingPending\" class=\"validation-pending\" indeterminate\n                            color=\"red\"></v-progress-circular>\n                    </v-card-text>\n                    <v-card-actions class=\"text-center\">\n                        <v-container pa-0 fluid>\n                            <v-row no-gutters>\n                                <v-col cols=\"12\">\n                                    <v-btn id=\"validatebookingbtn\" rounded block elevation=\"20\" :disabled=\"validateBookingTxt == '' ||\n                                        validateBookingTxt == null ||\n                                        validateBookingPending\n                                        \" class=\"white--text exit_dialog_btn\" @click=\"onValidateText()\">SUBMIT</v-btn>\n                                </v-col>\n                                <v-col cols=\"12\" class=\"mt-2\">\n                                    <p style=\"cursor: pointer\" @click=\"validateBookingDialog = false\">\n                                        Close\n                                    </p>\n                                </v-col>\n                            </v-row>\n                        </v-container>\n                    </v-card-actions>\n                </v-card>\n            </v-dialog>\n        </div>\n        <div>\n            <v-dialog v-model=\"dialerDialog\" width=\"fit-content\">\n                <v-card class=\"pa-0\">\n                    <v-card-title class=\"justify-center\" style=\"position: relative\">\n                        <v-btn class elevation=\"0\" color=\"white\" dark fab x-large>\n                            <v-icon x-large color=\"red accent-2\">mdi-phone-in-talk</v-icon>\n                        </v-btn>\n                    </v-card-title>\n                    <v-card-text class=\"pa-0\">\n                        <v-container class=\"px-4\" fluid>\n                            <v-row no-gutters>\n                                <v-col cols=\"12\" class=\"text-left\">\n                                    <p class=\"color-black\" style=\"font-size: 24px; line-height: 35px\">\n                                        Tap to call the gate. When prompted, enter the gate code\n                                        shown in the lane to exit.\n                                    </p>\n                                </v-col>\n                            </v-row>\n                        </v-container>\n                    </v-card-text>\n                    <v-card-actions class=\"text-center\">\n                        <v-container pa-0 fluid>\n                            <v-row no-gutters>\n                                <v-col cols=\"12\">\n                                    <v-btn rounded block elevation=\"20\" class=\"white--text exit_dialog_btn\"\n                                        @click=\"openDialerApp\">CALL\n                                        GATE</v-btn>\n                                </v-col>\n                                <v-col cols=\"12\" class=\"mt-2\">\n                                    <p style=\"cursor: pointer\" @click=\"dialerDialog = false\">\n                                        Close\n                                    </p>\n                                </v-col>\n                            </v-row>\n                        </v-container>\n                    </v-card-actions>\n                </v-card>\n            </v-dialog>\n        </div>\n        <v-dialog v-model=\"extensionDialog\">\n            <v-card class=\"pa-0\">\n                <v-card-title></v-card-title>\n                <v-card-text class=\"pa-0\">\n                    <v-row class=\"text-center mt-3\" no-gutters>\n                        <v-col>\n                            <p class=\"black--text\" style=\"font-weight:bold\">Choose Date <span\n                                    v-if=\"Object.hasOwnProperty.call(bookingDetails, 'zone') && Object.hasOwnProperty.call(bookingDetails.zone, 'timePickerConfiguration') && this.bookingDetails.zone.timePickerConfiguration == '1' && bookingDetails.zone.isPQREndReservation == 1\">and\n                                    Time</span></p>\n                            <p>Expires at {{ countDownExitTime }}</p>\n                        </v-col>\n                    </v-row>\n                    <v-row no-gutters>\n                        <v-col cols=\"1\" class=\"text-right align-self-center py-5\">\n                            <v-icon class=\"material-icons-outlined\">calendar_month</v-icon>\n                        </v-col>\n                        <v-col cols=\"11\" class=\"px-2\">\n                            <v-text-field v-model=\"computedDateFormatted\" @click=\"() => { openDatePicker = true }\"\n                                hide-details=\"auto\" readonly></v-text-field>\n                            <v-dialog v-model=\"openDatePicker\" max-width=\"450px\">\n                                <v-card style=\"background-color: #F2555C;color: white;\"><v-card-title>\n                                        <v-row no-gutters>\n                                            <v-col class=\"text-left\" cols=\"12\">\n                                                <span style=\"font-size:15px;color: #fabbbe;\">{{ time !== null && time !== \"\"\n                                                    ?\n                                                    formattedYear : \"\" }}</span>\n                                            </v-col>\n                                            <v-col>\n                                                <span style=\"font-size:30px\"> {{ time !== null && time !== \"\" ?\n                                                    formattedDateTime :\n                                                    \"\"\n                                                }}</span>\n                                            </v-col>\n                                        </v-row>\n                                    </v-card-title></v-card>\n                                <Calendar inline class=\"text-left\" value :stepMinute=\"15\" hourFormat=\"12\" :minDate=\"minDate\"\n                                    @date-select=\"onTimePickerChange\" :maxDate=\"maxDate\" v-model=\"time\" />\n                            </v-dialog>\n                        </v-col>\n                    </v-row>\n\n                    <v-row no-gutters\n                        v-if=\"Object.hasOwnProperty.call(bookingDetails, 'zone') && Object.hasOwnProperty.call(bookingDetails.zone, 'timePickerConfiguration') && bookingDetails.zone.timePickerConfiguration == '1'\">\n                        <v-col cols=\"1\" class=\"text-right align-self-center\">\n                            <v-icon class=\"material-icons-outlined\">schedule</v-icon>\n                        </v-col>\n                        <v-col cols=\"11\" class=\"px-3\">\n                            <v-row>\n                                <v-col>\n                                    <v-text-field v-model=\"formattedTime\"\n                                        @click=\"() => { openTimePicker = true; round(time) }\" readonly></v-text-field>\n                                    <v-dialog v-model=\"openTimePicker\" max-width=\"320px\" class=\"pa-0\"\n                                        @click:outside=\"() => { setDefaultDate(); onTimePickerChange() }\">\n                                        <v-card><v-card-title style=\"background-color: #F2555C;color: white;\">What time will\n                                                you\n                                                exit?</v-card-title>\n                                            <Calendar inline show-time time-only class=\"text-left \" value :stepMinute=\"15\"\n                                                selection-mode=\"single\" hourFormat=\"12\" :minDate=\"minDate\"\n                                                :maxDate=\"maxDate\" v-model=\"time\" />\n                                        </v-card>\n\n                                    </v-dialog>\n                                </v-col>\n                            </v-row>\n                        </v-col>\n                    </v-row>\n\n                    <v-container fluid pa-0>\n                        <Estimate :singleQuotes=\"singleQuotes\" :doubleQuotes=\"doubleQuotes\" :estimate=\"estimate\"\n                            :formattedEntryDisplayTime=\"formattedEntryDisplayTime\" :beforeEstimate=\"beforeEstimate\"\n                            :state=\"'20px'\">\n                        </Estimate>\n                        <v-row no-gutters class=\"mt-3 pa-4\">\n                            <v-col>\n                                <v-btn rounded elevation=\"20\" :loading=\"extendBtnLoading\"\n                                    class=\"add_licence_plate_btn white--text\" @click=\"extendEDT()\">Extend\n                                    Parking</v-btn>\n                            </v-col>\n                        </v-row>\n                    </v-container>\n                </v-card-text>\n            </v-card>\n        </v-dialog>\n        <v-dialog v-model=\"invalidQRDialog\" persistent max-width=\"290\">\n            <v-card class=\"pa-0\">\n                <v-card-title class=\"justify-center\" style=\"position: relative\">\n                    <v-icon x-large color=\"red accent-2\">mdi-alert-outline</v-icon>\n                </v-card-title>\n                <v-card-text class=\"text-center mt-5\">\n                    <span style=\"font-size: 20px\">{{ invalidQRMsg }}</span>\n                </v-card-text>\n                <v-card-actions class=\"text-center pb-6\">\n                    <v-container pa-0 fluid>\n                        <v-row no-gutters>\n                            <v-col cols=\"12\">\n                                <v-btn rounded block elevation=\"20\" class=\"white--text exit_dialog_btn\"\n                                    @click=\"reScanQR()\">Re-Scan\n                                    Code</v-btn>\n                            </v-col>\n                        </v-row>\n                    </v-container>\n                </v-card-actions>\n            </v-card>\n        </v-dialog>\n        <v-dialog v-model=\"invalidValidationQRDialog\" persistent max-width=\"290\">\n            <v-card class=\"pa-0\">\n                <v-card-title class=\"justify-center\" style=\"position: relative\">\n                    <v-icon x-large color=\"red accent-2\">mdi-alert-outline</v-icon>\n                </v-card-title>\n                <v-card-text class=\"text-center mt-5\">\n                    <span style=\"font-size: 20px\">{{ invalidValidationQRMsg }}</span>\n                </v-card-text>\n                <v-card-actions class=\"text-center pb-6\">\n                    <v-container pa-0 fluid>\n                        <v-row no-gutters>\n                            <v-col cols=\"12\">\n                                <v-btn rounded block elevation=\"20\" class=\"white--text exit_dialog_btn\"\n                                    @click=\"reScanValidationQR()\">Re-Scan Code</v-btn>\n                            </v-col>\n                        </v-row>\n                    </v-container>\n                </v-card-actions>\n            </v-card>\n        </v-dialog>\n        <v-dialog v-model=\"invalidSMSDialog\" persistent max-width=\"290\">\n            <v-card class=\"pa-0\">\n                <v-card-title class=\"justify-center\" style=\"position: relative\">\n                    <v-icon x-large color=\"red accent-2\">mdi-alert-outline</v-icon>\n                </v-card-title>\n                <v-card-text class=\"text-center mt-5\">\n                    <span style=\"font-size: 20px\">{{ invalidSMSMsg }}</span>\n                </v-card-text>\n                <v-card-actions class=\"text-center pb-6\">\n                    <v-container pa-0 fluid>\n                        <v-row no-gutters>\n                            <v-col cols=\"12\">\n                                <v-btn rounded block elevation=\"20\" class=\"white--text exit_dialog_btn\"\n                                    @click=\"invalidSMSDialog = false\">Re-Enter Code</v-btn>\n                            </v-col>\n                        </v-row>\n                    </v-container>\n                </v-card-actions>\n            </v-card>\n        </v-dialog>\n\n        <v-dialog v-model=\"pedestrianAccessDialog\" persistent max-width=\"290\">\n            <v-card class=\"pa-0\">\n                <v-card-title class=\"justify-center\" style=\"position: relative\">\n                    <v-icon x-large color=\"red accent-2\">mdi-alert-outline</v-icon>\n                </v-card-title>\n                <v-card-text class=\"text-center mt-5\">\n                    <span style=\"font-size: 20px\">{{ pedestrianAccessText }}</span>\n                </v-card-text>\n                <v-card-actions class=\"text-center pb-6\">\n                    <v-container pa-0 fluid>\n                        <v-row no-gutters>\n                            <v-col cols=\"12\">\n                                <v-btn rounded block elevation=\"0\" class=\"white--text exit_dialog_btn\"\n                                    @click=\"pedestrianAccessDialog = false\">Close</v-btn>\n                            </v-col>\n                        </v-row>\n                    </v-container>\n                </v-card-actions>\n            </v-card>\n        </v-dialog>\n    </v-container>\n</template>\n\n<script>\nimport Calendar from '../uiComponents/Calendar/Calendar';\nimport Estimate from '../components/Estimate.vue'\nimport APIHelper from \"../apiHelper\";\nimport \"primevue/resources/themes/saga-blue/theme.css\"       //theme\nimport \"primevue/resources/primevue.min.css\"                 //core css\nimport \"primeicons/primeicons.css\"\nimport GooglePay from \"./GooglePay.vue\";\n// import loggerHelper from \"../loggerHelper\";\nimport { mapGetters } from \"vuex\";\n// import { QrcodeStream } from \"vue-qrcode-reader\";\nimport QrCodeScanner from \"@/views/QrCodeScanner.vue\";\nimport ValidationQrCodeScanner from \"@/views/ValidationQrCodeScanner.vue\";\nimport ApplePay from \"@/views/ApplePay.vue\";\nimport { formatDateTime } from \"@/utils/formatDateTime\";\nimport { EventBus } from \"@/lib/EventBus\";\nimport { secondsToHms } from \"@/utils/formatDateTime\";\nimport { addMinutes, addDays, addHours, set } from \"date-fns\";\nimport { format, isValid } from \"date-fns\";\nimport { dateToTimeZoneDate } from \"@/utils/formatDateTime\";\n// import QrScanner from 'qr-scanner';\nexport default {\n    name: \"CheckIn\",\n    components: { QrCodeScanner, ValidationQrCodeScanner, ApplePay, GooglePay, Calendar, Estimate },\n    data: () => ({\n        // rules: {\n        //   counter: value => value.length <= 6 || \"Max 6 characters\"\n        // },\n        time: \"\",\n        openTimePicker: false,\n        openDatePicker: false,\n        minTimeDate: null,\n        maxTimeDate: null,\n        beforeEstimate: null,\n        currentDate: format((new Date()), 'yyyy-MM-dd'),\n        loyalty24knum: \"\",\n        alertIcon: \"mdi-check-circle\",\n        alertDialog: false,\n        alertMsg: \"\",\n        loyalty: false,\n        extDateAndTime: null,\n        extendBtnLoading: false,\n        loading: false,\n        extensionDialog: false,\n        stopTime: \"\",\n        exitTimeSelected: {},\n        timePickerHrRange: null,\n        timeExceeded: false,\n        timePickerMinRange: null,\n        minDate: null,\n        maxDate: null,\n        Timemenu: false,\n        startDate: \"\",\n        maxDateTime: null,\n        estimate: null,\n        Datemenu: false,\n        exitDate: null,\n        dateFormatted: null,\n        exitDateTime: 0,\n        exitTimeInterval: null,\n        iosDevice: false,\n        invalidValidationQRDialog: false,\n        cameraStatus: false,\n        validationCameraStatus: false,\n        validatedDateTime: 0,\n        gracePeriodTime: 0,\n        validatedInterval: \"\",\n        duration: 300,\n        offset: 0,\n        pedestrianAccessDialog: false,\n        pedestrianAccessText: \"\",\n        easing: \"easeInOutCubic\",\n        pageHeight: window.outerHeight,\n        qrCodeDialog: false,\n        countUpTime: \"\",\n        interval: \"\",\n        isValid: undefined,\n        camera: \"auto\",\n        smsText: \"\",\n        smsDialog: false,\n        dialerDialog: false,\n        invalidQRMsg: \"\",\n        invalidValidationQRMsg: \"\",\n        invalidQRDialog: false,\n        invalidSMSMsg: \"\",\n\n        invalidSMSDialog: false,\n        smsPending: false,\n        validateBookingPending: false,\n        validateBookingDialog: false,\n        validateBookingTxt: \"\",\n        validateQRCodePending: false,\n        validateQRCodeDialog: false,\n    }),\n    computed: {\n        ...mapGetters({\n            bookingId: \"getterBookingId\",\n            bookingDetails: \"getterBookingDetails\",\n            zoneDetails: \"getterZoneDetails\",\n            entryTime: \"getterEntryTime\",\n            exitGateCodes: \"getterExitGateCodes\",\n            isPQREndReservation: \"getterZoneIsPQREndReservation\",\n\n        }),\n        logoHeight() {\n            return Object.hasOwnProperty.call(this.bookingDetails, 'booking') && Object.hasOwnProperty.call(this.bookingDetails.booking, 'TypeOfBooking') && this.bookingDetails.booking.TypeOfBooking == 'Self reservation' ? '100px' : '150px';\n        },\n        computedDateFormatted() {\n            return this.time !== null && this.time !== \"\" && this.time !== undefined ? format(this.time, 'yyyy/MM/dd') : new Date()\n        },\n        formattedTime() {\n            return this.time ? format(this.time, 'hh:mm aa') : \"\"\n        },\n        formattedDateTime() {\n            return this.time !== null && this.time !== \"\" ? format(this.time, 'iii, LLL dd') : \"\"\n        },\n        formattedYear() {\n            return this.time !== null && this.time !== \"\" ? format(this.time, 'yyyy') : \"\"\n        },\n        formattedEntryDisplayTime() {\n            return Object.hasOwnProperty.call(this.bookingDetails, 'booking') && Object.hasOwnProperty.call(this.bookingDetails.booking, 'entrytime') && this.bookingDetails.booking.entrytime !== null && this.bookingDetails.booking.entrytime !== undefined && this.bookingDetails.booking.entrytime !== \"\" ? format(new Date(this.formatExitDateTime(this.bookingDetails?.booking?.entrytime, 'date')), \"hh:mm a\") : format(dateToTimeZoneDate(new Date(), this.bookingDetails?.zone?.timezone), 'hh:mm a');\n        },\n        singleQuotes() {\n\n            return Object.hasOwnProperty.call(this.bookingDetails, 'zone') && Object.hasOwnProperty.call(this.bookingDetails.zone, 'timePickerConfiguration') && this.bookingDetails.zone.timePickerConfiguration == \"0\" ? ((this.time !== null && this.time !== undefined && this.time !== \"\" && this.minDate !== null && this.minDate !== undefined && this.minDate !== \"\" && format(this.time, 'yyyy-MM-dd') == format(this.minDate, 'yyyy-MM-dd')) || (this.beforeEstimate !== null && this.beforeEstimate !== undefined && this.beforeEstimate !== \"\" && this.estimate !== null && this.estimate !== undefined && this.estimate !== \"\" && this.beforeEstimate.grandTotal == this.estimate.grandTotal)) : true\n        },\n        doubleQuotes() {\n            return Object.hasOwnProperty.call(this.bookingDetails, 'zone') && Object.hasOwnProperty.call(this.bookingDetails.zone, 'timePickerConfiguration') && this.bookingDetails.zone.timePickerConfiguration == \"0\" ? ((this.time !== null && this.time !== undefined && this.time !== \"\" && this.minDate !== null && this.minDate !== undefined && this.minDate !== \"\" && format(this.time, 'yyyy-MM-dd') != format(this.minDate, 'yyyy-MM-dd')) && (this.beforeEstimate !== null && this.beforeEstimate !== undefined && this.beforeEstimate !== \"\" && this.estimate !== null && this.estimate !== undefined && this.estimate !== \"\" && this.beforeEstimate.grandTotal != this.estimate.grandTotal)) : false\n        },\n        disableLoyalty() {\n            let disabled = this.loyalty24knum === undefined || this.loyalty24knum === null || this.loyalty24knum == \"\"\n            return disabled\n        },\n        disableExtend() {\n            let disabled = (\n                this.time === null || this.time === \"\" || this.time === undefined || this.estimate === null || this.estimate === undefined || Object.keys(this.estimate).length === 0) || (this.bookingDetails?.zone?.timePickerConfiguration == '0' && (format(this.time, 'yyyy-MM-dd') == format(this.maxDate, 'yyyy-MM-dd')) ? true : false)\n            return disabled;\n        },\n        countDownExitTime() {\n            if (this.exitDateTime < 0) {\n                this.$store.commit(\"SET_VALIDATED_TIME_STATUS\", true);\n                clearInterval(this.exitTimeInterval);\n            }\n            return secondsToHms(this.exitDateTime / 1000 + 59);\n        },\n        countDownEstimateTime() {\n            if (this.exitDateTime < 0) {\n                this.$store.commit(\"SET_VALIDATED_TIME_STATUS\", true);\n                clearInterval(this.exitTimeInterval);\n            }\n            return secondsToHms(this.exitDateTime / 1000 + 59);\n        },\n        isExtra() {\n            return window.location.pathname.includes(\"/gx/\");\n        },\n        options() {\n            return {\n                duration: this.duration,\n                offset: this.offset,\n                easing: this.easing,\n            };\n        },\n        showPaymentCardAdded: function getCardStatus() {\n            var cardOnFile = this.bookingDetails?.booking?.cardOnfile\n                ? this.bookingDetails.booking.cardOnfile\n                : null;\n            var validatedState = this.bookingDetails?.booking?.validated\n                ? this.bookingDetails.booking.validated\n                : null;\n            var state =\n                cardOnFile == \"1\"\n                    ? true\n                    : cardOnFile == \"2\" &&\n                    validatedState == \"1\" &&\n                    this.validatedDateTime > 0;\n            return state;\n        },\n        timeAgo: function getTimeAgo() {\n            return this.countUpTime;\n        },\n        validationPending: function qrValidation() {\n            return this.isValid === undefined && this.camera === \"off\";\n        },\n        booking_content() {\n            let dateTime = formatDateTime(\n                Number(this.bookingDetails.booking.entrytime)\n            );\n            return dateTime[0] + \" on \" + dateTime[1] + \" \" + dateTime[2];\n        },\n        checkin_content() {\n            return this.formatExitDateTime(this.bookingDetails.booking.entrytime, 'checkin');\n        },\n        checkout_content() {\n            return 'Checkout before ' + this.formatExitDateTime(this.bookingDetails.booking.revEnd, 'expire')\n        },\n        validated_content() {\n            if (this.bookingDetails?.zone?.timezoneoffset) {\n                let dateTime = this.bookingDetails.booking.type == \"13\" ? formatDateTime(\n                    Number(this.bookingDetails.booking.revStart) +\n                    Number(this.bookingDetails.booking.couponValidTime)\n                ) : formatDateTime(\n                    Number(this.bookingDetails.booking.entrytime) +\n                    Number(this.bookingDetails.booking.couponValidTime)\n                );\n                return dateTime[0] + \", \" + dateTime[1] + \" \" + dateTime[2];\n            }\n            return \"\";\n        },\n        countDownValidatedTime() {\n            if (this.validatedDateTime < 0) {\n                this.$store.commit(\"SET_VALIDATED_TIME_STATUS\", true);\n                clearInterval(this.validatedInterval);\n            }\n            return this.secondsToHms(this.validatedDateTime / 1000 + 59);\n        },\n        countDownGracePeriodTime() {\n            if (this.gracePeriodTime < 0) {\n                this.$store.commit(\"SET_GRACE_PERIOD_TIME_STATUS\", true);\n                clearInterval(this.gracePeriodInterval);\n            }\n            //add 59 sec to graceperiod time to skip 0 min.\n            return this.secondsToHms(this.gracePeriodTime / 1000 + 59);\n        },\n        // gracePeriodCountDownTime,\n        // countDownValidationtime(){\n        //   return\n        // }\n    },\n    watch: {\n        time(newVal, oldVal) {\n            if (oldVal != null && newVal != null && oldVal != newVal && oldVal != \"\" && newVal != \"\" && (isValid(newVal))) {\n                this.bookingDetails?.zone?.timePickerConfiguration == '1' ? this.round(newVal) : set(newVal, { hour: 23, minutes: 59, seconds: 59 })\n            }\n        },\n    },\n    created() { },\n    mounted: function () {\n        EventBus.$on('SET_TIME', () => {\n            this.onTimePickerChange();\n        })\n        this.exitDateTime = this.calculateExitDateTime();\n        this.exitTimeInterval = setInterval(() => {\n            if (\n                this.bookingDetails?.zone?.timezone\n\n            ) {\n                this.exitDateTime = this.calculateExitDateTime();\n            }\n        }, 1000);\n        if (\n            this.entryTime != null &&\n            !this.bookingDetails?.booking?.exittime &&\n            this.bookingDetails?.zone?.timezone &&\n            this.bookingDetails?.booking?.gracePeriod\n        ) {\n            this.countUpTime = this.calculateParkingTime(\n                this.entryTime,\n                this.bookingDetails.booking.gracePeriod,\n                this.bookingDetails.zone.timezone\n            );\n        }\n        this.interval = setInterval(() => {\n            if (\n                this.entryTime != null &&\n                !this.bookingDetails?.booking?.exittime &&\n                this.bookingDetails?.zone?.timezone &&\n                this.bookingDetails?.booking?.gracePeriod\n            ) {\n                this.countUpTime = this.calculateParkingTime(\n                    this.entryTime,\n                    this.bookingDetails.booking.gracePeriod,\n                    this.bookingDetails.zone.timezone\n                );\n            }\n        }, 1000);\n        if (\n            this.bookingDetails?.booking?.exittime &&\n            this.bookingDetails.booking.exittime != null &&\n            this.bookingDetails.booking.exittime != \"\"\n        ) {\n            clearInterval(this.interval);\n        }\n        if (\n            this.bookingDetails?.booking?.validated &&\n            this.bookingDetails.booking.validated == \"1\" &&\n            this.bookingDetails?.booking?.validationType &&\n            this.bookingDetails.booking.validationType == \"DIVRT\"\n        ) {\n            this.validatedDateTime = this.calculateValidatedTime();\n        }\n\n        this.validatedInterval = setInterval(() => {\n            if (\n                this.bookingDetails?.zone?.timezone &&\n                this.bookingDetails?.booking?.validated &&\n                this.bookingDetails.booking.validated == \"1\" &&\n                this.bookingDetails?.booking?.validationType &&\n                this.bookingDetails.booking.validationType == \"DIVRT\"\n            ) {\n                this.validatedDateTime = this.calculateValidatedTime();\n            }\n        }, 1000);\n        if (\n            this.bookingDetails?.booking?.validated &&\n            this.bookingDetails.booking.validated == \"1\" &&\n            this.bookingDetails?.booking?.validationType &&\n            this.bookingDetails.booking.validationType == \"DIVRT\"\n        ) {\n            if (this.validatedDateTime < 0) {\n                this.$store.commit(\"SET_VALIDATED_TIME_STATUS\", true);\n                clearInterval(this.validatedInterval);\n            }\n        }\n\n        if (this.bookingDetails?.booking?.gracePeriod > 0) {\n            this.gracePeriodTime = this.calculateGracePeriodTime();\n        }\n\n        this.gracePeriodInterval = setInterval(() => {\n            if (this.bookingDetails?.zone?.timezone) {\n                this.gracePeriodTime = this.calculateGracePeriodTime();\n            }\n        }, 1000);\n        if (this.bookingDetails?.booking?.gracePeriod > 0) {\n            if (this.gracePeriodTime < 0) {\n                this.$store.commit(\"SET_GRACE_PERIOD_TIME_STATUS\", true);\n                clearInterval(this.gracePeriodInterval);\n            }\n        }\n        EventBus.$on(\"sms-qr-result\", (result) => {\n            this.onDecode(result);\n        });\n        EventBus.$on(\"validation-qr-result\", (result) => {\n            this.onValidateQRCode(result);\n        });\n\n        // if(this.bookingDetails?.zone?.isPedestrian=='1'){\n        //   this.pedestrianAccess=true\n        // }\n    },\n    destroyed() {\n        clearInterval(this.interval);\n        clearInterval(this.validatedInterval);\n        clearInterval(this.gracePeriodInterval);\n    },\n    beforeRouteEnter(to, from, next) {\n        next(async (vm) => {\n            vm.getMobileOperatingSystem() === 'iOS' ? vm.iosDevice = true : vm.iosDevice = false;\n            if (\n                vm.bookingDetails?.booking?.exittime &&\n                vm.bookingDetails.booking.exittime != null &&\n                vm.bookingDetails.booking.exittime != \"\"\n            ) {\n                clearInterval(vm.interval);\n            }\n            if (vm.bookingDetails?.booking?.validated == \"0\") {\n                if (vm.validatedDateTime < 0) {\n                    vm.$store.commit(\"SET_VALIDATED_TIME_STATUS\", true);\n                    clearInterval(vm.validatedInterval);\n                }\n            }\n        });\n    },\n    methods: {\n        formatExitDateTime(time, val) {\n            if (time !== null && time !== undefined && time != '') {\n                let utcDate = new Date(time * 1000).toUTCString(); //\"Wed, 27 Jan 2021 13:59:04 GMT\"\n                let month = utcDate.split(\",\")[1].split(\" \")[2]; // Jan\n                let date = utcDate.split(\",\")[1].split(\" \")[1]; // 27\n                let year = utcDate.split(\",\")[1].split(\" \")[3];\n                let hr = utcDate.split(\",\")[1].split(\" \")[4].split(\":\")[0]; // 13\n                let min = utcDate.split(\",\")[1].split(\" \")[4].split(\":\")[1]; //59\n                let formatHr = Number(hr) > 12 ? Number(hr) - 12 : Number(hr); // 1\n                formatHr = Number(hr) == 0 ? 12 : formatHr;\n\n                formatHr = Number(formatHr) >= 10 ? Number(formatHr) : '0' + formatHr; //01\n                let amOrpm = Number(hr) >= 12 ? \"p\" : \"a\"; //PM\n                let ampm = Number(hr) >= 12 ? \"PM\" : \"AM\";\n                switch (val) {\n                    case 'hour': {\n                        return formatHr + amOrpm;\n                    }\n                    case 'mins': {\n                        return min\n                    }\n                    case 'date': {\n                        return month + \" \" + date + \", \" + year + \" \" + formatHr + \":\" + min + \" \" + ampm;\n                    }\n                    case 'expire': {\n                        return formatHr + \":\" + min + \" \" + ampm + ' on ' + month + \" \" + date\n                    }\n                    case 'checkin': {\n                        return formatHr + \":\" + min + \" \" + ampm + ' on ' + month + \" \" + date\n                    }\n                }\n            }\n            //Jan 27, 01:59 PM\n        },\n        round(time) {\n            let exitdate = time !== null && time !== '' ? format(time, 'yyyy/MM/dd') : new Date();\n            let selectedMins = time !== null && time !== '' ? format(time, 'mm') : new Date();\n            let selectedHours = time !== null && time !== '' ? format(time, 'hh') : new Date();\n            let selectedAMPM = time !== null && time !== '' ? format(time, 'a') : new Date();\n            if (exitdate != null && selectedMins != '15' && selectedMins != '30' && selectedMins != '45' && selectedMins != '00' && selectedMins != null && selectedMins != \"\" && selectedHours != null && selectedHours != \"\" && selectedAMPM != null && selectedAMPM != \"\") {\n                let intervalMilliseconds = 900000\n                let datetime = new Date(exitdate + \" \" + selectedHours + \":\" + selectedMins + \" \" + selectedAMPM)\n                let interval = datetime.getTime() % intervalMilliseconds;\n                let delta = interval === 0 ? 0 : datetime.getTime() - interval;\n                delta += intervalMilliseconds;\n                // this.exitTimeSelected = Object.assign(this.exitTimeSelected, { hh: format(new Date(delta), 'hh'), mm: format(new Date(delta), 'mm'), a: format(new Date(delta), 'a'), })\n                return new Date(delta)\n            }\n        },\n        loyaltyValid() {\n            if (!(/^[a-z0-9]+$/i).test(this.loyalty24knum)) {\n                this.loyalty24knum = this.loyalty24knum.replace(/[^\\w\\s]/gi, '')\n            }\n        },\n        async submitLoyalty(code) {\n            try {\n                this.validateBookingPending = true;\n                let result = await this.validateBooking(code);\n                if (!result.data.status) {\n                    this.invalidSMSMsg = result?.data?.message\n                        ? result.data.message\n                        : \"Validation not recognized. Please try again\";\n                    this.invalidSMSDialog = true;\n                    this.validateBookingPending = false;\n                    this.postToLoggerAPI({\n                        phone: this.bookingDetails.user.contact,\n                        refId: this.bookingId,\n                        error: this.invalidSMSMsg,\n                        icon: \"redeem\",\n                        statusText:\n                            \"Error in validating the session on entering validation code - \" +\n                            this.validateBookingTxt,\n                    });\n                } else {\n                    this.postToLoggerAPI({\n                        phone: this.bookingDetails.user.contact,\n                        refId: this.bookingId,\n                        icon: \"redeem\",\n                        statusText:\n                            \"Parker validated the session successfully by entering validation code - \" +\n                            this.validateBookingTxt,\n                    });\n                    this.validateBookingPending = false;\n                    this.validateBookingDialog = false;\n                    this.$store.commit(\n                        \"SET_VALIDATED_MERCHANT\",\n                        result?.data?.merchantName\n                    );\n                    this.$router.replace({ path: \"/validatesuccess\" });\n                }\n            } catch (error) {\n                console.log(error);\n                this.validateBookingPending = false;\n            }\n        },\n        closeAlertDialog() {\n            this.alertDialog = false;\n\n        },\n        getPaymentType(type) {\n            switch (type) {\n                case 'APPLE_PAY': {\n                    return 'Apple Pay';\n                }\n                case 'GOOGLE_PAY': {\n                    return 'Google Pay'\n                }\n                case 'Card': {\n                    return 'Card'\n                }\n            }\n        },\n\n        /** @methods to find the the UTC date \n    @params the bookings date value , type 'exit (2023-12-02)' or 'formatdate (12/02/2023)'\n    */\n        formatUTCDefaultDate(defaultDate, type) {\n            let utcDate = new Date(defaultDate * 1000).toUTCString();\n            let month = utcDate.split(\",\")[1].split(\" \")[2]; // Jan\n            let date = utcDate.split(\",\")[1].split(\" \")[1]; // 27\n            let year = utcDate.split(\",\")[1].split(\" \")[3]; //2023\n            let exitformat = format(new Date(month + \" \" + date + \" \" + year), 'yyyy-MM-dd');\n            let dateformat = format(new Date(month + \" \" + date + \" \" + year), \"MM/dd/yyyy\");\n            return type === \"exit\" ? exitformat : dateformat;\n\n        },\n        async extendEDT() {\n            try {\n                //format(new Date(this.checkinDate), \"yyyy-MM-dd'T'HH:mm:ss\");\n                this.extendBtnLoading = true;\n                let timeconfig = format(this.time, 'yyyy/MM/dd') + \" \" + \"11:59 PM\";\n                let time = this.bookingDetails?.zone?.timePickerConfiguration == '0' ? new Date(timeconfig) : this.time\n                let exitDateTime = time != null || time !== undefined || time != \"\" ?\n                    format(time, 'yyyy/MM/dd')\n                    +\n                    \" \" +\n                    format(time, 'hh:mm a') : new Date();\n                let data = {\n                    bid: this.bookingDetails?.booking?.bid,\n                    extendedTime: format(new Date(exitDateTime), \"yyyy-MM-dd HH:mm:ss\")//\"2022-12-29T02:26:00.000\",\n                };\n                var extendSessionRes = await APIHelper(\n                    \"POST\",\n                    \"/api/v1/prepaid/extendReservation\", data\n                );\n                if (extendSessionRes?.data?.message == \"Successfully updated!!\") {\n                    await this.getBookingDetails();\n                    this.extendBtnLoading = false;\n                    this.extensionDialog = false;\n                } else {\n                    this.alertDialog = true;\n                    this.alertMsg = extendSessionRes?.data?.message || \"Error in extending the session\"\n                }\n\n            } catch (error) {\n                this.extendBtnLoading = false;\n                console.log(error);\n            }\n        },\n        formatDate(date) {\n            let stringdate = date.toString();\n            if (!date) return null;\n\n            const [year, month, day] = stringdate.split(\"-\");\n            return `${month}/${day}/${year}`;\n        },\n        parseDate(date) {\n            if (!date) return null;\n\n            const [month, day, year] = date.split(\"/\");\n            return `${year}-${month.padStart(2, \"0\")}-${day.padStart(2, \"0\")}`;\n        },\n        async openExtDialog() {\n\n            // await axios.get(\n            //   process.env.VUE_APP_ON_DEMAND_URL + \"/\" + \"32899\"+ \".json\"\n            // );\n            this.setDefaultDate();\n            this.setDatePicker();\n            // this.setTimePicker();\n            this.extensionDialog = true;\n            this.extendBtnLoading = false;\n        },\n\n        setDefaultDate() {\n            //formatted exit date value to display\n            this.dateFormatted =\n                this.bookingDetails?.booking?.reservationEndDate ? this.formatUTCDefaultDate(this.bookingDetails?.booking?.revEnd\n                    , 'format') : \"\";\n            this.time = new Date(this.formatExitDateTime(this.bookingDetails?.booking?.revEnd, 'date'))\n            this.exitDate = this.time;\n            let fifteenTime = this.time;\n\n            this.time = format(this.time, 'mm') == '15' || format(this.time, 'mm') == '30' || format(this.time, 'mm') == '45' || format(this.time, 'mm') == '00' ? fifteenTime : this.bookingDetails?.zone?.timePickerConfiguration == '1' ? this.round(this.time) : set(this.time, { hour: 23, minutes: 59, seconds: 59 });\n            // this.dateTimeChange()\n            // Object.hasOwnProperty.call(this.bookingDetails.booking, 'isGated') && this.bookingDetails.booking?.isGated == \"1\" && format(this.time, 'yyyy-MM-dd') != format(dateToTimeZoneDate(new Date(), this.bookingDetails?.zone?.timezone), 'yyyy-MM-dd') ? this.beforeDateTimeChange() : \"\";\n\n        },\n        onTimePickerChange() {\n            let exitdate = this.time !== null && this.time !== undefined && this.time !== \"\" ? format(this.time, 'yyyy/MM/dd') : \"\";\n            let selectedMins = this.time !== null && this.time !== undefined && this.time !== \"\" ? format(this.time, 'mm') : \"\";\n            let selectedHours = this.time !== null && this.time !== undefined && this.time !== \"\" ? format(this.time, 'HH') : \"\";\n            let selectedAMPM = this.time !== null && this.time !== undefined && this.time !== \"\" ? format(this.time, 'a') : \"\";\n            this.stopTime = selectedMins != null && selectedMins != \"\" && selectedHours != null && selectedHours != \"\" && selectedAMPM != null && selectedAMPM != \"\" ? selectedHours + \":\" + selectedMins + \":\" + \"00\" : \"\";\n            let currenTime = this.bookingDetails.zone.timezone\n                ? format(\n                    dateToTimeZoneDate(new Date(),\n                        this.bookingDetails.zone.timezone\n                    ),\n                    \"yyyy-MM-dd HH:mm:ss\"\n                )\n                : format(new Date(), \"yyyy-MM-dd  HH:mm:ss\");\n            if (\n                selectedMins != null && selectedMins != \"\" && selectedHours != null && selectedHours != \"\" && selectedAMPM != null && selectedAMPM != \"\" &&\n                new Date(exitdate + \" \" + this.stopTime).getTime() >\n                new Date(currenTime).getTime()\n            ) {\n                format(this.time, 'yyyy-MM-dd') != format(this.minDate, 'yyyy-MM-dd') ? this.beforeDateTimeChange() : \"\";\n                this.dateTimeChange();\n            }\n        },\n        setDatePicker() {\n            //set the minimum date to today date(zone time zone date)\n            this.minDate = this.bookingDetails.zone.timezone\n                ?\n                new Date(this.formatExitDateTime(this.bookingDetails?.booking?.revEnd, 'date'))\n                :\n                dateToTimeZoneDate(\n                    new Date(Number(this.bookingDetails?.booking?.revEnd) * 1000 - Number(this.bookingDetails.zone.timezoneoffset) * 1000)\n                    , this.bookingDetails.zone.timezone\n                );\n            //calculate max parkign time in seconds\n            let maxPark = this.bookingDetails != null ? this.bookingDetails?.zone?.maxParkingTime : null;\n\n            let addeddays = addDays(new Date(), maxPark?.days);\n            let addedhours = addHours(addeddays, maxPark?.hours);\n            let addedmins = addMinutes(addedhours, maxPark?.minutes);\n            //get max date in seconds based on max parking time\n            let maxZoneDate = addedmins;\n            this.maxDate = this.bookingDetails?.zone.timezone\n                ?\n                dateToTimeZoneDate(\n                    maxZoneDate,\n                    this.bookingDetails?.zone?.timezone\n                )\n                : new Date(maxZoneDate);\n            //get max date with time and set it to maxDateTime\n            this.maxDateTime = this.bookingDetails?.zone?.timezone\n                ? format(\n                    dateToTimeZoneDate(\n                        new Date(maxZoneDate),\n                        this.bookingDetails?.zone?.timezone\n                    ),\n                    \"yyyy-MM-dd hh:mm aaaaa\"\n                )\n                : format(new Date(), \"yyyy-MM-dd hh:mm aaaaa\");\n        },\n        // onOpen() {\n        //   this.setTimePicker(this.exitTimeSelected);\n        // },\n        /** @methods to find the estimate rate \n       @params startDate , stopDate,zcode, type , env_overRide\n       */\n        async beforeDateTimeChange() {\n            if (!this.bookingDetails.zone.zcode) {\n                return\n            }\n            try {\n                // format(new Date(this.checkinDate), \"yyyy-MM-dd'T'HH:mm:ss\");\n\n                let edtEntryTime = this.bookingDetails?.booking?.entrytime\n                this.startDate = edtEntryTime !== null && edtEntryTime !== undefined && edtEntryTime !== \"\" ? format(new Date(this.formatExitDateTime(edtEntryTime, 'date')), \"yyyy-MM-dd'T'HH:mm:ss\") : this.bookingDetails.zone.timezone\n                    ? format(\n                        dateToTimeZoneDate(\n                            new Date(),\n                            this.bookingDetails.zone.timezone\n                        ),\n                        \"yyyy-MM-dd'T'HH:mm:ss\"\n                    )\n                    : format(new Date(), \"yyyy-MM-dd'T'HH:mm:ss\");\n                let stopTime = this.stopTime\n                let selectedHours = this.bookingDetails.booking.entrytime != null && this.bookingDetails.booking.entrytime !== undefined && this.bookingDetails.booking.entrytime != \"\" ? format(new Date(this.formatExitDateTime(this.bookingDetails?.booking?.entrytime, 'date')), \"HH\") : format(dateToTimeZoneDate(new Date(), this.bookingDetails.zone.timezone), 'HH');\n                let selectedMins = this.bookingDetails.booking.entrytime != null && this.bookingDetails.booking.entrytime !== undefined && this.bookingDetails.booking.entrytime != \"\" ? format(new Date(this.formatExitDateTime(this.bookingDetails?.booking?.entrytime, 'date')), \"mm\") : format(dateToTimeZoneDate(new Date(), this.bookingDetails.zone.timezone), 'mm');\n                let exittime = Object.hasOwnProperty.call(this.bookingDetails, 'zone') && Object.hasOwnProperty.call(this.bookingDetails.zone, 'timePickerConfiguration') && this.bookingDetails.zone.timePickerConfiguration == '1' ? 'T' + stopTime : 'T' + selectedHours + \":\" + selectedMins + \":00\";\n                let exitdate = format(this.time, 'yyyy-MM-dd');\n                let stopDate = exitdate + exittime;\n                let data = {\n                    startAt: this.startDate,\n                    stopAt: stopDate,\n                    zcode: this.bookingDetails.zone.zcode,\n                };\n                this.addPaymentBtnLoading = true;\n                var getRate = await APIHelper(\"POST\", \"/api/v2/getRate\", data);\n                //condition to check if the date time selected is lesser than current time\n                if (!getRate?.data?.status && !this.getRateCall) {\n                    this.disableAddPaymentBtn = true;\n                    this.alertDialog = true;\n                    this.alertMsg =\n                        getRate?.data?.message || \"Error in getting rate details\";\n                    this.openDatePicker = false;\n                    this.openTimePicker = false;\n                } else {\n                    this.disableAddPaymentBtn = false;\n                    this.openDatePicker = false;\n                    this.openTimePicker = false;\n                }\n                this.beforeEstimate = Object.assign({}, getRate?.data?.data);\n                // estimatedVal != \"\" &&\n                // estimatedVal != null &&\n                // estimatedVal != undefined\n                //   ? Number(estimatedVal).toFixed(2)\n                //   : estimatedVal;\n                this.addPaymentBtnLoading = false;\n            }\n            catch (error) {\n                this.addPaymentBtnLoading = false;\n                console.log(error);\n            }\n        },\n        async dateTimeChange() {\n            if (!this.bookingDetails.zone.zcode) {\n                return\n            }\n            this.extendBtnLoading = true;\n\n            try {\n                // format(new Date(this.checkinDate), \"yyyy-MM-dd'T'HH:mm:ss\");\n                let edtEntryTime = this.bookingDetails?.booking?.entrytime\n                this.startDate = edtEntryTime !== null && edtEntryTime !== undefined && edtEntryTime !== \"\" ? format(new Date(this.formatExitDateTime(edtEntryTime, 'date')), \"yyyy-MM-dd'T'HH:mm:ss\") : this.bookingDetails.zone.timezone\n                    ? format(\n                        dateToTimeZoneDate(\n                            new Date(),\n                            this.bookingDetails.zone.timezone\n                        ),\n                        \"yyyy-MM-dd'T'HH:mm:ss\"\n                    )\n                    : format(dateToTimeZoneDate(new Date(), this.bookingDetails.zone.timezone), \"yyyy-MM-dd'T'HH:mm:ss\");\n                // console.log(this.exitTimeSelected?.hh+\":\"+this.exitTimeSelected.mm+\":00\")\n                // this.exitDate + \"T23:59:00\";\n                let selectedHours = this.time !== null && this.time !== \"\" && this.time !== undefined ? format(this.time, 'HH') : format(dateToTimeZoneDate(new Date(), this.bookingDetails.zone.timezone), 'HH')\n                let selectedMins = this.time !== null && this.time !== \"\" && this.time !== undefined ? format(this.time, 'mm') : format(dateToTimeZoneDate(new Date(), this.bookingDetails.zone.timezone), 'mm')\n                let exitdate = this.time !== null && this.time !== \"\" && this.time !== undefined ? format(this.time, 'yyyy-MM-dd') : \"\";\n                let exittime = Object.hasOwnProperty.call(this.bookingDetails, 'zone') && Object.hasOwnProperty.call(this.bookingDetails.zone, 'timePickerConfiguration') && this.bookingDetails?.zone?.timePickerConfiguration == '1' ? 'T' + selectedHours + \":\" + selectedMins + \":00\" : \"T23:59:00\"\n                let stopDate = exitdate + exittime;\n\n                let data = {\n                    startAt: this.startDate,\n                    stopAt: stopDate,\n                    zcode: this.bookingDetails?.zone?.zcode,\n                };\n                this.addPaymentBtnLoading = true;\n                var getRate = await APIHelper(\"POST\", \"/api/v2/getRate\", data);\n                this.extendBtnLoading = false;\n                this.extDateAndTime = stopDate;\n                //condition to check if the date time selected is lesser than current time\n                if (!getRate?.data?.status && !this.getRateCall) {\n                    this.disableAddPaymentBtn = true;\n                    this.alertDialog = true;\n                    this.alertMsg =\n                        getRate?.data?.message || \"Error in getting rate details\";\n                    this.openDatePicker = false;\n                    this.openTimePicker = false;\n                    EventBus.$emit('datetime-set');\n                } else {\n                    this.disableAddPaymentBtn = false;\n                    this.openDatePicker = false;\n                    this.openTimePicker = false;\n                    EventBus.$emit('datetime-set');\n                }\n                this.estimate = Object.assign({}, getRate?.data?.data);\n                // estimatedVal != \"\" &&\n                // estimatedVal != null &&\n                // estimatedVal != undefined\n                //   ? Number(estimatedVal).toFixed(2)\n                //   : estimatedVal;\n                this.addPaymentBtnLoading = false;\n            }\n            catch (error) {\n                this.addPaymentBtnLoading = false;\n                console.log(error);\n            }\n        },\n        calculateExitDateTime() {\n            if (this.bookingDetails?.zone?.timezone) {\n                //   var currentTime =\n                // new Date().getTime() +\n                // (Number(this.bookingDetails.zone.timezoneoffset) * 1000 +\n                //   Number(this.bookingDetails.zone.timezonedstoffset) * 1000);\n                var currentTime =\n                    new Date().getTime() +\n                    (Number(this.bookingDetails.zone.timezoneoffset) * 1000 +\n                        Number(this.bookingDetails.zone.timezonedstoffset) * 1000);\n                var exitTime =\n                    new Date(this.bookingDetails.booking.reservationEndDate).getTime();\n                this.$store.commit(\"SET_EXIT_TIME_TIME_STATUS\", this.exitDateTime < 0);\n                exitTime - currentTime < 0\n                    ? clearInterval(this.exitInterval)\n                    : \"\";\n                return exitTime - currentTime;\n            }\n            return 0\n\n        },\n        hotelGuest() {\n            let url = window.location.origin + '?zcode=' + this.bookingDetails?.zone?.locationCode + '#/createsession';\n            let plate = this.bookingDetails?.booking?.vehicleNo || \"\";\n            let phone = this.bookingDetails?.user?.contact || \"\";\n            let bid = this.bookingDetails?.booking?.bid || \"\";\n            let checkindate = this.bookingDetails?.booking?.entrytime || \"\";\n            let params = '/?phone=' + phone + '&bid=' + bid + '&plate=' + plate + '&entrytime=' + checkindate;\n            window.location.replace(url + params);\n            // this.$router.replace({path:'/'});\n\n        },\n        closeQRCodeDialog() {\n            this.qrCodeDialog = false;\n            this.cameraStatus = false;\n        },\n        closeValidationQRDialog() {\n            this.validationCameraStatus = false;\n            this.validateBookingDialog = true;\n            this.validateQRCodeDialog = false;\n        },\n        reScanQR() {\n            this.invalidQRDialog = false;\n            this.cameraStatus = true;\n        },\n        reScanValidationQR() {\n            this.invalidValidationQRDialog = false;\n            this.validationCameraStatus = true;\n        },\n        openSmsQrScanner() {\n            this.qrCodeDialog = true;\n            this.cameraStatus = true;\n        },\n        openSMSDialog() {\n            this.smsDialog = true;\n            let exitLanes =\n                this.exitGateCodes.length > 0\n                    ? this.exitGateCodes.filter((a) => a.isPedestrian == \"0\")\n                    : [];\n            if (\n                this.bookingDetails?.booking?.prePopulateGateCodes &&\n                this.bookingDetails.booking.prePopulateGateCodes == \"1\"\n            ) {\n                this.smsText = exitLanes.length == 1 ? exitLanes[0].sms_code : \"\";\n            }\n        },\n        scrollToSubmit() {\n            const el = document.querySelector(\"#submitsmsbtn\");\n            if (el) {\n                el.scrollIntoView(this.options);\n            }\n        },\n        scrollToValidateBtn() {\n            const el = document.querySelector(\"#validatebookingbtn\");\n            if (el) {\n                el.scrollIntoView(this.options);\n            }\n        },\n        calculateGracePeriodTime() {\n            var currentTime =\n                new Date().getTime() +\n                (Number(this.bookingDetails.zone.timezoneoffset) * 1000 +\n                    Number(this.bookingDetails.zone.timezonedstoffset) * 1000);\n            var gracePeriodTime =\n                (Number(this.bookingDetails.booking.entrytime) +\n                    Number(this.bookingDetails.booking.gracePeriod)) *\n                1000; //\n            this.$store.commit(\n                \"SET_GRACE_PERIOD_TIME_STATUS\",\n                this.gracePeriodTime <= 0\n            );\n            return gracePeriodTime - currentTime;\n        },\n        calculateValidatedTime() {\n            var currentTime =\n                new Date().getTime() +\n                (Number(this.bookingDetails.zone.timezoneoffset) * 1000 +\n                    Number(this.bookingDetails.zone.timezonedstoffset) * 1000);\n            var validatedTime = this.bookingDetails.booking.type == \"13\" ?\n                (Number(this.bookingDetails.booking.revStart) +\n                    Number(this.bookingDetails.booking.couponValidTime)) *\n                1000 : (Number(this.bookingDetails.booking.entrytime) +\n                    Number(this.bookingDetails.booking.couponValidTime)) *\n                1000\n            this.$store.commit(\"SET_VALIDATED_TIME_STATUS\", this.validatedTime < 0);\n            validatedTime - currentTime < 0\n                ? clearInterval(this.validatedInterval)\n                : \"\";\n            return validatedTime - currentTime;\n        },\n        calculateParkingTime(parkingStartTime, gracePeriod, zone) {\n            var currentTime = new Date();\n            currentTime.toLocaleString(\"en-US\", { timeZone: zone });\n            var differenceTime =\n                gracePeriod > 0\n                    ? currentTime.getTime() - parkingStartTime * 1000 // - gracePeriod * 1000 to exclude grace period\n                    : currentTime.getTime() - parkingStartTime * 1000;\n            let parkedTime = this.secondsToHms(differenceTime / 1000);\n            return parkedTime;\n        },\n        secondsToHms(timeDifference) {\n            var d = Number(timeDifference);\n            // if (timeDifference >= 86400) {\n            //   var days = Math.floor(d / 86400);\n            //   var hrs = Math.floor((d % 86400) / 3600);\n            //   var dayDisplay =\n            //     days > 0 ? days + (days == 1 ? \" day \" : \" days \") : \"\";\n            //   var hrDisplay = hrs > 0 ? hrs + (hrs == 1 ? \" hr \" : \" hrs \") : \"\";\n            //   return dayDisplay + hrDisplay;\n            // }\n            var h = Math.floor(d / 3600);\n            var m = Math.floor((d % 3600) / 60);\n            // var s = Math.floor(d % 3600 % 60);\n            var hDisplay = h > 0 ? h + \" h \" : \"\";\n            var mDisplay = m > 0 ? m + (m == 1 ? \" min \" : \" min\") : \" 0 min\";\n            // var sDisplay = s > 0 ? s + (s == 1 ? \" second\" : \" seconds\") : \"\";\n            return hDisplay + mDisplay;\n        },\n        isCheckoutEnabled(type) {\n            if (Object.hasOwnProperty.call(this.bookingDetails, 'exitOptions') && this.bookingDetails.exitOptions.length != 0) {\n                let option = this.bookingDetails.exitOptions.some(\n                    (t) => t.techType == type\n                );\n                return option;\n            }\n            return false;\n\n        },\n        async getBookingDetails() {\n            try {\n                let bookingId = window.location.pathname.substring(3);\n                var bookingDetails = await APIHelper(\n                    \"GET\",\n                    \"/api/v1/booking/config/\" + bookingId\n                );\n                this.$store.commit(\n                    \"SET_BOOKING_DETAILS\",\n                    bookingDetails.data?.data ? bookingDetails.data.data : null\n                );\n            } catch (error) {\n                console.log(error);\n            }\n        },\n        async getpedestrianAccess() {\n            try {\n                // let bookingId = window.location.pathname.substring(3);\n                var pedesAccess = await APIHelper(\n                    \"POST\",\n                    \"api/v1/open/\" + this.bookingId,\n                    { source: \"webView\" }\n                );\n                // console.log(pedesAccess)\n                // console.log(pedesAccess?.data?.status)\n                if (pedesAccess?.data?.status) {\n                    this.postToLoggerAPI({\n                        phone: this.bookingDetails.user.contact,\n                        refId: this.bookingId,\n                        image: \"https://sppl-dev.divrt.co/img/pedestrain_door.042f0927.png\",\n                        statusText: \"Parker accessed pedestrian door successfully.\",\n                    });\n                    this.$router.replace({ path: \"/pedestrianaccess\" });\n                } else {\n                    this.pedestrianAccessText = pedesAccess.data.message;\n                    this.postToLoggerAPI({\n                        phone: this.bookingDetails.user.contact,\n                        refId: this.bookingId,\n                        error: this.pedestrianAccessText,\n                        image: \"https://sppl-dev.divrt.co/img/pedestrain_door.042f0927.png\",\n                        statusText: \"Error in opening the pedestrian door.\",\n                    });\n                    this.pedestrianAccessDialog = true;\n                }\n            } catch (error) {\n                console.log(error);\n            }\n            // this.$router.replace({ path: \"/pedestrianaccess/\"+true });\n        },\n        navigateToAddPayment() {\n            this.postToLoggerAPI({\n                phone: this.bookingDetails.user.contact,\n                refId: this.bookingId,\n                statusText: \"Parker clicked on ADD CREDIT CARD btn.\",\n            });\n            this.$router.replace({ path: \"/addpayment\" });\n        },\n        openValidationDialog() {\n            this.validateBookingDialog = true;\n        },\n        async openSMSApp() {\n            this.postToLoggerAPI({\n                phone: this.bookingDetails.user.contact,\n                refId: this.bookingId,\n                statusText: \"Parker clicked on SMS submit btn.\",\n            });\n            if (this.smsText == null || this.smsText == \"\") {\n                this.invalidSMSMsg = \"Gate code cannot be empty\";\n                this.invalidSMSDialog = true;\n            } else {\n                try {\n                    this.smsPending = true;\n                    var preValidateSendSMS = await APIHelper(\"POST\", \"/receive_sms\", {\n                        bid: this.bookingId,\n                        From: this.bookingDetails.user.contact,\n                        Text: this.smsText,\n                        To: this.bookingDetails.zone.ToMobileNo,\n                        Mode: \"SMS\",\n                        webView: \"1\",\n                        preValidate: 1,\n                    });\n                    this.smsPending = false;\n                    if (\n                        preValidateSendSMS?.data?.status &&\n                        preValidateSendSMS.data.status\n                    ) {\n                        this.smsDialog = false;\n                        this.$router.replace({ path: \"/success\" });\n                        try {\n                            var sendSMS = await APIHelper(\"POST\", \"/receive_sms\", {\n                                bid: this.bookingId,\n                                From: this.bookingDetails.user.contact,\n                                Text: this.smsText,\n                                To: this.bookingDetails.zone.ToMobileNo,\n                                Mode: \"SMS\",\n                                webView: \"1\",\n                            });\n                            if (sendSMS?.data?.status && sendSMS.data.status) {\n                                this.smsDialog = false;\n                                this.postToLoggerAPI({\n                                    phone: this.bookingDetails.user.contact,\n                                    refId: this.bookingId,\n                                    icon: \"logout\",\n                                    statusText:\n                                        \"Parker checked out successfully using SMS - \" +\n                                        this.smsText,\n                                });\n                            } else {\n                                this.invalidSMSMsg = sendSMS?.data?.message\n                                    ? sendSMS.data.message\n                                    : \"Please try again\";\n                                this.invalidSMSDialog = true;\n                                this.postToLoggerAPI({\n                                    phone: this.bookingDetails.user.contact,\n                                    refId: this.bookingId,\n                                    error: this.invalidSMSMsg,\n                                    icon: \"logout\",\n                                    statusText:\n                                        \"Error occured while checking out using SMS - \" +\n                                        this.smsText,\n                                });\n                            }\n                        } catch (error) {\n                            console.log(error);\n                        }\n                    } else {\n                        this.invalidSMSMsg = preValidateSendSMS?.data?.message\n                            ? preValidateSendSMS.data.message\n                            : \"Please try again\";\n                        this.invalidSMSDialog = true;\n                        this.postToLoggerAPI({\n                            phone: this.bookingDetails.user.contact,\n                            refId: this.bookingId,\n                            error: this.invalidSMSMsg,\n                            icon: \"logout\",\n                            statusText:\n                                \"Error occured while checking out using SMS - \" + this.smsText,\n                        });\n                    }\n                } catch (error) {\n                    console.log(error);\n                }\n            }\n        },\n        getMobileOperatingSystem() {\n            var userAgent = navigator.userAgent || navigator.vendor || window.opera;\n            // Windows Phone must come first because its UA also contains \"Android\"\n            if (/windows phone/i.test(userAgent)) {\n                return \"Windows Phone\";\n            }\n\n            if (/android/i.test(userAgent)) {\n                return \"Android\";\n            }\n\n            // iOS detection from: http://stackoverflow.com/a/9039885/177710\n            if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {\n                return \"iOS\";\n            }\n            return \"unknown\";\n        },\n        getExitIcon(exitId) {\n            let exitDetails = this.bookingDetails.exitOptions.find(\n                (p) => p.techType == exitId\n            );\n            return exitDetails.icon;\n        },\n        getExitText(exitId) {\n            let exitDetails = this.bookingDetails.exitOptions.find(\n                (p) => p.techType == exitId\n            );\n            return exitDetails.name;\n        },\n        openDialerApp() {\n            this.postToLoggerAPI({\n                phone: this.bookingDetails.user.contact,\n                refId: this.bookingId,\n                statusText: \"Parker clicked on dialer submit btn.\",\n            });\n            this.dialerDialog = false;\n            var url = \"tel:\" + this.bookingDetails.zone.ToMobileNo;\n            window.location.href = url;\n            if (this.getMobileOperatingSystem() == \"Android\") {\n                window.close();\n            }\n        },\n        turnCameraOn() {\n            this.camera = \"auto\";\n        },\n\n        turnCameraOff() {\n            this.camera = \"off\";\n        },\n        validateDecodedString(str) {\n            let validateDivrtStr = str.startsWith(\"divrt://\");\n            let validateMMID = str.split(\"/\")[2] == this.bookingDetails.booking.mmid;\n            let validateMajorId =\n                str.split(\"/\")[3] == this.bookingDetails.booking.majorid;\n            let validateMinorId = this.bookingDetails.booking.minor_ids.includes(\n                str.split(\"/\")[4]\n            );\n            return (\n                validateDivrtStr && validateMMID && validateMajorId && validateMinorId\n            );\n        },\n        async onDecode(decodedString) {\n            var self = this;\n            this.qrCode = decodedString;\n            this.cameraStatus = false;\n            try {\n                var preValidateQrResult = await APIHelper(\n                    \"POST\",\n                    \"/api/v1/checkout/\" + this.bookingId,\n                    {\n                        beaconId: decodedString,\n                        preValidate: 1,\n                        zid: this.bookingDetails.zone.locationCode\n                    }\n                );\n                if (preValidateQrResult.data.status) {\n                    try {\n                        self.$router.replace({ path: \"/success\" });\n                        var qrResult = await APIHelper(\n                            \"POST\",\n                            \"/api/v1/checkout/\" + this.bookingId,\n                            {\n                                beaconId: decodedString,\n                                zid: this.bookingDetails.zone.locationCode\n                            }\n                        );\n                        if (qrResult.data.status) {\n                            this.postToLoggerAPI({\n                                phone: self.bookingDetails.user.contact,\n                                refId: self.bookingId,\n                                icon: \"logout\",\n                                statusText:\n                                    \"Parker successfully checked out using QR - \" + decodedString,\n                            });\n                            this.$store.commit(\"SET_CHECKOUT\", true);\n                        } else {\n                            this.invalidQRMsg = qrResult?.data?.message\n                                ? qrResult.data.message\n                                : \"Please try again\";\n                            this.invalidQRDialog = true;\n                            this.postToLoggerAPI({\n                                phone: self.bookingDetails.user.contact,\n                                refId: self.bookingId,\n                                error: self.invalidQRMsg,\n                                icon: \"logout\",\n                                statusText:\n                                    \"Error Occured while checking out using QR - \" +\n                                    decodedString,\n                            });\n                        }\n                    } catch (error) {\n                        console.log(error);\n                    }\n                } else {\n                    this.invalidQRMsg = preValidateQrResult?.data?.message\n                        ? preValidateQrResult.data.message\n                        : \"Please try again\";\n                    this.invalidQRDialog = true;\n                    this.postToLoggerAPI({\n                        phone: self.bookingDetails.user.contact,\n                        refId: self.bookingId,\n                        icon: \"logout\",\n                        error: self.invalidQRMsg,\n                        statusText:\n                            \"Error Occured while checking out using QR - \" + decodedString,\n                    });\n                }\n            } catch (error) {\n                console.log(error);\n            }\n        },\n        async onInit(promise) {\n            try {\n                await promise;\n            } catch (error) {\n                if (error.name === \"NotAllowedError\") {\n                    this.invalidQRMsg = \"Please grant camera access permisson\";\n                } else if (error.name === \"NotFoundError\") {\n                    this.invalidQRMsg = \"No camera found on this device\";\n                } else if (error.name === \"NotSupportedError\") {\n                    this.invalidQRMsg = \"Secure context required (HTTPS, localhost)\";\n                } else if (error.name === \"NotReadableError\") {\n                    this.invalidQRMsg = \"Is the camera already in use? Please check.\";\n                } else if (error.name === \"OverconstrainedError\") {\n                    this.invalidQRMsg = \"Installed camera is not suitable\";\n                } else if (error.name === \"StreamApiNotSupportedError\") {\n                    this.invalidQRMsg = \"Stream API is not supported in this browser\";\n                }\n                this.invalidQRDialog = true;\n            }\n        },\n        async onValidateText() {\n            this.validateBookingPending = true;\n            let result = await this.validateBooking(this.validateBookingTxt);\n            if (!result.data.status) {\n                this.invalidSMSMsg = result?.data?.message\n                    ? result.data.message\n                    : \"Validation not recognized. Please try again\";\n                this.invalidSMSDialog = true;\n                this.validateBookingPending = false;\n                this.postToLoggerAPI({\n                    phone: this.bookingDetails.user.contact,\n                    refId: this.bookingId,\n                    error: this.invalidSMSMsg,\n                    icon: \"redeem\",\n                    statusText:\n                        \"Error in validating the session on entering validation code - \" +\n                        this.validateBookingTxt,\n                });\n            } else {\n                this.postToLoggerAPI({\n                    phone: this.bookingDetails.user.contact,\n                    refId: this.bookingId,\n                    icon: \"redeem\",\n                    statusText:\n                        \"Parker validated the session successfully by entering validation code - \" +\n                        this.validateBookingTxt,\n                });\n                this.goldenNugget = false;\n                this.validateBookingPending = false;\n                this.validateBookingDialog = false;\n                this.$store.commit(\n                    \"SET_VALIDATED_MERCHANT\",\n                    result?.data?.merchantName\n                );\n                this.$router.replace({ path: \"/validatesuccess\" });\n            }\n        },\n        async validateBooking(code) {\n            try {\n                let validateResult = await APIHelper(\n                    \"POST\",\n                    \"/api/v1/validate/\" + this.bookingId,\n                    {\n                        coupon: code,\n                        zid: this.bookingDetails.zone.locationCode\n                    }\n                );\n                return validateResult;\n            } catch (error) {\n                console.log(error);\n                return error;\n            }\n        },\n        async openScanValidationCode() {\n            this.validateBookingDialog = false;\n            this.validateBookingTxt = \"\";\n            this.validateQRCodeDialog = true;\n            this.validationCameraStatus = true;\n        },\n        async onValidateQRCode(decodedString) {\n            this.validationCameraStatus = false;\n            this.validateQRCodePending = true;\n            try {\n                let result = await this.validateBooking(decodedString);\n                if (!result.data.status) {\n                    this.invalidValidationQRMsg = result?.data?.message\n                        ? result.data.message\n                        : \"Validation not recognized. Please try again\";\n                    this.invalidValidationQRDialog = true;\n                    this.validateQRCodePending = false;\n                    this.postToLoggerAPI({\n                        phone: this.bookingDetails.user.contact,\n                        refId: this.bookingId,\n                        error: this.invalidQRMsg,\n                        icon: \"redeem\",\n                        statusText:\n                            \"Error in validating the session on scanning validation QR - \" +\n                            decodedString,\n                    });\n                } else {\n                    this.postToLoggerAPI({\n                        phone: this.bookingDetails.user.contact,\n                        refId: this.bookingId,\n                        icon: \"redeem\",\n                        statusText:\n                            \"Parker validated the session successfully by scanning validation QR - \" +\n                            decodedString,\n                    });\n                    this.validateQRCodePending = false;\n                    this.validateQRCodeDialog = false;\n                    this.$store.commit(\n                        \"SET_VALIDATED_MERCHANT\",\n                        result?.data?.merchantName\n                    );\n                    this.$router.replace({ path: \"/validatesuccess\" });\n                }\n            } catch (error) {\n                console.log(error);\n            }\n        },\n    },\n}\n</script>\n<style lang=\"less\">\n.add_licence_plate_btn {\n    width: 100%;\n    background-color: #f2555c !important;\n    font-size: 18px !important;\n    font-weight: 700 !important;\n    letter-spacing: normal !important;\n    height: 50px !important;\n}\n\n.booking_header {\n    position: absolute;\n    bottom: 72px;\n    top: 20px;\n    left: 16px;\n    font-size: 18px;\n    font-weight: bolder;\n}\n\n.time_ago {\n    font-size: 22px;\n    font-weight: 600;\n    line-height: 2.5rem;\n    letter-spacing: 0.0073529412em !important;\n}\n\n.time_ago_context {\n    font-size: 16px;\n    font-weight: 500;\n}\n\n.validated_time {\n    font-size: 13px;\n    font-weight: 500;\n}\n\n.booking_divider {\n    border-color: white !important;\n    margin-top: 12px;\n}\n\n.booking_divider_div {\n    position: absolute;\n    bottom: 60px;\n    width: 100%;\n}\n\n.booking_content {\n    position: absolute !important;\n    bottom: 18px !important;\n    left: 16px !important;\n    font-size: 13px !important;\n    font-weight: normal !important;\n}\n\n.add_credit_card_btn {\n    // border-radius: 30px;\n    width: 100%;\n    background-color: #f2555c !important;\n    font-size: 18px !important;\n    letter-spacing: normal !important;\n    height: 37px !important;\n}\n\n.validation-pending {\n    position: absolute !important;\n    left: 50%;\n    top: 50%;\n    -webkit-transform: translateX(-50%);\n    transform: translateX(-50%);\n}\n\n.qr_text {\n    font-size: 13px;\n}\n\n.exit_dialog_btn {\n    width: 100%;\n    background-color: #f2555c !important;\n    font-size: 18px !important;\n    font-weight: 700 !important;\n    letter-spacing: normal !important;\n    height: 50px !important;\n}\n\n.sms-input input {\n    font-size: 36px;\n    font-weight: 500;\n    color: #44515a !important;\n}\n\n.v-text-field--enclosed .v-input__append-inner {\n    margin-top: 26px !important;\n}\n\n.exit-option-text {\n    font-size: 14px;\n}\n\n.sms-caption {\n    font-size: 0.75rem !important;\n    font-weight: 400;\n    line-height: 1.25rem;\n    letter-spacing: 0.0333333333em !important;\n}\n\n.qrcode-stream-wrapper video {\n    max-height: 300px;\n}\n\n.counter-content-position {\n    position: relative;\n}\n\n.grace-period-image {\n    position: absolute !important;\n    right: -51px;\n    bottom: 5px;\n}\n\n.fabIcon {\n    animation: pulse 2s infinite;\n    box-shadow: 0 0 0 0 rgba(0, 0, 0, 1);\n    transform: scale(1);\n\n    @keyframes pulse {\n        0% {\n            transform: scale(0.95);\n            box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.7);\n        }\n\n        70% {\n            transform: scale(1);\n            box-shadow: 0 0 0 10px rgba(0, 0, 0, 0);\n        }\n\n        100% {\n            transform: scale(0.95);\n            box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);\n        }\n    }\n}\n\n#qr-code-full-region__dashboard {\n    display: none;\n}\n\n#qr-code-full-region>video {\n    width: 100% !important;\n}\n\n#validation-qr-code>video {\n    width: 100% !important;\n}\n\n#qr-code-full-region img {\n    display: none;\n}\n\n.no-upper-case {\n    text-transform: unset !important;\n}\n\n.time-picker-input {\n    flex: 1 1 auto;\n    line-height: 20px;\n    padding: 8px 0 8px;\n    max-width: 100%;\n    min-width: 0px;\n    font-size: 16px;\n    font-family: \"Work Sans\";\n}\n\n.time-picker-input :focus-visible {\n    outline-color: #1976d2;\n}\n\n.vue__time-picker input.display-time {\n    padding: 0px !important;\n    border-bottom: 1px solid #767676;\n    border-top: 0px;\n    border-right: 0px;\n    border-left: 0px;\n}\n\n.vue__time-picker-dropdown ul li:not([disabled]).active,\n.vue__time-picker-dropdown ul li:not([disabled]).active:focus,\n.vue__time-picker-dropdown ul li:not([disabled]).active:hover,\n.vue__time-picker .dropdown ul li:not([disabled]).active,\n.vue__time-picker .dropdown ul li:not([disabled]).active:focus,\n.vue__time-picker .dropdown ul li:not([disabled]).active:hover {\n    background: #f2555c !important;\n}\n\n[data-key=\"am\"] {\n    border: 0.2px solid red;\n    border-radius: 2px;\n    margin-left: 2px;\n}\n\n[data-key=\"pm\"] {\n    border: 0.2px solid red;\n    margin-top: 0.5em;\n    margin-left: 2px;\n}\n\n.hours .hint {\n    position: sticky;\n    top: 0;\n    text-align: center;\n    background: #68808c;\n    z-index: 1;\n    -webkit-text-fill-color: white;\n    margin-bottom: 10px;\n}\n\n.apms .hint {\n    position: sticky;\n    top: 0;\n    text-align: center;\n    background: #68808c;\n    z-index: 1;\n    margin-left: 1px;\n    -webkit-text-fill-color: white;\n    margin-bottom: 10px;\n}\n\n.hours::-webkit-scrollbar {\n    display: none;\n}\n\n.minutes::-webkit-scrollbar {\n    display: none;\n}\n\n.minutes .hint {\n    position: sticky;\n    top: 0;\n    text-align: center;\n    background: #68808c;\n    z-index: 1;\n    -webkit-text-fill-color: white;\n    margin-bottom: 10px;\n}\n\nhr {\n    border: 1px solid #ffbc1f;\n}\n\n#apple-pay-button {\n    height: 48px;\n    width: 100%;\n    display: inline-block;\n    -webkit-appearance: -apple-pay-button;\n    -apple-pay-button-type: plain;\n    -apple-pay-button-style: black;\n}\n\n[data-key='am'] {\n    border: 0.2px solid red;\n    border-radius: 2px;\n    margin-left: 2px;\n}\n\n[data-key='pm'] {\n    border: 0.2px solid red;\n    margin-top: 0.5em;\n    margin-left: 2px;\n}\n\n.hours .hint {\n    position: sticky;\n    top: 0;\n    text-align: center;\n    background: #68808c;\n    z-index: 1;\n    -webkit-text-fill-color: white;\n    margin-bottom: 10px\n}\n\n.apms .hint {\n    position: sticky;\n    top: 0;\n    text-align: center;\n    background: #68808c;\n    z-index: 1;\n    margin-left: 1px;\n    -webkit-text-fill-color: white;\n    margin-bottom: 10px\n}\n\n.hours::-webkit-scrollbar {\n    display: none;\n}\n\n.minutes::-webkit-scrollbar {\n    display: none;\n}\n\n.minutes .hint {\n    position: sticky;\n    top: 0;\n    text-align: center;\n    background: #68808c;\n    z-index: 1;\n    -webkit-text-fill-color: white;\n    margin-bottom: 10px\n}\n\n.booking_date {\n    font-weight: normal;\n    font-size: 13px;\n    color: #3d3f3c !important;\n}\n\n.booking_date_header {\n    color: #3d3f3c !important;\n    font-weight: bold;\n    font-size: 14px;\n}\n\n.total-parking {\n    color: #3d3f3c;\n    font-size: 0.875rem !important;\n    font-weight: 500;\n    line-height: 2.25rem;\n    letter-spacing: 0.0892857143em !important;\n    text-transform: uppercase !important;\n}\n\n.amount-text {\n    color: #3d3f3c;\n    font-size: 34px;\n}\n\n.amount-content-position {\n    position: relative;\n}\n\n.p-calendar {\n    width: 100%;\n}\n</style>"]}]}