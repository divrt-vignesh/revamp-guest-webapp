{"remainingRequest":"/home/vignesh/DIVRT/guest-webapp/node_modules/babel-loader/lib/index.js!/home/vignesh/DIVRT/guest-webapp/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vignesh/DIVRT/guest-webapp/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vignesh/DIVRT/guest-webapp/src/views/Create.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vignesh/DIVRT/guest-webapp/src/views/Create.vue","mtime":1687345808892},{"path":"/home/vignesh/DIVRT/guest-webapp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vignesh/DIVRT/guest-webapp/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/vignesh/DIVRT/guest-webapp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vignesh/DIVRT/guest-webapp/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIi9ob21lL3ZpZ25lc2gvRElWUlQvZ3Vlc3Qtd2ViYXBwL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5IjsKaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL2hvbWUvdmlnbmVzaC9ESVZSVC9ndWVzdC13ZWJhcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL2hvbWUvdmlnbmVzaC9ESVZSVC9ndWVzdC13ZWJhcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNlYXJjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnBhZC1zdGFydC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8gaW1wb3J0IFZ1ZSBmcm9tICJ2dWUiOwppbXBvcnQgRXN0aW1hdGUgZnJvbSAnLi4vY29tcG9uZW50cy9Fc3RpbWF0ZS52dWUnOwppbXBvcnQgeyBFdmVudEJ1cyB9IGZyb20gIkAvbGliL0V2ZW50QnVzIjsKaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gInZ1ZXgiOwppbXBvcnQgeyBhZGRNaW51dGVzLCBhZGREYXlzLCBhZGRIb3VycyB9IGZyb20gImRhdGUtZm5zIjsKaW1wb3J0IHsgZm9ybWF0LCBpc1ZhbGlkIH0gZnJvbSAiZGF0ZS1mbnMiOwppbXBvcnQgInByaW1ldnVlL3Jlc291cmNlcy90aGVtZXMvc2FnYS1ibHVlL3RoZW1lLmNzcyI7IC8vdGhlbWUKCmltcG9ydCAicHJpbWV2dWUvcmVzb3VyY2VzL3ByaW1ldnVlLm1pbi5jc3MiOyAvL2NvcmUgY3NzCgppbXBvcnQgInByaW1laWNvbnMvcHJpbWVpY29ucy5jc3MiOyAvL2ljb25zCgppbXBvcnQgeyBkYXRlVG9UaW1lWm9uZURhdGUgfSBmcm9tICJAL3V0aWxzL2Zvcm1hdERhdGVUaW1lIjsgLy8gaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKCmltcG9ydCBDYWxlbmRhciBmcm9tICcuLi91aUNvbXBvbmVudHMvQ2FsZW5kYXIvQ2FsZW5kYXIudnVlJzsKaW1wb3J0IEFQSUhlbHBlciBmcm9tICIuLi9hcGlIZWxwZXIiOwppbXBvcnQgVnVlUGhvbmVOdW1iZXJJbnB1dCBmcm9tICJ2dWUtcGhvbmUtbnVtYmVyLWlucHV0IjsKaW1wb3J0ICJ2dWUtcGhvbmUtbnVtYmVyLWlucHV0L2Rpc3QvdnVlLXBob25lLW51bWJlci1pbnB1dC5jc3MiOyAvLyBpbXBvcnQgbW9tZW50IGZyb20gIm1vbWVudCI7Ci8vIFZ1ZS51c2UobW9tZW50KTsKCmltcG9ydCBydWxlcyBmcm9tICJAL3V0aWxzL3J1bGVzIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkYXRlOiAiIiwKICAgICAgdGltZTogIiIsCiAgICAgIG9wZW5UaW1lUGlja2VyOiBmYWxzZSwKICAgICAgb3BlbkRhdGVQaWNrZXI6IGZhbHNlLAogICAgICBtaW5UaW1lRGF0ZTogbnVsbCwKICAgICAgbWF4VGltZURhdGU6IG51bGwsCiAgICAgIC8vIGlzUFFSRW5kUmVzZXJ2YXRpb246IHRydWUsCiAgICAgIGN1cnJlbnREYXRlOiBmb3JtYXQobmV3IERhdGUoKSwgJ3l5eXktTU0tZGQnKSwKICAgICAgZWR0RW50cnlUaW1lOiBudWxsLAogICAgICBlZHRQaG9uZUlucHV0OiBmYWxzZSwKICAgICAgY29udGFjdERpc2FibGVkOiBmYWxzZSwKICAgICAgc2VsZWN0ZWRQbGF0ZTogIiIsCiAgICAgIHJlRW50ZXJQbGF0ZTogZmFsc2UsCiAgICAgIGVkdEJpZDogbnVsbCwKICAgICAgY29uZmlybUNyZWF0ZVNlc3Npb25EaWFsb2c6IGZhbHNlLAogICAgICBhZGRMaWNlbmNlUGxhdGVCdG5Mb2FkaW5nOiBmYWxzZSwKICAgICAgZXJyRGlhbG9nOiBmYWxzZSwKICAgICAgZXJyTXNnOiAiIiwKICAgICAgYWxlcnREaWFsb2c6IGZhbHNlLAogICAgICBhbGVydE1zZzogIiIsCiAgICAgIHN0b3BUaW1lOiAiIiwKICAgICAgZXhpdFRpbWVTZWxlY3RlZDoge30sCiAgICAgIHRpbWVQaWNrZXJIclJhbmdlOiBudWxsLAogICAgICB0aW1lRXhjZWVkZWQ6IGZhbHNlLAogICAgICB0aW1lUGlja2VyTWluUmFuZ2U6IG51bGwsCiAgICAgIGRpc2FibGVBZGRQYXltZW50QnRuOiBmYWxzZSwKICAgICAgbWF4RGF0ZVRpbWU6IG51bGwsCiAgICAgIGdldFJhdGVDYWxsOiBmYWxzZSwKICAgICAgZ2V0UmF0ZVRleHQ6ICIiLAogICAgICBUaW1lbWVudTogZmFsc2UsCiAgICAgIHN0YXJ0RGF0ZTogIiIsCiAgICAgIGVzdGltYXRlOiBudWxsLAogICAgICBiZWZvcmVFc3RpbWF0ZTogbnVsbCwKICAgICAgRGF0ZW1lbnU6IGZhbHNlLAogICAgICBleGl0RGF0ZTogbnVsbCwKICAgICAgZGF0ZUZvcm1hdHRlZDogbnVsbCwKICAgICAgcnVsZXM6IHJ1bGVzLAogICAgICBpc0NvbnRhY3RWYWxpZDogdHJ1ZSwKICAgICAgbGljZW5jZVBsYXRlOiAiIiwKICAgICAgY29udGFjdE9iajoge30sCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBjb250YWN0T3B0aW9uczogewogICAgICAgIGNvbG9yOiAiIzAyODhEMSIsCiAgICAgICAgdmFsaWRDb2xvcjogIiMwMjg4RDEiLAogICAgICAgIGNvbnRhY3RCb3JkZXJSYWRpdXM6IDAsCiAgICAgICAgZXJyb3JDb2xvcjogIiNGRjUyNTIiLAogICAgICAgIGRlZmF1bHRDb3VudHJ5OiAiVVMiLAogICAgICAgIHRyYW5zbGF0aW9uczogewogICAgICAgICAgcGhvbmVOdW1iZXJMYWJlbDogIkNvbnRhY3QgTm8iCiAgICAgICAgfQogICAgICB9LAogICAgICBhZGRQYXltZW50QnRuTG9hZGluZzogZmFsc2UKICAgIH07CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBWdWVQaG9uZU51bWJlcklucHV0OiBWdWVQaG9uZU51bWJlcklucHV0LAogICAgQ2FsZW5kYXI6IENhbGVuZGFyLAogICAgRXN0aW1hdGU6IEVzdGltYXRlCiAgfSwKICBiZWZvcmVSb3V0ZUVudGVyOiBmdW5jdGlvbiBiZWZvcmVSb3V0ZUVudGVyKHRvLCBmcm9tLCBuZXh0KSB7CiAgICBuZXh0KCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh2bSkgewogICAgICAgIHZhciBzZWFyY2hQYXJhbXMsIHNlYXJjaFBhcmFtS2V5LCBzZWFyY2hQYXJhbVZhbHVlLCBfdm0kY2FzaW5vRGV0YWlscywgX3ZtJGNhc2lub0RldGFpbHMyLCBfdm0kY2FzaW5vRGV0YWlsczIkdXMsIF92bSRjYXNpbm9EZXRhaWxzMywgX3ZtJGNhc2lub0RldGFpbHMzJHVzLCBfdm0kY2FzaW5vRGV0YWlsczQsIF92bSRjYXNpbm9EZXRhaWxzNCR1cywgX3ZtJGNhc2lub0RldGFpbHM1LCBfdm0kY2FzaW5vRGV0YWlsczUkdXMsIF92bSRjYXNpbm9EZXRhaWxzNiwgX3ZtJGNhc2lub0RldGFpbHM2JHVzLCBfdm0kY2FzaW5vRGV0YWlsczcsIF92bSRjYXNpbm9EZXRhaWxzOCwgX3ZtJGNvbnRhY3RPYmosIGhyZWZQYXJhbXMsIHBhcmFtQXJyYXksIHBob25lUGFyYW0sIGJpZFBhcmFtLCBwbGF0ZVBhcmFtLCBlbnRyeXRpbWVwYXJhbSwgZ3Vlc3RDb250YWN0LCBjb21taXREYXRhOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBzZWFyY2hQYXJhbXMgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnNwbGl0KCI9Iik7CiAgICAgICAgICAgICAgICBzZWFyY2hQYXJhbUtleSA9IHNlYXJjaFBhcmFtcy5sZW5ndGggPiAwID8gc2VhcmNoUGFyYW1zWzBdIDogIiI7CiAgICAgICAgICAgICAgICBzZWFyY2hQYXJhbVZhbHVlID0gc2VhcmNoUGFyYW1zLmxlbmd0aCA+IDAgPyBzZWFyY2hQYXJhbXNbMV0gOiAiIjsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gc2VhcmNoUGFyYW1LZXk7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gX2NvbnRleHQudDAgPT09ICI/emNvZGUiID8gNiA6IF9jb250ZXh0LnQwID09PSAiP2dhdGVpZCIgPyAxMyA6IDE0OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuIHZtLmdldFpvbmVEZXRhaWxzKHNlYXJjaFBhcmFtS2V5LCBzZWFyY2hQYXJhbVZhbHVlKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgaWYgKCF2bS5pc1BRUkVuZFJlc2VydmF0aW9uKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIHZtLmdldE9uRGVtYW5kWm9uZURldGFpbHMoc2VhcmNoUGFyYW1WYWx1ZSk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICB2bS5zZXREZWZhdWx0RGF0ZSgpOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgiYnJlYWsiLCAxNCk7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJicmVhayIsIDE0KTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIGlmICh2bS5pc1BRUkVuZFJlc2VydmF0aW9uKSB7CiAgICAgICAgICAgICAgICAgIHZtLmNvbnRhY3RPYmogPSB2bS5jYXNpbm9EZXRhaWxzICE9IG51bGwgJiYgT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodm0uY2FzaW5vRGV0YWlscywgInVzZXJEZXRhaWwiKSAmJiBPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbCgoX3ZtJGNhc2lub0RldGFpbHMgPSB2bS5jYXNpbm9EZXRhaWxzKSA9PT0gbnVsbCB8fCBfdm0kY2FzaW5vRGV0YWlscyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3ZtJGNhc2lub0RldGFpbHMudXNlckRldGFpbCwgImNvbnRhY3QiKSAmJiAoKF92bSRjYXNpbm9EZXRhaWxzMiA9IHZtLmNhc2lub0RldGFpbHMpID09PSBudWxsIHx8IF92bSRjYXNpbm9EZXRhaWxzMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF92bSRjYXNpbm9EZXRhaWxzMiR1cyA9IF92bSRjYXNpbm9EZXRhaWxzMi51c2VyRGV0YWlsKSA9PT0gbnVsbCB8fCBfdm0kY2FzaW5vRGV0YWlsczIkdXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF92bSRjYXNpbm9EZXRhaWxzMiR1cy5jb250YWN0KSAhPSB1bmRlZmluZWQgJiYgKChfdm0kY2FzaW5vRGV0YWlsczMgPSB2bS5jYXNpbm9EZXRhaWxzKSA9PT0gbnVsbCB8fCBfdm0kY2FzaW5vRGV0YWlsczMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfdm0kY2FzaW5vRGV0YWlsczMkdXMgPSBfdm0kY2FzaW5vRGV0YWlsczMudXNlckRldGFpbCkgPT09IG51bGwgfHwgX3ZtJGNhc2lub0RldGFpbHMzJHVzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdm0kY2FzaW5vRGV0YWlsczMkdXMuY29udGFjdCkgIT0gbnVsbCA/IE9iamVjdC5hc3NpZ24odm0uY29udGFjdE9iaiwgewogICAgICAgICAgICAgICAgICAgIGNvdW50cnlDb2RlOiAoKF92bSRjYXNpbm9EZXRhaWxzNCA9IHZtLmNhc2lub0RldGFpbHMpID09PSBudWxsIHx8IF92bSRjYXNpbm9EZXRhaWxzNCA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF92bSRjYXNpbm9EZXRhaWxzNCR1cyA9IF92bSRjYXNpbm9EZXRhaWxzNC51c2VyRGV0YWlsKSA9PT0gbnVsbCB8fCBfdm0kY2FzaW5vRGV0YWlsczQkdXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF92bSRjYXNpbm9EZXRhaWxzNCR1cy5jb250YWN0LnNsaWNlKDAsIC0xMCkpID09ICIrOTEiID8gIklOIiA6ICgoX3ZtJGNhc2lub0RldGFpbHM1ID0gdm0uY2FzaW5vRGV0YWlscykgPT09IG51bGwgfHwgX3ZtJGNhc2lub0RldGFpbHM1ID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3ZtJGNhc2lub0RldGFpbHM1JHVzID0gX3ZtJGNhc2lub0RldGFpbHM1LnVzZXJEZXRhaWwpID09PSBudWxsIHx8IF92bSRjYXNpbm9EZXRhaWxzNSR1cyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3ZtJGNhc2lub0RldGFpbHM1JHVzLmNvbnRhY3Quc2xpY2UoMCwgLTEwKSkgPT0gIisxIiA/ICJVUyIgOiAiIiwKICAgICAgICAgICAgICAgICAgICBwaG9uZU51bWJlcjogKF92bSRjYXNpbm9EZXRhaWxzNiA9IHZtLmNhc2lub0RldGFpbHMpID09PSBudWxsIHx8IF92bSRjYXNpbm9EZXRhaWxzNiA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF92bSRjYXNpbm9EZXRhaWxzNiR1cyA9IF92bSRjYXNpbm9EZXRhaWxzNi51c2VyRGV0YWlsKSA9PT0gbnVsbCB8fCBfdm0kY2FzaW5vRGV0YWlsczYkdXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF92bSRjYXNpbm9EZXRhaWxzNiR1cy5jb250YWN0LAogICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZE51bWJlcjogIisiICsgdm0uY2FzaW5vRGV0YWlscy51c2VyRGV0YWlsLmNvbnRhY3QKICAgICAgICAgICAgICAgICAgfSkgOiB7fTsKICAgICAgICAgICAgICAgICAgdm0ubGljZW5jZVBsYXRlID0gKF92bSRjYXNpbm9EZXRhaWxzNyA9IHZtLmNhc2lub0RldGFpbHMpICE9PSBudWxsICYmIF92bSRjYXNpbm9EZXRhaWxzNyAhPT0gdm9pZCAwICYmIF92bSRjYXNpbm9EZXRhaWxzNy51c2VyRGV0YWlsLnBsYXRlID8gKF92bSRjYXNpbm9EZXRhaWxzOCA9IHZtLmNhc2lub0RldGFpbHMpID09PSBudWxsIHx8IF92bSRjYXNpbm9EZXRhaWxzOCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3ZtJGNhc2lub0RldGFpbHM4LnVzZXJEZXRhaWwucGxhdGUgOiAiIjsKCiAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uaHJlZi5pbmNsdWRlcygnYmlkJykpIHsKICAgICAgICAgICAgICAgICAgICBocmVmUGFyYW1zID0gd2luZG93LmxvY2F0aW9uLmhyZWYuc3BsaXQoJ2NyZWF0ZXNlc3Npb24nKTsKICAgICAgICAgICAgICAgICAgICBwYXJhbUFycmF5ID0gaHJlZlBhcmFtc1sxXS5zcGxpdCgnJicpOwogICAgICAgICAgICAgICAgICAgIHBob25lUGFyYW0gPSBwYXJhbUFycmF5Lmxlbmd0aCA+PSAxID8gcGFyYW1BcnJheVswXS5zcGxpdCgnPScpWzFdIDogIiI7CiAgICAgICAgICAgICAgICAgICAgYmlkUGFyYW0gPSBwYXJhbUFycmF5Lmxlbmd0aCA+PSAyID8gcGFyYW1BcnJheVsxXS5zcGxpdCgnPScpWzFdIDogIiI7CiAgICAgICAgICAgICAgICAgICAgcGxhdGVQYXJhbSA9IHBhcmFtQXJyYXkubGVuZ3RoID49IDMgPyBwYXJhbUFycmF5WzJdLnNwbGl0KCc9JylbMV0gOiAiIjsKICAgICAgICAgICAgICAgICAgICBlbnRyeXRpbWVwYXJhbSA9IHBhcmFtQXJyYXkubGVuZ3RoID49IDQgPyBwYXJhbUFycmF5WzNdLnNwbGl0KCc9JylbMV0gOiAiIjsgLy8gdm0uY29udGFjdE9iai5waG9uZU51bWJlciA9IHBob25lUGFyYW07CgogICAgICAgICAgICAgICAgICAgIHZtLmVkdEVudHJ5VGltZSA9IGVudHJ5dGltZXBhcmFtICE9IG51bGwgJiYgZW50cnl0aW1lcGFyYW0gIT09ICIiICYmIGVudHJ5dGltZXBhcmFtICE9IHVuZGVmaW5lZCA/IGZvcm1hdChuZXcgRGF0ZSh2bS5mb3JtYXRFeGl0RGF0ZVRpbWUoZW50cnl0aW1lcGFyYW0sICdkYXRlJykpLCAieXl5eS1NTS1kZCdUJ0hIOm1tOnNzIikgOiBmb3JtYXQoZGF0ZVRvVGltZVpvbmVEYXRlKG5ldyBEYXRlKCksIHZtLnpvbmVEZXRhaWxzLnRpbWV6b25lKSwgInl5eXktTU0tZGQnVCdISDptbTpzcyIpOwogICAgICAgICAgICAgICAgICAgIHZtLmxpY2VuY2VQbGF0ZSA9IHBsYXRlUGFyYW07CiAgICAgICAgICAgICAgICAgICAgdm0uZWR0QmlkID0gYmlkUGFyYW07CiAgICAgICAgICAgICAgICAgICAgZ3Vlc3RDb250YWN0ID0gcGhvbmVQYXJhbSA/IHsKICAgICAgICAgICAgICAgICAgICAgIGNvdW50cnlDb2RlOiBwaG9uZVBhcmFtLnNsaWNlKDAsIC0xMCkgPT0gIjkxIiA/ICJJTiIgOiBwaG9uZVBhcmFtLnNsaWNlKDAsIC0xMCkgPT0gIjEiID8gIlVTIiA6ICIiLAogICAgICAgICAgICAgICAgICAgICAgcGhvbmVOdW1iZXI6IHBob25lUGFyYW0sCiAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWROdW1iZXI6ICIrIiArIHBob25lUGFyYW0KICAgICAgICAgICAgICAgICAgICB9IDogdm0uY29udGFjdE9iajsKCiAgICAgICAgICAgICAgICAgICAgaWYgKHBob25lUGFyYW0gIT09ICIiICYmIHBob25lUGFyYW0gIT09IG51bGwgJiYgcGhvbmVQYXJhbSAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICAgIHZtLmVkdFBob25lSW5wdXQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgdm0uY29udGFjdE9iaiA9IE9iamVjdC5hc3NpZ24oe30sIGd1ZXN0Q29udGFjdCk7CiAgICAgICAgICAgICAgICAgICAgICB2bS5jb250YWN0RGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgdm0uY29udGFjdE9iai5pc1ZhbGlkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGNvbW1pdERhdGEgPSB7CiAgICAgICAgICAgICAgICAgICAgICBwbGF0ZTogdm0ubGljZW5jZVBsYXRlLAogICAgICAgICAgICAgICAgICAgICAgY29udGFjdDogKF92bSRjb250YWN0T2JqID0gdm0uY29udGFjdE9iaikgPT09IG51bGwgfHwgX3ZtJGNvbnRhY3RPYmogPT09IHZvaWQgMCA/IHZvaWQgMCA6IF92bSRjb250YWN0T2JqLmZvcm1hdHRlZE51bWJlciwKICAgICAgICAgICAgICAgICAgICAgIGJpZDogdm0uZWR0QmlkLAogICAgICAgICAgICAgICAgICAgICAgZW50cnl0aW1lOiB2bS5lZHRFbnRyeVRpbWUsCiAgICAgICAgICAgICAgICAgICAgICBlZHRQYXJhbXM6IGhyZWZQYXJhbXNbMV0KICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHZtLiRzdG9yZS5jb21taXQoIlNFVF9DQVNJTk9fVVNFUkRFVEFJTFMiLCBjb21taXREYXRhKTsKICAgICAgICAgICAgICAgICAgICB2bS4kc3RvcmUuY29tbWl0KCJTRVRfVEVNUExBVEVfRkxBR1MiLCAnYXRsYW50aWMtZmxhZycpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICB2bS5lZHRQaG9uZUlucHV0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9KCkpOwogIH0sCiAgd2F0Y2g6IHsKICAgIHRpbWU6IGZ1bmN0aW9uIHRpbWUobmV3VmFsLCBvbGRWYWwpIHsKICAgICAgaWYgKG9sZFZhbCAhPSBudWxsICYmIG5ld1ZhbCAhPSBudWxsICYmIG9sZFZhbCAhPSBuZXdWYWwgJiYgb2xkVmFsICE9ICIiICYmIG5ld1ZhbCAhPSAiIiAmJiBpc1ZhbGlkKG5ld1ZhbCkpIHsKICAgICAgICB0aGlzLnJvdW5kKG5ld1ZhbCk7CiAgICAgIH0gLy8gdGhpcy5zZXRUaW1lUGlja2VyKG5ld1ZhbCk7CgogICAgfQogIH0sCiAgY29tcHV0ZWQ6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7CiAgICBmb3JtYXR0ZWREYXRlVGltZTogZnVuY3Rpb24gZm9ybWF0dGVkRGF0ZVRpbWUoKSB7CiAgICAgIHJldHVybiB0aGlzLnRpbWUgIT09IG51bGwgJiYgdGhpcy50aW1lICE9PSB1bmRlZmluZWQgJiYgdGhpcy50aW1lICE9PSAiIiA/IGZvcm1hdCh0aGlzLnRpbWUsICdpaWksIExMTCBkZCcpIDogIiI7CiAgICB9LAogICAgZm9ybWF0dGVkWWVhcjogZnVuY3Rpb24gZm9ybWF0dGVkWWVhcigpIHsKICAgICAgcmV0dXJuIHRoaXMudGltZSAhPT0gbnVsbCAmJiB0aGlzLnRpbWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRpbWUgIT09ICIiID8gZm9ybWF0KHRoaXMudGltZSwgJ3l5eXknKSA6ICIiOwogICAgfSwKICAgIGZvcm1hdHRlZFRpbWU6IGZ1bmN0aW9uIGZvcm1hdHRlZFRpbWUoKSB7CiAgICAgIHJldHVybiB0aGlzLnRpbWUgIT09IG51bGwgJiYgdGhpcy50aW1lICE9PSB1bmRlZmluZWQgJiYgdGhpcy50aW1lICE9PSAiIiA/IGZvcm1hdCh0aGlzLnRpbWUsICdoaDptbSBhYScpIDogIiI7CiAgICB9CiAgfSwgbWFwR2V0dGVycyh7CiAgICBjYXNpbm9EZXRhaWxzOiAiZ2V0dGVyQ2FzaW5vRGV0YWlscyIsCiAgICB6b25lRGV0YWlsczogImdldHRlclpvbmVEZXRhaWxzIiwKICAgIG9uRGVtYW5kWm9uZURldGFpbHM6ICJnZXR0ZXJPbkRlbWFuZFpvbmVEZXRhaWxzIiwKICAgIHRlbXBsYXRlRmxhZ3M6ICJnZXR0ZXJUZW1wbGF0ZUZsYWdzIiwKICAgIGlzUFFSRW5kUmVzZXJ2YXRpb246ICJnZXR0ZXJab25lSXNQUVJFbmRSZXNlcnZhdGlvbiIKICB9KSksIHt9LCB7CiAgICBzaW5nbGVRdW90ZXM6IGZ1bmN0aW9uIHNpbmdsZVF1b3RlcygpIHsKICAgICAgcmV0dXJuIE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuem9uZURldGFpbHMsICd0aW1lUGlja2VyQ29uZmlndXJhdGlvbicpICYmIHRoaXMuem9uZURldGFpbHMudGltZVBpY2tlckNvbmZpZ3VyYXRpb24gPT0gIjAiID8gZm9ybWF0KHRoaXMudGltZSwgJ3l5eXktTU0tZGQnKSA9PSB0aGlzLmN1cnJlbnREYXRlIHx8IHRoaXMuYmVmb3JlRXN0aW1hdGUgIT09IG51bGwgJiYgdGhpcy5iZWZvcmVFc3RpbWF0ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuYmVmb3JlRXN0aW1hdGUgIT09ICIiICYmIHRoaXMuZXN0aW1hdGUgIT09IG51bGwgJiYgdGhpcy5lc3RpbWF0ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuZXN0aW1hdGUgIT09ICIiICYmIHRoaXMuYmVmb3JlRXN0aW1hdGUuZ3JhbmRUb3RhbCA9PSB0aGlzLmVzdGltYXRlLmdyYW5kVG90YWwgOiB0cnVlOwogICAgfSwKICAgIGRvdWJsZVF1b3RlczogZnVuY3Rpb24gZG91YmxlUXVvdGVzKCkgewogICAgICByZXR1cm4gT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodGhpcy56b25lRGV0YWlscywgJ3RpbWVQaWNrZXJDb25maWd1cmF0aW9uJykgJiYgdGhpcy56b25lRGV0YWlscy50aW1lUGlja2VyQ29uZmlndXJhdGlvbiA9PSAiMCIgPyBmb3JtYXQodGhpcy50aW1lLCAneXl5eS1NTS1kZCcpICE9IHRoaXMuY3VycmVudERhdGUgJiYgdGhpcy5iZWZvcmVFc3RpbWF0ZSAhPT0gbnVsbCAmJiB0aGlzLmJlZm9yZUVzdGltYXRlICE9PSB1bmRlZmluZWQgJiYgdGhpcy5iZWZvcmVFc3RpbWF0ZSAhPT0gIiIgJiYgdGhpcy5lc3RpbWF0ZSAhPT0gbnVsbCAmJiB0aGlzLmVzdGltYXRlICE9PSB1bmRlZmluZWQgJiYgdGhpcy5lc3RpbWF0ZSAhPT0gIiIgJiYgdGhpcy5iZWZvcmVFc3RpbWF0ZS5ncmFuZFRvdGFsICE9IHRoaXMuZXN0aW1hdGUuZ3JhbmRUb3RhbCA6IGZhbHNlOwogICAgfSwKICAgIGZvcm1hdHRlZEVudHJ5RGlzcGxheVRpbWU6IGZ1bmN0aW9uIGZvcm1hdHRlZEVudHJ5RGlzcGxheVRpbWUoKSB7CiAgICAgIHJldHVybiB0aGlzLmNhc2lub0RldGFpbHMudXNlckRldGFpbC5lbnRyeXRpbWUgIT09IG51bGwgJiYgdGhpcy5jYXNpbm9EZXRhaWxzLnVzZXJEZXRhaWwuZW50cnl0aW1lICE9PSB1bmRlZmluZWQgJiYgdGhpcy5jYXNpbm9EZXRhaWxzLnVzZXJEZXRhaWwuZW50cnl0aW1lICE9PSAiIiA/IGZvcm1hdChuZXcgRGF0ZSh0aGlzLmNhc2lub0RldGFpbHMudXNlckRldGFpbC5lbnRyeXRpbWUpLCAnaGg6bW0gYScpIDogZm9ybWF0KGRhdGVUb1RpbWVab25lRGF0ZShuZXcgRGF0ZSgpLCB0aGlzLnpvbmVEZXRhaWxzLnRpbWV6b25lKSwgJ2hoOm1tIGEnKTsKICAgIH0sCiAgICBpbmZvRmxhZzogZnVuY3Rpb24gaW5mb0ZsYWcoKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnRhY3RPYmogPT0gbnVsbCB8fCAhdGhpcy5jb250YWN0T2JqLmlzVmFsaWQgfHwgdGhpcy5jb250YWN0T2JqLnBob25lTnVtYmVyID09ICIiIHx8IHRoaXMuY29udGFjdE9iai5waG9uZU51bWJlciA9PSBudWxsIHx8IHRoaXMubGljZW5jZVBsYXRlID09PSAiIiB8fCB0aGlzLmxpY2VuY2VQbGF0ZSA9PT0gbnVsbCA/IGZhbHNlIDogdHJ1ZTsKICAgIH0sCiAgICB0aW1lRmxhZzogZnVuY3Rpb24gdGltZUZsYWcoKSB7CiAgICAgIHJldHVybiB0aGlzLnRpbWUgPT0gbnVsbCB8fCB0aGlzLmRpc2FibGVBZGRQYXltZW50QnRuIHx8IHRoaXMuZXN0aW1hdGUgPT09IG51bGwgfHwgdGhpcy5lc3RpbWF0ZSA9PT0gIiIgfHwgT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodGhpcy56b25lRGV0YWlscywgJ3RpbWVQaWNrZXJDb25maWd1cmF0aW9uJykgJiYgdGhpcy56b25lRGV0YWlscy50aW1lUGlja2VyQ29uZmlndXJhdGlvbiA9PSAiMSIgJiYgZm9ybWF0KHRoaXMudGltZSwgJ3l5eXktTU0tZGQnKSAhPSBmb3JtYXQodGhpcy5taW5UaW1lRGF0ZSwgJ3l5eXktTU0tZGQnKSAmJiAodGhpcy5iZWZvcmVFc3RpbWF0ZSA9PT0gbnVsbCB8fCB0aGlzLmJlZm9yZUVzdGltYXRlID09ICIiIHx8IHRoaXMuYmVmb3JlRXN0aW1hdGUgPT0gdW5kZWZpbmVkKSB8fCB0aGlzLnRpbWUgPT09ICIiIHx8IHRoaXMudGltZSA9PSB1bmRlZmluZWQgPyBmYWxzZSA6IHRydWU7CiAgICB9LAogICAgcGF5bWVudEZsYWc6IGZ1bmN0aW9uIHBheW1lbnRGbGFnKCkgewogICAgICB2YXIgX3RoaXMkem9uZURldGFpbHM7CgogICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZSA9PT0gbnVsbCB8fCB0aGlzLmVzdGltYXRlID09PSAiIiB8fCB0aGlzLmVzdGltYXRlLmhhc093blByb3BlcnR5LmNhbGwoImdyYW5kVG90YWwiKSB8fCB0aGlzLmVzdGltYXRlLmhhc093blByb3BlcnR5LmNhbGwoInRvdGFsUHJpY2UiKSB8fCB0aGlzLmVzdGltYXRlLmhhc093blByb3BlcnR5LmNhbGwoInRvdGFsRmVlIikgfHwgdGhpcy5lc3RpbWF0ZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKCJ0b3RhbFRheCIpIHx8ICgoX3RoaXMkem9uZURldGFpbHMgPSB0aGlzLnpvbmVEZXRhaWxzKSA9PT0gbnVsbCB8fCBfdGhpcyR6b25lRGV0YWlscyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkem9uZURldGFpbHMudGltZVBpY2tlckNvbmZpZ3VyYXRpb24pID09ICcxJyAmJiB0aGlzLmJlZm9yZUVzdGltYXRlID09PSBudWxsICYmIHRoaXMuYmVmb3JlRXN0aW1hdGUgPT09ICIiICYmIHRoaXMuYmVmb3JlRXN0aW1hdGUgPT09IG51bGwgJiYgdGhpcy5iZWZvcmVFc3RpbWF0ZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKCJ0b3RhbFByaWNlIikgJiYgdGhpcy5iZWZvcmVFc3RpbWF0ZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKCJ0b3RhbEZlZSIpICYmIHRoaXMuYmVmb3JlRXN0aW1hdGUuaGFzT3duUHJvcGVydHkuY2FsbCgidG90YWxUYXgiKSA/IGZhbHNlIDogdHJ1ZTsKICAgIH0sCiAgICBjb21wdXRlZERhdGVGb3JtYXR0ZWQ6IGZ1bmN0aW9uIGNvbXB1dGVkRGF0ZUZvcm1hdHRlZCgpIHsKICAgICAgcmV0dXJuIHRoaXMudGltZSAhPSBudWxsICYmIHRoaXMudGltZSAhPSAiIiAmJiB0aGlzLnRpbWUgIT0gdW5kZWZpbmVkID8gZm9ybWF0KHRoaXMudGltZSwgJ01NL2RkL3l5eXknKSA6ICIiOwogICAgfSwKICAgIGRpc2FibGVTdWJtaXRCdG46IGZ1bmN0aW9uIGRpc2FibGVTdWJtaXRCdG4oKSB7CiAgICAgIHZhciBkaXNhYmxlZCA9IHRoaXMuY29udGFjdE9iaiA9PSBudWxsIHx8ICF0aGlzLmNvbnRhY3RPYmouaXNWYWxpZCB8fCB0aGlzLmNvbnRhY3RPYmoucGhvbmVOdW1iZXIgPT0gIiIgfHwgdGhpcy5jb250YWN0T2JqLnBob25lTnVtYmVyID09IG51bGwgfHwgdGhpcy5saWNlbmNlUGxhdGUgPT09ICIiIHx8IHRoaXMubGljZW5jZVBsYXRlID09PSBudWxsIHx8IHRoaXMuZGlzYWJsZUFkZFBheW1lbnRCdG4gfHwgdGhpcy5lc3RpbWF0ZSA9PT0gbnVsbCB8fCB0aGlzLmVzdGltYXRlID09PSAiIjsKICAgICAgdGhpcy5leGl0RGF0ZSA9PT0gIiI7CiAgICAgIHZhciBzZWxlY3RlZE1pbnMgPSB0aGlzLnRpbWUgIT09IG51bGwgJiYgdGhpcy50aW1lICE9PSB1bmRlZmluZWQgJiYgdGhpcy50aW1lICE9PSAiIiA/IGZvcm1hdCh0aGlzLnRpbWUsICdtbScpIDogbmV3IERhdGUoKTsKICAgICAgdmFyIHNlbGVjdGVkSG91cnMgPSB0aGlzLnRpbWUgIT09IG51bGwgJiYgdGhpcy50aW1lICE9PSB1bmRlZmluZWQgJiYgdGhpcy50aW1lICE9PSAiIiA/IGZvcm1hdCh0aGlzLnRpbWUsICdoaCcpIDogbmV3IERhdGUoKTsKICAgICAgdmFyIHNlbGVjdGVkQU1QTSA9IHRoaXMudGltZSAhPT0gbnVsbCAmJiB0aGlzLnRpbWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRpbWUgIT09ICIiID8gZm9ybWF0KHRoaXMudGltZSwgJ2FhYScpIDogbmV3IERhdGUoKTsKICAgICAgZGlzYWJsZWQgPSBkaXNhYmxlZCB8fCBzZWxlY3RlZE1pbnMgPT0gbnVsbCB8fCBzZWxlY3RlZE1pbnMgPT09ICIiIHx8IHNlbGVjdGVkTWlucyA9PSB1bmRlZmluZWQgfHwgc2VsZWN0ZWRIb3VycyA9PSBudWxsIHx8IHNlbGVjdGVkSG91cnMgPT09ICIiIHx8IHNlbGVjdGVkSG91cnMgPT0gdW5kZWZpbmVkIHx8IHNlbGVjdGVkQU1QTSA9PSBudWxsIHx8IHNlbGVjdGVkQU1QTSA9PT0gIiIgfHwgc2VsZWN0ZWRBTVBNID09IHVuZGVmaW5lZCB8fCB0aGlzLnRpbWUgPT09IG51bGwgfHwgdGhpcy50aW1lID09PSAiIiB8fCB0aGlzLnRpbWUgPT09IHVuZGVmaW5lZDsKICAgICAgZGlzYWJsZWQgPSB0aGlzLmxpY2VuY2VQbGF0ZSAhPSAiIiAmJiB0aGlzLmxpY2VuY2VQbGF0ZSAhPSBudWxsID8gZGlzYWJsZWQgfHwgL15bYS16MC05XSskL2kudGVzdCh0aGlzLmxpY2VuY2VQbGF0ZSkgPT09IGZhbHNlIDogZGlzYWJsZWQ7CiAgICAgIHJldHVybiBkaXNhYmxlZDsKICAgIH0sCiAgICBkaXNhYmxlQWRkTGljZW5jZVBsYXRlQnRuOiBmdW5jdGlvbiBkaXNhYmxlQWRkTGljZW5jZVBsYXRlQnRuKCkgewogICAgICBpZiAodGhpcy56b25lRGV0YWlscy5scHJfc3RhdHVzID09ICIwIikgewogICAgICAgIHJldHVybiB0aGlzLmlzQ29udGFjdFZhbGlkID09IGZhbHNlID8gdHJ1ZSA6IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLmlzQ29udGFjdFZhbGlkID09IGZhbHNlIHx8IHRoaXMubGljZW5jZVBsYXRlID09ICIiIHx8IHRoaXMubGljZW5jZVBsYXRlID09IG51bGwgfHwgL15bYS16MC05XSskL2kudGVzdCh0aGlzLmxpY2VuY2VQbGF0ZSkgPT09IGZhbHNlID8gdHJ1ZSA6IGZhbHNlOwogICAgICB9CiAgICB9CiAgfSksCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgRXZlbnRCdXMuJG9uKCdTRVRfVElNRScsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMub25UaW1lUGlja2VyQ2hhbmdlKCk7CiAgICB9KTsKICAgIHRoaXMuc2V0RGVmYXVsdERhdGUoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHJvdW5kOiBmdW5jdGlvbiByb3VuZCh0aW1lKSB7CiAgICAgIHZhciBleGl0ZGF0ZSA9IHRpbWUgIT09IG51bGwgJiYgdGltZSAhPT0gJycgPyBmb3JtYXQodGltZSwgJ3l5eXkvTU0vZGQnKSA6IG5ldyBEYXRlKCk7CiAgICAgIHZhciBzZWxlY3RlZE1pbnMgPSB0aW1lICE9PSBudWxsICYmIHRpbWUgIT09ICcnID8gZm9ybWF0KHRpbWUsICdtbScpIDogbmV3IERhdGUoKTsKICAgICAgdmFyIHNlbGVjdGVkSG91cnMgPSB0aW1lICE9PSBudWxsICYmIHRpbWUgIT09ICcnID8gZm9ybWF0KHRpbWUsICdoaCcpIDogbmV3IERhdGUoKTsKICAgICAgdmFyIHNlbGVjdGVkQU1QTSA9IHRpbWUgIT09IG51bGwgJiYgdGltZSAhPT0gJycgPyBmb3JtYXQodGltZSwgJ2FhYScpIDogbmV3IERhdGUoKTsKCiAgICAgIGlmIChleGl0ZGF0ZSAhPSBudWxsICYmIHNlbGVjdGVkTWlucyAhPSAnMTUnICYmIHNlbGVjdGVkTWlucyAhPSAnMzAnICYmIHNlbGVjdGVkTWlucyAhPSAnNDUnICYmIHNlbGVjdGVkTWlucyAhPSAnMDAnICYmIHNlbGVjdGVkTWlucyAhPSBudWxsICYmIHNlbGVjdGVkTWlucyAhPSAiIiAmJiBzZWxlY3RlZEhvdXJzICE9IG51bGwgJiYgc2VsZWN0ZWRIb3VycyAhPSAiIiAmJiBzZWxlY3RlZEFNUE0gIT0gbnVsbCAmJiBzZWxlY3RlZEFNUE0gIT0gIiIpIHsKICAgICAgICB2YXIgaW50ZXJ2YWxNaWxsaXNlY29uZHMgPSA5MDAwMDA7CiAgICAgICAgdmFyIGRhdGV0aW1lID0gbmV3IERhdGUoZXhpdGRhdGUgKyAiICIgKyBzZWxlY3RlZEhvdXJzICsgIjoiICsgc2VsZWN0ZWRNaW5zICsgIiAiICsgc2VsZWN0ZWRBTVBNKTsKICAgICAgICB2YXIgaW50ZXJ2YWwgPSBkYXRldGltZS5nZXRUaW1lKCkgJSBpbnRlcnZhbE1pbGxpc2Vjb25kczsKICAgICAgICB2YXIgZGVsdGEgPSBpbnRlcnZhbCA9PT0gMCA/IDAgOiBkYXRldGltZS5nZXRUaW1lKCkgLSBpbnRlcnZhbDsKICAgICAgICBkZWx0YSArPSBpbnRlcnZhbE1pbGxpc2Vjb25kczsgLy8gdGhpcy5leGl0VGltZVNlbGVjdGVkID0gT2JqZWN0LmFzc2lnbih0aGlzLmV4aXRUaW1lU2VsZWN0ZWQsIHsgaGg6IGZvcm1hdChuZXcgRGF0ZShkZWx0YSksICdoaCcpLCBtbTogZm9ybWF0KG5ldyBEYXRlKGRlbHRhKSwgJ21tJyksIGE6IGZvcm1hdChuZXcgRGF0ZShkZWx0YSksICdhJyksIH0pCgogICAgICAgIHJldHVybiBpbnRlcnZhbCAhPT0gMCA/IG5ldyBEYXRlKGRlbHRhKSA6IGRhdGV0aW1lOwogICAgICB9CiAgICB9LAogICAgZGF0ZUNoYW5nZTogZnVuY3Rpb24gZGF0ZUNoYW5nZSgpIHsKICAgICAgdmFyIF90aGlzJHpvbmVEZXRhaWxzMjsKCiAgICAgIHRoaXMuZGF0ZVRpbWVDaGFuZ2UoKTsKICAgICAgT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodGhpcy56b25lRGV0YWlscywgJ3RpbWVQaWNrZXJDb25maWd1cmF0aW9uJykgJiYgKChfdGhpcyR6b25lRGV0YWlsczIgPSB0aGlzLnpvbmVEZXRhaWxzKSA9PT0gbnVsbCB8fCBfdGhpcyR6b25lRGV0YWlsczIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHpvbmVEZXRhaWxzMi50aW1lUGlja2VyQ29uZmlndXJhdGlvbikgPT0gIjEiID8gdGhpcy5iZWZvcmVEYXRlVGltZUNoYW5nZSgpIDogIiI7CiAgICB9LAogICAgZm9ybWF0RXhpdERhdGVUaW1lOiBmdW5jdGlvbiBmb3JtYXRFeGl0RGF0ZVRpbWUodGltZSwgdmFsKSB7CiAgICAgIGlmICh0aW1lICE9PSBudWxsICYmIHRpbWUgIT09IHVuZGVmaW5lZCAmJiB0aW1lICE9ICcnKSB7CiAgICAgICAgdmFyIHV0Y0RhdGUgPSBuZXcgRGF0ZSh0aW1lICogMTAwMCkudG9VVENTdHJpbmcoKTsgLy8iV2VkLCAyNyBKYW4gMjAyMSAxMzo1OTowNCBHTVQiCgogICAgICAgIHZhciBtb250aCA9IHV0Y0RhdGUuc3BsaXQoIiwiKVsxXS5zcGxpdCgiICIpWzJdOyAvLyBKYW4KCiAgICAgICAgdmFyIGRhdGUgPSB1dGNEYXRlLnNwbGl0KCIsIilbMV0uc3BsaXQoIiAiKVsxXTsgLy8gMjcKCiAgICAgICAgdmFyIHllYXIgPSB1dGNEYXRlLnNwbGl0KCIsIilbMV0uc3BsaXQoIiAiKVszXTsKICAgICAgICB2YXIgaHIgPSB1dGNEYXRlLnNwbGl0KCIsIilbMV0uc3BsaXQoIiAiKVs0XS5zcGxpdCgiOiIpWzBdOyAvLyAxMwoKICAgICAgICB2YXIgbWluID0gdXRjRGF0ZS5zcGxpdCgiLCIpWzFdLnNwbGl0KCIgIilbNF0uc3BsaXQoIjoiKVsxXTsgLy81OQoKICAgICAgICB2YXIgZm9ybWF0SHIgPSBOdW1iZXIoaHIpID4gMTIgPyBOdW1iZXIoaHIpIC0gMTIgOiBOdW1iZXIoaHIpOyAvLyAxCgogICAgICAgIGZvcm1hdEhyID0gTnVtYmVyKGZvcm1hdEhyKSA+PSAxMCA/IE51bWJlcihmb3JtYXRIcikgOiBmb3JtYXRIcjsgLy8wMQoKICAgICAgICB2YXIgYW1PcnBtID0gTnVtYmVyKGhyKSA+PSAxMiA/ICJwIiA6ICJhIjsgLy9QTQoKICAgICAgICB2YXIgYW1wbSA9IE51bWJlcihocikgPj0gMTIgPyAiUE0iIDogIkFNIjsKCiAgICAgICAgc3dpdGNoICh2YWwpIHsKICAgICAgICAgIGNhc2UgJ2hvdXInOgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgcmV0dXJuIGZvcm1hdEhyICsgYW1PcnBtOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSAnbWlucyc6CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICByZXR1cm4gbWluOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSAnZGF0ZSc6CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICByZXR1cm4gbW9udGggKyAiICIgKyBkYXRlICsgIiwgIiArIHllYXIgKyAiICIgKyBmb3JtYXRIciArICI6IiArIG1pbiArICIgIiArIGFtcG07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gLy9KYW4gMjcsIDAxOjU5IFBNCgogICAgfSwKICAgIHJlbG9hZEJvb2tpbmc6IGZ1bmN0aW9uIHJlbG9hZEJvb2tpbmcoKSB7CiAgICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24ub3JpZ2luICsgIi9nLyIgKyB0aGlzLmNhc2lub0RldGFpbHMudXNlckRldGFpbC5iaWQ7CiAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHVybCk7CiAgICB9LAogICAgc2V0RGVmYXVsdERhdGU6IGZ1bmN0aW9uIHNldERlZmF1bHREYXRlKCkgewogICAgICB0aGlzLmRhdGVGb3JtYXR0ZWQgPSB0aGlzLnpvbmVEZXRhaWxzLnRpbWV6b25lID8gZm9ybWF0KGRhdGVUb1RpbWVab25lRGF0ZShhZGRNaW51dGVzKG5ldyBEYXRlKCksIDE1KSwgdGhpcy56b25lRGV0YWlscy50aW1lem9uZSksICJNTS9kZC95eXl5IikgOiBmb3JtYXQoYWRkTWludXRlcyhuZXcgRGF0ZSgpLCAxNSksICJNTS9kZC95eXl5Iik7CiAgICAgIHRoaXMudGltZSA9IHRoaXMuem9uZURldGFpbHMudGltZXpvbmUgPyBkYXRlVG9UaW1lWm9uZURhdGUoYWRkTWludXRlcyhuZXcgRGF0ZSgpLCAxNSksIHRoaXMuem9uZURldGFpbHMudGltZXpvbmUpIDogYWRkTWludXRlcyhuZXcgRGF0ZSgpLCAxNSk7CiAgICAgIHZhciBmaWZ0ZWVuVGltZSA9IHRoaXMudGltZTsKICAgICAgdGhpcy50aW1lID0gZm9ybWF0KHRoaXMudGltZSwgJ21tJykgPT09ICcxNScgfHwgZm9ybWF0KHRoaXMudGltZSwgJ21tJykgPT09ICczMCcgfHwgZm9ybWF0KHRoaXMudGltZSwgJ21tJykgPT09ICc0NScgfHwgZm9ybWF0KHRoaXMudGltZSwgJ21tJykgPT09ICcwMCcgPyBmaWZ0ZWVuVGltZSA6IHRoaXMucm91bmQodGhpcy50aW1lKTsKICAgICAgdmFyIHNlbGVjdGVkTWlucyA9IHRoaXMudGltZSAhPT0gbnVsbCAmJiB0aGlzLnRpbWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRpbWUgIT09ICIiID8gZm9ybWF0KHRoaXMudGltZSwgJ21tJykgOiAiIjsKICAgICAgdmFyIHNlbGVjdGVkSG91cnMgPSB0aGlzLnRpbWUgIT09IG51bGwgJiYgdGhpcy50aW1lICE9PSB1bmRlZmluZWQgJiYgdGhpcy50aW1lICE9PSAiIiA/IGZvcm1hdCh0aGlzLnRpbWUsICdISCcpIDogIiI7CiAgICAgIHZhciBzZWxlY3RlZEFNUE0gPSB0aGlzLnRpbWUgIT09IG51bGwgJiYgdGhpcy50aW1lICE9PSB1bmRlZmluZWQgJiYgdGhpcy50aW1lICE9PSAiIiA/IGZvcm1hdCh0aGlzLnRpbWUsICdhJykgOiAiIjsKICAgICAgdGhpcy5zdG9wVGltZSA9IHNlbGVjdGVkTWlucyAhPSBudWxsICYmIHNlbGVjdGVkTWlucyAhPSAiIiAmJiBzZWxlY3RlZEhvdXJzICE9IG51bGwgJiYgc2VsZWN0ZWRIb3VycyAhPSAiIiAmJiBzZWxlY3RlZEFNUE0gIT0gbnVsbCAmJiBzZWxlY3RlZEFNUE0gIT0gIiIgPyBzZWxlY3RlZEhvdXJzICsgIjoiICsgc2VsZWN0ZWRNaW5zICsgIjoiICsgIjAwIiA6ICIiOyAvLyB0aGlzLmRhdGVUaW1lQ2hhbmdlKCkKICAgICAgLy8gT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodGhpcy56b25lRGV0YWlscywgJ3RpbWVQaWNrZXJDb25maWd1cmF0aW9uJykgJiYgdGhpcy56b25lRGV0YWlscz8udGltZVBpY2tlckNvbmZpZ3VyYXRpb24gPT0gIjEiICYmIGZvcm1hdCh0aGlzLnRpbWUsICd5eXl5LU1NLWRkJykgIT0gZm9ybWF0KGRhdGVUb1RpbWVab25lRGF0ZShuZXcgRGF0ZSgpLCB0aGlzLnpvbmVEZXRhaWxzLnRpbWV6b25lKSwgJ3l5eXktTU0tZGQnKSA/IHRoaXMuYmVmb3JlRGF0ZVRpbWVDaGFuZ2UoKSA6ICIiOwogICAgfSwKICAgIG9uVGltZVBpY2tlckNoYW5nZTogZnVuY3Rpb24gb25UaW1lUGlja2VyQ2hhbmdlKCkgewogICAgICB2YXIgZXhpdGRhdGUgPSB0aGlzLnRpbWUgIT09IG51bGwgJiYgdGhpcy50aW1lICE9PSB1bmRlZmluZWQgJiYgdGhpcy50aW1lICE9PSAiIiA/IGZvcm1hdCh0aGlzLnRpbWUsICd5eXl5L01NL2RkJykgOiAiIjsKICAgICAgdmFyIHNlbGVjdGVkTWlucyA9IHRoaXMudGltZSAhPT0gbnVsbCAmJiB0aGlzLnRpbWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRpbWUgIT09ICIiID8gZm9ybWF0KHRoaXMudGltZSwgJ21tJykgOiAiIjsKICAgICAgdmFyIHNlbGVjdGVkSG91cnMgPSB0aGlzLnRpbWUgIT09IG51bGwgJiYgdGhpcy50aW1lICE9PSB1bmRlZmluZWQgJiYgdGhpcy50aW1lICE9PSAiIiA/IGZvcm1hdCh0aGlzLnRpbWUsICdISCcpIDogIiI7CiAgICAgIHZhciBzZWxlY3RlZEFNUE0gPSB0aGlzLnRpbWUgIT09IG51bGwgJiYgdGhpcy50aW1lICE9PSB1bmRlZmluZWQgJiYgdGhpcy50aW1lICE9PSAiIiA/IGZvcm1hdCh0aGlzLnRpbWUsICdhJykgOiAiIjsKICAgICAgdGhpcy5zdG9wVGltZSA9IHNlbGVjdGVkTWlucyAhPSBudWxsICYmIHNlbGVjdGVkTWlucyAhPSAiIiAmJiBzZWxlY3RlZEhvdXJzICE9IG51bGwgJiYgc2VsZWN0ZWRIb3VycyAhPSAiIiAmJiBzZWxlY3RlZEFNUE0gIT0gbnVsbCAmJiBzZWxlY3RlZEFNUE0gIT0gIiIgPyBzZWxlY3RlZEhvdXJzICsgIjoiICsgc2VsZWN0ZWRNaW5zICsgIjoiICsgIjAwIiA6ICIiOwogICAgICB2YXIgY3VycmVuVGltZSA9IHRoaXMuem9uZURldGFpbHMudGltZXpvbmUgPyBmb3JtYXQoZGF0ZVRvVGltZVpvbmVEYXRlKG5ldyBEYXRlKCksIHRoaXMuem9uZURldGFpbHMudGltZXpvbmUpLCAieXl5eS1NTS1kZCBISDptbTpzcyIpIDogZm9ybWF0KG5ldyBEYXRlKCksICJ5eXl5LU1NLWRkICBISDptbTpzcyIpOwoKICAgICAgaWYgKHNlbGVjdGVkTWlucyAhPSBudWxsICYmIHNlbGVjdGVkTWlucyAhPSAiIiAmJiBzZWxlY3RlZEhvdXJzICE9IG51bGwgJiYgc2VsZWN0ZWRIb3VycyAhPSAiIiAmJiBzZWxlY3RlZEFNUE0gIT0gbnVsbCAmJiBzZWxlY3RlZEFNUE0gIT0gIiIgJiYgbmV3IERhdGUoZXhpdGRhdGUgKyAiICIgKyB0aGlzLnN0b3BUaW1lKS5nZXRUaW1lKCkgPiBuZXcgRGF0ZShjdXJyZW5UaW1lKS5nZXRUaW1lKCkpIHsKICAgICAgICBmb3JtYXQodGhpcy50aW1lLCAneXl5eS1NTS1kZCcpICE9IGZvcm1hdCh0aGlzLm1pblRpbWVEYXRlLCAneXl5eS1NTS1kZCcpID8gdGhpcy5iZWZvcmVEYXRlVGltZUNoYW5nZSgpIDogIiI7CiAgICAgICAgdGhpcy5kYXRlVGltZUNoYW5nZSgpOwogICAgICB9CiAgICB9LAogICAgc2V0RGF0ZVBpY2tlcjogZnVuY3Rpb24gc2V0RGF0ZVBpY2tlcigpIHsKICAgICAgdmFyIF90aGlzJHpvbmVEZXRhaWxzMzsKCiAgICAgIC8vc2V0IHRoZSBtaW5pbXVtIGRhdGUgdG8gdG9kYXkgZGF0ZSh6b25lIHRpbWUgem9uZSBkYXRlKQogICAgICB0aGlzLm1pblRpbWVEYXRlID0gdGhpcy56b25lRGV0YWlscy50aW1lem9uZSA/IHRoaXMucm91bmQodGhpcy56b25lRGV0YWlscy50aW1lem9uZSA/IGRhdGVUb1RpbWVab25lRGF0ZShhZGRNaW51dGVzKG5ldyBEYXRlKCksIDE1KSwgdGhpcy56b25lRGV0YWlscy50aW1lem9uZSkgOiBhZGRNaW51dGVzKG5ldyBEYXRlKCksIDE1KSkgOiB0aGlzLnpvbmVEZXRhaWxzLnRpbWV6b25lID8gZGF0ZVRvVGltZVpvbmVEYXRlKGFkZE1pbnV0ZXMobmV3IERhdGUoKSwgMTUpLCB0aGlzLnpvbmVEZXRhaWxzLnRpbWV6b25lKSA6IGFkZE1pbnV0ZXMobmV3IERhdGUoKSwgMTUpOyAvL2NhbGN1bGF0ZSBtYXggcGFya2lnbiB0aW1lIGluIHNlY29uZHMKCiAgICAgIHZhciBtYXhQYXJrID0gdGhpcy56b25lRGV0YWlscyAhPSBudWxsICYmIHRoaXMuem9uZURldGFpbHMgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnpvbmVEZXRhaWxzICE9ICIiID8gKF90aGlzJHpvbmVEZXRhaWxzMyA9IHRoaXMuem9uZURldGFpbHMpID09PSBudWxsIHx8IF90aGlzJHpvbmVEZXRhaWxzMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkem9uZURldGFpbHMzLm1heFBhcmtpbmdUaW1lIDogbnVsbDsKICAgICAgdmFyIGFkZGVkZGF5cyA9IGFkZERheXMobmV3IERhdGUoKSwgbWF4UGFyayA9PT0gbnVsbCB8fCBtYXhQYXJrID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtYXhQYXJrLmRheXMpOwogICAgICB2YXIgYWRkZWRob3VycyA9IGFkZEhvdXJzKGFkZGVkZGF5cywgbWF4UGFyayA9PT0gbnVsbCB8fCBtYXhQYXJrID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtYXhQYXJrLmhvdXJzKTsKICAgICAgdmFyIGFkZGVkbWlucyA9IGFkZE1pbnV0ZXMoYWRkZWRob3VycywgbWF4UGFyayA9PT0gbnVsbCB8fCBtYXhQYXJrID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtYXhQYXJrLm1pbnV0ZXMpOyAvL2dldCBtYXggZGF0ZSBpbiBzZWNvbmRzIGJhc2VkIG9uIG1heCBwYXJraW5nIHRpbWUKCiAgICAgIHZhciBtYXhab25lRGF0ZSA9IGFkZGVkbWluczsKICAgICAgdGhpcy5tYXhUaW1lRGF0ZSA9IHRoaXMuem9uZURldGFpbHMudGltZXpvbmUgPyBkYXRlVG9UaW1lWm9uZURhdGUobmV3IERhdGUobWF4Wm9uZURhdGUpLCB0aGlzLnpvbmVEZXRhaWxzLnRpbWV6b25lKSA6IG5ldyBEYXRlKG1heFpvbmVEYXRlKTsgLy9nZXQgbWF4IGRhdGUgd2l0aCB0aW1lIGFuZCBzZXQgaXQgdG8gbWF4RGF0ZVRpbWUKCiAgICAgIHRoaXMubWF4RGF0ZVRpbWUgPSB0aGlzLnpvbmVEZXRhaWxzLnRpbWV6b25lID8gZm9ybWF0KGRhdGVUb1RpbWVab25lRGF0ZShuZXcgRGF0ZShtYXhab25lRGF0ZSksIHRoaXMuem9uZURldGFpbHMudGltZXpvbmUpLCAieXl5eS1NTS1kZCBoaDptbSBhYWFhYSIpIDogZm9ybWF0KG5ldyBEYXRlKCksICJ5eXl5LU1NLWRkIGhoOm1tIGFhYWFhIik7CiAgICB9LAoKICAgIC8qKiBAbWV0aG9kcyB0byBmaW5kIHRoZSBlc3RpbWF0ZSByYXRlIAogICAgIEBwYXJhbXMgc3RhcnREYXRlICwgc3RvcERhdGUsemNvZGUsIHR5cGUgLCBlbnZfb3ZlclJpZGUKICAgICAqLwogICAgZGF0ZVRpbWVDaGFuZ2U6IGZ1bmN0aW9uIGRhdGVUaW1lQ2hhbmdlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciBfdGhpczIkem9uZURldGFpbHMsIF9nZXRSYXRlJGRhdGEsIF9nZXRSYXRlJGRhdGEzLCBocmVmLCBlZHRFbnRyeVRpbWUsIHBhcmFtcywgdGltZXBhcmFtLCBzdG9wVGltZSwgZXhpdGRhdGUsIGV4aXR0aW1lLCBzdG9wRGF0ZSwgZGF0YSwgZ2V0UmF0ZSwgX2dldFJhdGUkZGF0YTI7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLnpvbmVEZXRhaWxzLnpjb2RlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDI7CiAgICAgICAgICAgICAgICAvLyBmb3JtYXQobmV3IERhdGUodGhpcy5jaGVja2luRGF0ZSksICJ5eXl5LU1NLWRkJ1QnSEg6bW06c3MiKTsKICAgICAgICAgICAgICAgIGhyZWYgPSB3aW5kb3cubG9jYXRpb24uaHJlZjsKICAgICAgICAgICAgICAgIGVkdEVudHJ5VGltZSA9ICIiOwoKICAgICAgICAgICAgICAgIGlmIChocmVmLmluY2x1ZGVzKCdlbnRyeXRpbWUnKSkgewogICAgICAgICAgICAgICAgICBwYXJhbXMgPSBocmVmLnNwbGl0KCc/Jyk7CiAgICAgICAgICAgICAgICAgIHRpbWVwYXJhbSA9IHBhcmFtc1syXS5zcGxpdCgnZW50cnl0aW1lJylbMV07CiAgICAgICAgICAgICAgICAgIGVkdEVudHJ5VGltZSA9IHRpbWVwYXJhbS5zdWJzdHJpbmcoMSwgdGltZXBhcmFtLmxlbmd0aCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMyLnN0YXJ0RGF0ZSA9IGVkdEVudHJ5VGltZSAhPT0gbnVsbCAmJiBlZHRFbnRyeVRpbWUgIT09IHVuZGVmaW5lZCAmJiBlZHRFbnRyeVRpbWUgIT09ICIiID8gZm9ybWF0KG5ldyBEYXRlKF90aGlzMi5mb3JtYXRFeGl0RGF0ZVRpbWUoZWR0RW50cnlUaW1lLCAnZGF0ZScpKSwgInl5eXktTU0tZGQnVCdISDptbTpzcyIpIDogX3RoaXMyLnpvbmVEZXRhaWxzLnRpbWV6b25lID8gZm9ybWF0KGRhdGVUb1RpbWVab25lRGF0ZShuZXcgRGF0ZSgpLCBfdGhpczIuem9uZURldGFpbHMudGltZXpvbmUpLCAieXl5eS1NTS1kZCdUJ0hIOm1tOnNzIikgOiBmb3JtYXQobmV3IERhdGUoKSwgInl5eXktTU0tZGQnVCdISDptbTpzcyIpOyAvLyBjb25zb2xlLmxvZyh0aGlzLmV4aXRUaW1lU2VsZWN0ZWQ/LmhoKyI6Iit0aGlzLmV4aXRUaW1lU2VsZWN0ZWQubW0rIjowMCIpCiAgICAgICAgICAgICAgICAvLyB0aGlzLmV4aXREYXRlICsgIlQyMzo1OTowMCIKCiAgICAgICAgICAgICAgICBzdG9wVGltZSA9IF90aGlzMi5zdG9wVGltZTsKICAgICAgICAgICAgICAgIGV4aXRkYXRlID0gX3RoaXMyLnRpbWUgIT09IG51bGwgJiYgX3RoaXMyLnRpbWUgIT09IHVuZGVmaW5lZCAmJiBfdGhpczIudGltZSAhPT0gIiIgPyBmb3JtYXQoX3RoaXMyLnRpbWUsICd5eXl5LU1NLWRkJykgOiAiIjsKICAgICAgICAgICAgICAgIGV4aXR0aW1lID0gT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoX3RoaXMyLnpvbmVEZXRhaWxzLCAndGltZVBpY2tlckNvbmZpZ3VyYXRpb24nKSAmJiAoKF90aGlzMiR6b25lRGV0YWlscyA9IF90aGlzMi56b25lRGV0YWlscykgPT09IG51bGwgfHwgX3RoaXMyJHpvbmVEZXRhaWxzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpczIkem9uZURldGFpbHMudGltZVBpY2tlckNvbmZpZ3VyYXRpb24pID09ICcxJyA/ICdUJyArIHN0b3BUaW1lIDogIlQyMzo1OTowMCI7CiAgICAgICAgICAgICAgICBzdG9wRGF0ZSA9IGV4aXRkYXRlICsgZXhpdHRpbWU7CiAgICAgICAgICAgICAgICBkYXRhID0gewogICAgICAgICAgICAgICAgICBzdGFydEF0OiBfdGhpczIuc3RhcnREYXRlLAogICAgICAgICAgICAgICAgICBzdG9wQXQ6IHN0b3BEYXRlLAogICAgICAgICAgICAgICAgICB6Y29kZTogX3RoaXMyLnpvbmVEZXRhaWxzLnpjb2RlCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX3RoaXMyLmFkZFBheW1lbnRCdG5Mb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICByZXR1cm4gQVBJSGVscGVyKCJQT1NUIiwgIi9hcGkvdjIvZ2V0UmF0ZSIsIGRhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgZ2V0UmF0ZSA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgICAgIC8vY29uZGl0aW9uIHRvIGNoZWNrIGlmIHRoZSBkYXRlIHRpbWUgc2VsZWN0ZWQgaXMgbGVzc2VyIHRoYW4gY3VycmVudCB0aW1lCiAgICAgICAgICAgICAgICBpZiAoIShnZXRSYXRlICE9PSBudWxsICYmIGdldFJhdGUgIT09IHZvaWQgMCAmJiAoX2dldFJhdGUkZGF0YSA9IGdldFJhdGUuZGF0YSkgIT09IG51bGwgJiYgX2dldFJhdGUkZGF0YSAhPT0gdm9pZCAwICYmIF9nZXRSYXRlJGRhdGEuc3RhdHVzKSAmJiAhX3RoaXMyLmdldFJhdGVDYWxsKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMi5kaXNhYmxlQWRkUGF5bWVudEJ0biA9IHRydWU7CiAgICAgICAgICAgICAgICAgIF90aGlzMi5hbGVydERpYWxvZyA9IHRydWU7CiAgICAgICAgICAgICAgICAgIF90aGlzMi5hbGVydE1zZyA9IChnZXRSYXRlID09PSBudWxsIHx8IGdldFJhdGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZ2V0UmF0ZSRkYXRhMiA9IGdldFJhdGUuZGF0YSkgPT09IG51bGwgfHwgX2dldFJhdGUkZGF0YTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9nZXRSYXRlJGRhdGEyLm1lc3NhZ2UpIHx8ICJFcnJvciBpbiBnZXR0aW5nIHJhdGUgZGV0YWlscyI7CiAgICAgICAgICAgICAgICAgIF90aGlzMi5vcGVuRGF0ZVBpY2tlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgICBfdGhpczIub3BlblRpbWVQaWNrZXIgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ2RhdGV0aW1lLXNldCcpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyLmRpc2FibGVBZGRQYXltZW50QnRuID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIF90aGlzMi5vcGVuRGF0ZVBpY2tlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgICBfdGhpczIub3BlblRpbWVQaWNrZXIgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ2RhdGV0aW1lLXNldCcpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMi5lc3RpbWF0ZSA9IE9iamVjdC5hc3NpZ24oe30sIGdldFJhdGUgPT09IG51bGwgfHwgZ2V0UmF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9nZXRSYXRlJGRhdGEzID0gZ2V0UmF0ZS5kYXRhKSA9PT0gbnVsbCB8fCBfZ2V0UmF0ZSRkYXRhMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2dldFJhdGUkZGF0YTMuZGF0YSk7IC8vIGVzdGltYXRlZFZhbCAhPSAiIiAmJgogICAgICAgICAgICAgICAgLy8gZXN0aW1hdGVkVmFsICE9IG51bGwgJiYKICAgICAgICAgICAgICAgIC8vIGVzdGltYXRlZFZhbCAhPSB1bmRlZmluZWQKICAgICAgICAgICAgICAgIC8vICAgPyBOdW1iZXIoZXN0aW1hdGVkVmFsKS50b0ZpeGVkKDIpCiAgICAgICAgICAgICAgICAvLyAgIDogZXN0aW1hdGVkVmFsOwoKICAgICAgICAgICAgICAgIF90aGlzMi5vcGVuRGF0ZVBpY2tlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgX3RoaXMyLm9wZW5UaW1lUGlja2VyID0gZmFsc2U7CiAgICAgICAgICAgICAgICBfdGhpczIuYWRkUGF5bWVudEJ0bkxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjc7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMjM7CiAgICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oMik7CiAgICAgICAgICAgICAgICBfdGhpczIuYWRkUGF5bWVudEJ0bkxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKF9jb250ZXh0Mi50MCk7CgogICAgICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIsIG51bGwsIFtbMiwgMjNdXSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGJlZm9yZURhdGVUaW1lQ2hhbmdlOiBmdW5jdGlvbiBiZWZvcmVEYXRlVGltZUNoYW5nZSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgICAgICB2YXIgX3RoaXMzJHpvbmVEZXRhaWxzLCBfZ2V0UmF0ZSRkYXRhNCwgX2dldFJhdGUkZGF0YTYsIGhyZWYsIGVkdEVudHJ5VGltZSwgcGFyYW1zLCB0aW1lcGFyYW0sIHN0b3BUaW1lLCBzZWxlY3RlZEhvdXJzLCBzZWxlY3RlZE1pbnMsIGV4aXRkYXRlLCBleGl0dGltZSwgc3RvcERhdGUsIGRhdGEsIGdldFJhdGUsIF9nZXRSYXRlJGRhdGE1OwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKF90aGlzMy56b25lRGV0YWlscy56Y29kZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAyOwogICAgICAgICAgICAgICAgLy8gZm9ybWF0KG5ldyBEYXRlKHRoaXMuY2hlY2tpbkRhdGUpLCAieXl5eS1NTS1kZCdUJ0hIOm1tOnNzIik7CiAgICAgICAgICAgICAgICBocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWY7CiAgICAgICAgICAgICAgICBlZHRFbnRyeVRpbWUgPSAiIjsKCiAgICAgICAgICAgICAgICBpZiAoaHJlZi5pbmNsdWRlcygnZW50cnl0aW1lJykpIHsKICAgICAgICAgICAgICAgICAgcGFyYW1zID0gaHJlZi5zcGxpdCgnPycpOwogICAgICAgICAgICAgICAgICB0aW1lcGFyYW0gPSBwYXJhbXNbMl0uc3BsaXQoJ2VudHJ5dGltZScpWzFdOwogICAgICAgICAgICAgICAgICBlZHRFbnRyeVRpbWUgPSB0aW1lcGFyYW0uc3Vic3RyaW5nKDEsIHRpbWVwYXJhbS5sZW5ndGgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMy5zdGFydERhdGUgPSBlZHRFbnRyeVRpbWUgIT09IG51bGwgJiYgZWR0RW50cnlUaW1lICE9PSB1bmRlZmluZWQgJiYgZWR0RW50cnlUaW1lICE9PSAiIiA/IGZvcm1hdChuZXcgRGF0ZShfdGhpczMuZm9ybWF0RXhpdERhdGVUaW1lKGVkdEVudHJ5VGltZSwgJ2RhdGUnKSksICJ5eXl5LU1NLWRkJ1QnSEg6bW06c3MiKSA6IF90aGlzMy56b25lRGV0YWlscy50aW1lem9uZSA/IGZvcm1hdChkYXRlVG9UaW1lWm9uZURhdGUobmV3IERhdGUoKSwgX3RoaXMzLnpvbmVEZXRhaWxzLnRpbWV6b25lKSwgInl5eXktTU0tZGQnVCdISDptbTpzcyIpIDogZm9ybWF0KG5ldyBEYXRlKCksICJ5eXl5LU1NLWRkJ1QnSEg6bW06c3MiKTsKICAgICAgICAgICAgICAgIHN0b3BUaW1lID0gX3RoaXMzLnN0b3BUaW1lOwogICAgICAgICAgICAgICAgc2VsZWN0ZWRIb3VycyA9IF90aGlzMy5jYXNpbm9EZXRhaWxzLnVzZXJEZXRhaWwuZW50cnl0aW1lICE9IG51bGwgJiYgX3RoaXMzLmNhc2lub0RldGFpbHMudXNlckRldGFpbC5lbnRyeXRpbWUgIT09IHVuZGVmaW5lZCAmJiBfdGhpczMuY2FzaW5vRGV0YWlscy51c2VyRGV0YWlsLmVudHJ5dGltZSAhPSAiIiA/IGZvcm1hdChuZXcgRGF0ZShfdGhpczMuY2FzaW5vRGV0YWlscy51c2VyRGV0YWlsLmVudHJ5dGltZSksICdISCcpIDogZm9ybWF0KGRhdGVUb1RpbWVab25lRGF0ZShuZXcgRGF0ZSgpLCBfdGhpczMuem9uZURldGFpbHMudGltZXpvbmUpLCAnSEgnKTsKICAgICAgICAgICAgICAgIHNlbGVjdGVkTWlucyA9IF90aGlzMy5jYXNpbm9EZXRhaWxzLnVzZXJEZXRhaWwuZW50cnl0aW1lICE9IG51bGwgJiYgX3RoaXMzLmNhc2lub0RldGFpbHMudXNlckRldGFpbC5lbnRyeXRpbWUgIT09IHVuZGVmaW5lZCAmJiBfdGhpczMuY2FzaW5vRGV0YWlscy51c2VyRGV0YWlsLmVudHJ5dGltZSAhPSAiIiA/IGZvcm1hdChuZXcgRGF0ZShfdGhpczMuY2FzaW5vRGV0YWlscy51c2VyRGV0YWlsLmVudHJ5dGltZSksICdtbScpIDogZm9ybWF0KGRhdGVUb1RpbWVab25lRGF0ZShuZXcgRGF0ZSgpLCBfdGhpczMuem9uZURldGFpbHMudGltZXpvbmUpLCAnbW0nKTsKICAgICAgICAgICAgICAgIGV4aXRkYXRlID0gX3RoaXMzLnRpbWUgIT09IG51bGwgJiYgX3RoaXMzLnRpbWUgIT09IHVuZGVmaW5lZCAmJiBfdGhpczMudGltZSAhPT0gIiIgPyBmb3JtYXQoX3RoaXMzLnRpbWUsICd5eXl5LU1NLWRkJykgOiAiIjsKICAgICAgICAgICAgICAgIGV4aXR0aW1lID0gT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoX3RoaXMzLnpvbmVEZXRhaWxzLCAnaXN0aW1lUGlja2VyQ29uZmlndXJhdGlvbkdhdGVkJykgJiYgKChfdGhpczMkem9uZURldGFpbHMgPSBfdGhpczMuem9uZURldGFpbHMpID09PSBudWxsIHx8IF90aGlzMyR6b25lRGV0YWlscyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMzJHpvbmVEZXRhaWxzLnRpbWVQaWNrZXJDb25maWd1cmF0aW9uKSA9PSAnMCcgPyAnVCcgKyBzdG9wVGltZSA6ICdUJyArIHNlbGVjdGVkSG91cnMgKyAiOiIgKyBzZWxlY3RlZE1pbnMgKyAiOjAwIjsKICAgICAgICAgICAgICAgIHN0b3BEYXRlID0gZXhpdGRhdGUgKyBleGl0dGltZTsKICAgICAgICAgICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICAgICAgIHN0YXJ0QXQ6IF90aGlzMy5zdGFydERhdGUsCiAgICAgICAgICAgICAgICAgIHN0b3BBdDogc3RvcERhdGUsCiAgICAgICAgICAgICAgICAgIHpjb2RlOiBfdGhpczMuem9uZURldGFpbHMuemNvZGUKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfdGhpczMuYWRkUGF5bWVudEJ0bkxvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxNzsKICAgICAgICAgICAgICAgIHJldHVybiBBUElIZWxwZXIoIlBPU1QiLCAiL2FwaS92Mi9nZXRSYXRlIiwgZGF0YSk7CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICBnZXRSYXRlID0gX2NvbnRleHQzLnNlbnQ7CgogICAgICAgICAgICAgICAgLy9jb25kaXRpb24gdG8gY2hlY2sgaWYgdGhlIGRhdGUgdGltZSBzZWxlY3RlZCBpcyBsZXNzZXIgdGhhbiBjdXJyZW50IHRpbWUKICAgICAgICAgICAgICAgIGlmICghKGdldFJhdGUgIT09IG51bGwgJiYgZ2V0UmF0ZSAhPT0gdm9pZCAwICYmIChfZ2V0UmF0ZSRkYXRhNCA9IGdldFJhdGUuZGF0YSkgIT09IG51bGwgJiYgX2dldFJhdGUkZGF0YTQgIT09IHZvaWQgMCAmJiBfZ2V0UmF0ZSRkYXRhNC5zdGF0dXMpICYmICFfdGhpczMuZ2V0UmF0ZUNhbGwpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzLmRpc2FibGVBZGRQYXltZW50QnRuID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgX3RoaXMzLmFsZXJ0RGlhbG9nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgX3RoaXMzLmFsZXJ0TXNnID0gKGdldFJhdGUgPT09IG51bGwgfHwgZ2V0UmF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9nZXRSYXRlJGRhdGE1ID0gZ2V0UmF0ZS5kYXRhKSA9PT0gbnVsbCB8fCBfZ2V0UmF0ZSRkYXRhNSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2dldFJhdGUkZGF0YTUubWVzc2FnZSkgfHwgIkVycm9yIGluIGdldHRpbmcgcmF0ZSBkZXRhaWxzIjsKICAgICAgICAgICAgICAgICAgX3RoaXMzLm9wZW5EYXRlUGlja2VyID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIF90aGlzMy5vcGVuVGltZVBpY2tlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnZGF0ZXRpbWUtc2V0Jyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczMuZGlzYWJsZUFkZFBheW1lbnRCdG4gPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgX3RoaXMzLm9wZW5EYXRlUGlja2VyID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIF90aGlzMy5vcGVuVGltZVBpY2tlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnZGF0ZXRpbWUtc2V0Jyk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMzLmJlZm9yZUVzdGltYXRlID0gT2JqZWN0LmFzc2lnbih7fSwgZ2V0UmF0ZSA9PT0gbnVsbCB8fCBnZXRSYXRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2dldFJhdGUkZGF0YTYgPSBnZXRSYXRlLmRhdGEpID09PSBudWxsIHx8IF9nZXRSYXRlJGRhdGE2ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZ2V0UmF0ZSRkYXRhNi5kYXRhKTsgLy8gZXN0aW1hdGVkVmFsICE9ICIiICYmCiAgICAgICAgICAgICAgICAvLyBlc3RpbWF0ZWRWYWwgIT0gbnVsbCAmJgogICAgICAgICAgICAgICAgLy8gZXN0aW1hdGVkVmFsICE9IHVuZGVmaW5lZAogICAgICAgICAgICAgICAgLy8gICA/IE51bWJlcihlc3RpbWF0ZWRWYWwpLnRvRml4ZWQoMikKICAgICAgICAgICAgICAgIC8vICAgOiBlc3RpbWF0ZWRWYWw7CgogICAgICAgICAgICAgICAgX3RoaXMzLmFkZFBheW1lbnRCdG5Mb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI3OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDIzOwogICAgICAgICAgICAgICAgX2NvbnRleHQzLnQwID0gX2NvbnRleHQzWyJjYXRjaCJdKDIpOwogICAgICAgICAgICAgICAgX3RoaXMzLmFkZFBheW1lbnRCdG5Mb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhfY29udGV4dDMudDApOwoKICAgICAgICAgICAgICBjYXNlIDI3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzLCBudWxsLCBbWzIsIDIzXV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBmb3JtYXREYXRlOiBmdW5jdGlvbiBmb3JtYXREYXRlKGRhdGUpIHsKICAgICAgdmFyIHN0cmluZ2RhdGUgPSBkYXRlLnRvU3RyaW5nKCk7CiAgICAgIGlmICghZGF0ZSkgcmV0dXJuIG51bGw7CgogICAgICB2YXIgX3N0cmluZ2RhdGUkc3BsaXQgPSBzdHJpbmdkYXRlLnNwbGl0KCItIiksCiAgICAgICAgICBfc3RyaW5nZGF0ZSRzcGxpdDIgPSBfc2xpY2VkVG9BcnJheShfc3RyaW5nZGF0ZSRzcGxpdCwgMyksCiAgICAgICAgICB5ZWFyID0gX3N0cmluZ2RhdGUkc3BsaXQyWzBdLAogICAgICAgICAgbW9udGggPSBfc3RyaW5nZGF0ZSRzcGxpdDJbMV0sCiAgICAgICAgICBkYXkgPSBfc3RyaW5nZGF0ZSRzcGxpdDJbMl07CgogICAgICByZXR1cm4gIiIuY29uY2F0KG1vbnRoLCAiLyIpLmNvbmNhdChkYXksICIvIikuY29uY2F0KHllYXIpOwogICAgfSwKICAgIHBhcnNlRGF0ZTogZnVuY3Rpb24gcGFyc2VEYXRlKGRhdGUpIHsKICAgICAgaWYgKCFkYXRlKSByZXR1cm4gbnVsbDsKCiAgICAgIHZhciBfZGF0ZSRzcGxpdCA9IGRhdGUuc3BsaXQoIi8iKSwKICAgICAgICAgIF9kYXRlJHNwbGl0MiA9IF9zbGljZWRUb0FycmF5KF9kYXRlJHNwbGl0LCAzKSwKICAgICAgICAgIG1vbnRoID0gX2RhdGUkc3BsaXQyWzBdLAogICAgICAgICAgZGF5ID0gX2RhdGUkc3BsaXQyWzFdLAogICAgICAgICAgeWVhciA9IF9kYXRlJHNwbGl0MlsyXTsKCiAgICAgIHJldHVybiAiIi5jb25jYXQoeWVhciwgIi0iKS5jb25jYXQobW9udGgucGFkU3RhcnQoMiwgIjAiKSwgIi0iKS5jb25jYXQoZGF5LnBhZFN0YXJ0KDIsICIwIikpOwogICAgfSwKICAgIGFkZFBheW1lbnQ6IGZ1bmN0aW9uIGFkZFBheW1lbnQoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgdmFyIF90aGlzNCRjb250YWN0T2JqLCBfdGhpczQkY2FzaW5vRGV0YWlscywgX3RoaXM0JGNhc2lub0RldGFpbHMkLCBfdGhpczQkY29udGFjdE9iajIsIF90aGlzNCR6b25lRGV0YWlscywgX3RoaXM0JHpvbmVEZXRhaWxzMiwgX2RldGFpbHMkZGF0YTsKCiAgICAgICAgdmFyIGV4aXREYXRlLCBleGl0VGltZSwgZXhpdERhdGVUaW1lLCBlbnRyeURhdGVUaW1lLCBjb21taXREYXRhLCBkZXRhaWxzLCBfZGV0YWlscyRkYXRhMiwgX2RldGFpbHMkZGF0YTgsIF9kZXRhaWxzJGRhdGE5LCBfdGhpczQkY2FzaW5vRGV0YWlsczIsIF90aGlzNCRjYXNpbm9EZXRhaWxzMywgX2RldGFpbHMkZGF0YTMsIF9kZXRhaWxzJGRhdGEzJGRhdGEsIF9kZXRhaWxzJGRhdGE0LCBfZGV0YWlscyRkYXRhNCRkYXRhLCBfZGV0YWlscyRkYXRhNSwgX2RldGFpbHMkZGF0YTUkZGF0YSwgX2RldGFpbHMkZGF0YTYsIF9kZXRhaWxzJGRhdGE2JGRhdGEsIF9jb21taXREYXRhLCBfZGV0YWlscyRkYXRhNywgX2RldGFpbHMkZGF0YTckZGF0YSwgdXJsOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgZXhpdERhdGUgPSBfdGhpczQudGltZSAhPSBudWxsIHx8IF90aGlzNC50aW1lICE9PSB1bmRlZmluZWQgfHwgX3RoaXM0LnRpbWUgIT0gIiIgPyBmb3JtYXQoX3RoaXM0LnRpbWUsICd5eXl5LU1NLWRkJykgOiBmb3JtYXQobmV3IERhdGUoKSwgJ3l5eXktTU0tZGQnKTsKICAgICAgICAgICAgICAgIGV4aXRUaW1lID0gX3RoaXM0LnRpbWUgIT0gbnVsbCB8fCBfdGhpczQudGltZSAhPT0gdW5kZWZpbmVkIHx8IF90aGlzNC50aW1lICE9ICIiID8gT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoX3RoaXM0LnpvbmVEZXRhaWxzLCAndGltZVBpY2tlckNvbmZpZ3VyYXRpb24nKSAmJiBfdGhpczQuem9uZURldGFpbHMudGltZVBpY2tlckNvbmZpZ3VyYXRpb24gPT0gMSA/IGZvcm1hdChfdGhpczQudGltZSwgJ2hoOm1tIGEnKSA6ICIxMTo1OSBQTSIgOiAiIjsKICAgICAgICAgICAgICAgIGV4aXREYXRlVGltZSA9IGV4aXREYXRlICsgIiAiICsgZXhpdFRpbWU7CiAgICAgICAgICAgICAgICBlbnRyeURhdGVUaW1lID0gX3RoaXM0LnpvbmVEZXRhaWxzLnRpbWV6b25lID8gZm9ybWF0KGRhdGVUb1RpbWVab25lRGF0ZShuZXcgRGF0ZSgpLCBfdGhpczQuem9uZURldGFpbHMudGltZXpvbmUpLCAieXl5eS1NTS1kZCBoaDptbSBhIikgOiBmb3JtYXQobmV3IERhdGUoKSwgInl5eXktTU0tZGQnVCdISDptbSBhIik7CiAgICAgICAgICAgICAgICBjb21taXREYXRhID0gewogICAgICAgICAgICAgICAgICBwbGF0ZTogX3RoaXM0LmxpY2VuY2VQbGF0ZSwKICAgICAgICAgICAgICAgICAgY29udGFjdDogKF90aGlzNCRjb250YWN0T2JqID0gX3RoaXM0LmNvbnRhY3RPYmopID09PSBudWxsIHx8IF90aGlzNCRjb250YWN0T2JqID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpczQkY29udGFjdE9iai5mb3JtYXR0ZWROdW1iZXIsCiAgICAgICAgICAgICAgICAgIGVudHJ5VGltZTogZW50cnlEYXRlVGltZSwKICAgICAgICAgICAgICAgICAgZWR0UGFyYW1zOiAoX3RoaXM0JGNhc2lub0RldGFpbHMgPSBfdGhpczQuY2FzaW5vRGV0YWlscykgPT09IG51bGwgfHwgX3RoaXM0JGNhc2lub0RldGFpbHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfdGhpczQkY2FzaW5vRGV0YWlscyQgPSBfdGhpczQkY2FzaW5vRGV0YWlscy51c2VyRGV0YWlsKSA9PT0gbnVsbCB8fCBfdGhpczQkY2FzaW5vRGV0YWlscyQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzNCRjYXNpbm9EZXRhaWxzJC5lZHRQYXJhbXMsCiAgICAgICAgICAgICAgICAgIGV4aXRUaW1lOiBleGl0RGF0ZVRpbWUsCiAgICAgICAgICAgICAgICAgIGVzdGltYXRlOiBfdGhpczQuZXN0aW1hdGUKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDc7CiAgICAgICAgICAgICAgICByZXR1cm4gQVBJSGVscGVyKCJQT1NUIiwgIi9hcGkvdjEvcHJlcGFpZC9vcGVuVHJhbnNhY3Rpb24iLCB7CiAgICAgICAgICAgICAgICAgIHZlaGljbGVObzogX3RoaXM0LmxpY2VuY2VQbGF0ZSwKICAgICAgICAgICAgICAgICAgY29udGFjdDogKF90aGlzNCRjb250YWN0T2JqMiA9IF90aGlzNC5jb250YWN0T2JqKSA9PT0gbnVsbCB8fCBfdGhpczQkY29udGFjdE9iajIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzNCRjb250YWN0T2JqMi5mb3JtYXR0ZWROdW1iZXIsCiAgICAgICAgICAgICAgICAgIGV4aXRUaW1lOiBleGl0RGF0ZVRpbWUsCiAgICAgICAgICAgICAgICAgIHpjb2RlOiAoX3RoaXM0JHpvbmVEZXRhaWxzID0gX3RoaXM0LnpvbmVEZXRhaWxzKSA9PT0gbnVsbCB8fCBfdGhpczQkem9uZURldGFpbHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzNCR6b25lRGV0YWlscy56Y29kZSwKICAgICAgICAgICAgICAgICAgbWlkOiAoX3RoaXM0JHpvbmVEZXRhaWxzMiA9IF90aGlzNC56b25lRGV0YWlscykgPT09IG51bGwgfHwgX3RoaXM0JHpvbmVEZXRhaWxzMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXM0JHpvbmVEZXRhaWxzMi5taWQsCiAgICAgICAgICAgICAgICAgIGV2ZW50VHlwZTogIlBhaWRIb3N0UGFzcyIKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICBkZXRhaWxzID0gX2NvbnRleHQ0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKGRldGFpbHMgIT09IG51bGwgJiYgZGV0YWlscyAhPT0gdm9pZCAwICYmIChfZGV0YWlscyRkYXRhID0gZGV0YWlscy5kYXRhKSAhPT0gbnVsbCAmJiBfZGV0YWlscyRkYXRhICE9PSB2b2lkIDAgJiYgX2RldGFpbHMkZGF0YS5zdGF0dXMpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM0LiRzdG9yZS5jb21taXQoIlNFVF9DQVNJTk9fVVNFUkRFVEFJTFMiLCBjb21taXREYXRhKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzNC4kcm91dGVyLnJlcGxhY2UoewogICAgICAgICAgICAgICAgICAgIHBhdGg6ICIvcHJlcGFpZGhvc3QvbWFrZXBheW1lbnQiCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgaWYgKChkZXRhaWxzID09PSBudWxsIHx8IGRldGFpbHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZGV0YWlscyRkYXRhMiA9IGRldGFpbHMuZGF0YSkgPT09IG51bGwgfHwgX2RldGFpbHMkZGF0YTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kZXRhaWxzJGRhdGEyLm1lc3NhZ2UpID09ICJCb29raW5nIEFscmVhZHkgRXhpc3RzIikgewogICAgICAgICAgICAgICAgICAgIF9jb21taXREYXRhID0gewogICAgICAgICAgICAgICAgICAgICAgcGxhdGU6IF90aGlzNC5saWNlbmNlUGxhdGUsCiAgICAgICAgICAgICAgICAgICAgICBjb250YWN0OiBfdGhpczQuY29udGFjdE9iai5mb3JtYXR0ZWROdW1iZXIsCiAgICAgICAgICAgICAgICAgICAgICBlbnRyeVRpbWU6IGVudHJ5RGF0ZVRpbWUsCiAgICAgICAgICAgICAgICAgICAgICBlZHRQYXJhbXM6IChfdGhpczQkY2FzaW5vRGV0YWlsczIgPSBfdGhpczQuY2FzaW5vRGV0YWlscykgPT09IG51bGwgfHwgX3RoaXM0JGNhc2lub0RldGFpbHMyID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3RoaXM0JGNhc2lub0RldGFpbHMzID0gX3RoaXM0JGNhc2lub0RldGFpbHMyLnVzZXJEZXRhaWwpID09PSBudWxsIHx8IF90aGlzNCRjYXNpbm9EZXRhaWxzMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXM0JGNhc2lub0RldGFpbHMzLmVkdFBhcmFtcywKICAgICAgICAgICAgICAgICAgICAgIGV4aXRUaW1lOiBleGl0RGF0ZVRpbWUsCiAgICAgICAgICAgICAgICAgICAgICBlc3RpbWF0ZTogX3RoaXM0LmVzdGltYXRlLAogICAgICAgICAgICAgICAgICAgICAgYmlkOiBkZXRhaWxzID09PSBudWxsIHx8IGRldGFpbHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZGV0YWlscyRkYXRhMyA9IGRldGFpbHMuZGF0YSkgPT09IG51bGwgfHwgX2RldGFpbHMkZGF0YTMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZGV0YWlscyRkYXRhMyRkYXRhID0gX2RldGFpbHMkZGF0YTMuZGF0YSkgPT09IG51bGwgfHwgX2RldGFpbHMkZGF0YTMkZGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2RldGFpbHMkZGF0YTMkZGF0YS5iaWQKICAgICAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgICAgICBpZiAoKGRldGFpbHMgPT09IG51bGwgfHwgZGV0YWlscyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9kZXRhaWxzJGRhdGE0ID0gZGV0YWlscy5kYXRhKSA9PT0gbnVsbCB8fCBfZGV0YWlscyRkYXRhNCA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9kZXRhaWxzJGRhdGE0JGRhdGEgPSBfZGV0YWlscyRkYXRhNC5kYXRhKSA9PT0gbnVsbCB8fCBfZGV0YWlscyRkYXRhNCRkYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZGV0YWlscyRkYXRhNCRkYXRhLmNhcmRPbkZpbGUpID09IDAgfHwgKGRldGFpbHMgPT09IG51bGwgfHwgZGV0YWlscyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9kZXRhaWxzJGRhdGE1ID0gZGV0YWlscy5kYXRhKSA9PT0gbnVsbCB8fCBfZGV0YWlscyRkYXRhNSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9kZXRhaWxzJGRhdGE1JGRhdGEgPSBfZGV0YWlscyRkYXRhNS5kYXRhKSA9PT0gbnVsbCB8fCBfZGV0YWlscyRkYXRhNSRkYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZGV0YWlscyRkYXRhNSRkYXRhLmNhcmRPbkZpbGUpID09IDIpIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzNC4kc3RvcmUuY29tbWl0KCJTRVRfQ0FTSU5PX1VTRVJERVRBSUxTIiwgX2NvbW1pdERhdGEpOwoKICAgICAgICAgICAgICAgICAgICAgIF90aGlzNC4kcm91dGVyLnJlcGxhY2UoewogICAgICAgICAgICAgICAgICAgICAgICBwYXRoOiAiL3ByZXBhaWRob3N0L21ha2VwYXltZW50IgogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoZGV0YWlscyA9PT0gbnVsbCB8fCBkZXRhaWxzID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2RldGFpbHMkZGF0YTYgPSBkZXRhaWxzLmRhdGEpID09PSBudWxsIHx8IF9kZXRhaWxzJGRhdGE2ID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2RldGFpbHMkZGF0YTYkZGF0YSA9IF9kZXRhaWxzJGRhdGE2LmRhdGEpID09PSBudWxsIHx8IF9kZXRhaWxzJGRhdGE2JGRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kZXRhaWxzJGRhdGE2JGRhdGEuY2FyZE9uRmlsZSkgPT0gMSkgewogICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy4kc3RvcmUuY29tbWl0KCJTRVRfQ0FTSU5PX1VTRVJERVRBSUxTIiwgY29tbWl0RGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIucmVwbGFjZSh7IHBhdGg6ICIvcHJlcGFpZGhvc3Qvb2RSZWNlaXB0IiB9KTsKICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4gKyAiL2cvIiArIChkZXRhaWxzID09PSBudWxsIHx8IGRldGFpbHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZGV0YWlscyRkYXRhNyA9IGRldGFpbHMuZGF0YSkgPT09IG51bGwgfHwgX2RldGFpbHMkZGF0YTcgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZGV0YWlscyRkYXRhNyRkYXRhID0gX2RldGFpbHMkZGF0YTcuZGF0YSkgPT09IG51bGwgfHwgX2RldGFpbHMkZGF0YTckZGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2RldGFpbHMkZGF0YTckZGF0YS5iaWQpOwogICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UodXJsKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIF90aGlzNC5hbGVydE1zZyA9IGRldGFpbHMgIT09IG51bGwgJiYgZGV0YWlscyAhPT0gdm9pZCAwICYmIChfZGV0YWlscyRkYXRhOCA9IGRldGFpbHMuZGF0YSkgIT09IG51bGwgJiYgX2RldGFpbHMkZGF0YTggIT09IHZvaWQgMCAmJiBfZGV0YWlscyRkYXRhOC5tZXNzYWdlID8gZGV0YWlscyA9PT0gbnVsbCB8fCBkZXRhaWxzID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2RldGFpbHMkZGF0YTkgPSBkZXRhaWxzLmRhdGEpID09PSBudWxsIHx8IF9kZXRhaWxzJGRhdGE5ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZGV0YWlscyRkYXRhOS5tZXNzYWdlIDogIiI7CiAgICAgICAgICAgICAgICAgIF90aGlzNC5hbGVydERpYWxvZyA9IHRydWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHVwcGVyY2FzZTogZnVuY3Rpb24gdXBwZXJjYXNlKCkgewogICAgICBpZiAocnVsZXMuYWxwaGFOdW1lcmljKHRoaXMubGljZW5jZVBsYXRlKSA9PT0gIk11c3QgYmUgYWxwaGFudW1lcmljIikgewogICAgICAgIHRoaXMubGljZW5jZVBsYXRlID0gdGhpcy5saWNlbmNlUGxhdGUucmVwbGFjZSgvW15cd1xzXS9naSwgJycpOwogICAgICB9CgogICAgICB0aGlzLmxpY2VuY2VQbGF0ZSA9IHRoaXMubGljZW5jZVBsYXRlLnRyaW0oKTsKICAgICAgdGhpcy5saWNlbmNlUGxhdGUgPSB0aGlzLmxpY2VuY2VQbGF0ZS50b1VwcGVyQ2FzZSgpOwogICAgfSwKCiAgICAvKioKICAgICAqIEBtZXRob2QgZ2V0Wm9uZURldGFpbHMgZmV0Y2ggdGhlIHpvbmUgZGV0YWlscyBhbmQgY29tbWl0IFNFVF9aT05FX0RFVEFJTFMgbXV0YXRpb24uCiAgICAgKi8KICAgIGdldFpvbmVEZXRhaWxzOiBmdW5jdGlvbiBnZXRab25lRGV0YWlscyhzZWFyY2hQYXJhbUtleSwgc2VhcmNoUGFyYW1WYWx1ZSkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgIHZhciBfem9uZURldGFpbHMkZGF0YSwgem9uZURldGFpbHM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDUucHJldiA9IDA7CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gQVBJSGVscGVyKCJHRVQiLCAiL2FwaS92MS91c2VyL2NvbmZpZyIgKyBzZWFyY2hQYXJhbUtleSArICI9IiArIHNlYXJjaFBhcmFtVmFsdWUpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICB6b25lRGV0YWlscyA9IF9jb250ZXh0NS5zZW50OwoKICAgICAgICAgICAgICAgIF90aGlzNS4kc3RvcmUuY29tbWl0KCJTRVRfWk9ORV9ERVRBSUxTIiwgKF96b25lRGV0YWlscyRkYXRhID0gem9uZURldGFpbHMuZGF0YSkgPT09IG51bGwgfHwgX3pvbmVEZXRhaWxzJGRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF96b25lRGV0YWlscyRkYXRhLnpvbmUpOwoKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgX2NvbnRleHQ1LnByZXYgPSA3OwogICAgICAgICAgICAgICAgX2NvbnRleHQ1LnQwID0gX2NvbnRleHQ1WyJjYXRjaCJdKDApOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coX2NvbnRleHQ1LnQwKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNSwgbnVsbCwgW1swLCA3XV0pOwogICAgICB9KSkoKTsKICAgIH0sCgogICAgLyoqCiAgICAgKiBAbWV0aG9kIGdldE9uRGVtYW5kWm9uZURldGFpbHMgZmV0Y2ggdGhlIG9uZGVtYW5kIHpvbmUgZGV0YWlscyBmcm9tIFBjb20gYW5kIGNvbW1pdCBTRVRfWk9ORV9ERVRBSUxTIG11dGF0aW9uLgogICAgICovCiAgICBnZXRPbkRlbWFuZFpvbmVEZXRhaWxzOiBmdW5jdGlvbiBnZXRPbkRlbWFuZFpvbmVEZXRhaWxzKHNlYXJjaFBhcmFtVmFsdWUpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgICAgICB2YXIgX3pvbmVEZXRhaWxzJGRhdGEyLCB6b25lRGV0YWlscywgX3pvbmVEZXRhaWxzJGRhdGEzLCBfem9uZURldGFpbHMkZGF0YTQ7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczYubG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDE7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gQVBJSGVscGVyKCJHRVQiLCAiL2FwaS92MS9nZXRPbkRlbWFuZC8iICsgc2VhcmNoUGFyYW1WYWx1ZSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIHpvbmVEZXRhaWxzID0gX2NvbnRleHQ2LnNlbnQ7CiAgICAgICAgICAgICAgICBfdGhpczYubG9hZGluZyA9IGZhbHNlOwoKICAgICAgICAgICAgICAgIGlmICgoX3pvbmVEZXRhaWxzJGRhdGEyID0gem9uZURldGFpbHMuZGF0YSkgIT09IG51bGwgJiYgX3pvbmVEZXRhaWxzJGRhdGEyICE9PSB2b2lkIDAgJiYgX3pvbmVEZXRhaWxzJGRhdGEyLmxvdCkgewogICAgICAgICAgICAgICAgICBfdGhpczYuJHN0b3JlLmNvbW1pdCgiU0VUX09OX0RFTUFORF9aT05FX0RFVEFJTFMiLCAoX3pvbmVEZXRhaWxzJGRhdGEzID0gem9uZURldGFpbHMuZGF0YSkgPT09IG51bGwgfHwgX3pvbmVEZXRhaWxzJGRhdGEzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfem9uZURldGFpbHMkZGF0YTMubG90KTsKCiAgICAgICAgICAgICAgICAgIF90aGlzNi5zZXREYXRlUGlja2VyKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczYuYWxlcnRNc2cgPSAoem9uZURldGFpbHMgPT09IG51bGwgfHwgem9uZURldGFpbHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfem9uZURldGFpbHMkZGF0YTQgPSB6b25lRGV0YWlscy5kYXRhKSA9PT0gbnVsbCB8fCBfem9uZURldGFpbHMkZGF0YTQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF96b25lRGV0YWlscyRkYXRhNC5tZXNzYWdlKSB8fCAiRXJyb3IgaW4gbG9hZGluZyBsb2NhdGlvbiBkZXRhaWxzLiI7CiAgICAgICAgICAgICAgICAgIF90aGlzNi5hbGVydERpYWxvZyA9IHRydWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAxMzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDk7CiAgICAgICAgICAgICAgICBfY29udGV4dDYudDAgPSBfY29udGV4dDZbImNhdGNoIl0oMSk7CiAgICAgICAgICAgICAgICBfdGhpczYubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coX2NvbnRleHQ2LnQwKTsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNiwgbnVsbCwgW1sxLCA5XV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBvbkNvbnRhY3RJbnB1dDogZnVuY3Rpb24gb25Db250YWN0SW5wdXQoY29udGFjdERldGFpbHMpIHsKICAgICAgdGhpcy5pc0NvbnRhY3RWYWxpZCA9IGNvbnRhY3REZXRhaWxzID09PSBudWxsIHx8IGNvbnRhY3REZXRhaWxzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb250YWN0RGV0YWlscy5pc1ZhbGlkOwogICAgICB0aGlzLmNvbnRhY3RPYmogPSBPYmplY3QuYXNzaWduKHt9LCBjb250YWN0RGV0YWlscyk7CiAgICB9LAogICAgc2V0UmVlbnRlclBsYXRlRmxhZzogZnVuY3Rpb24gc2V0UmVlbnRlclBsYXRlRmxhZygpIHsKICAgICAgdGhpcy5saWNlbmNlUGxhdGUgPSB0aGlzLnNlbGVjdGVkUGxhdGUgfHwgIiI7CiAgICAgIHRoaXMucmVFbnRlclBsYXRlID0gdHJ1ZTsKICAgICAgdGhpcy5jb25maXJtQ3JlYXRlU2Vzc2lvbkRpYWxvZyA9IGZhbHNlOwogICAgfSwKCiAgICAvKioKICAgICAqIEBtZXRob2QgY3JlYXRlU2Vzc2lvbiBGZXRjaCBib29raW5nIGlkIG9uIGFkZCBib29raW5nIGFuZCBmZXRjaCB0aGUgYm9va2luZyBpbmZvLgogICAgICovCiAgICBjcmVhdGVTZXNzaW9uOiBmdW5jdGlvbiBjcmVhdGVTZXNzaW9uKCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KCkgewogICAgICAgIHZhciBfdGhpczckY29udGFjdE9iaiwgX3RoaXM3JGNvbnRhY3RPYmoyOwoKICAgICAgICB2YXIgcG9zdE9iaiwgX3Nlc3Npb24kZGF0YSwgX3RoaXM3JGNvbnRhY3RPYmo0LCBfdGhpczckY29udGFjdE9iajUsIHNlc3Npb24sIGJpZCwgX3Nlc3Npb24kZGF0YTIsIF9zZXNzaW9uJGRhdGEzLCBfdGhpczckY29udGFjdE9iajMsIHVybDsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzNy5hZGRMaWNlbmNlUGxhdGVCdG5Mb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHBvc3RPYmogPSB7CiAgICAgICAgICAgICAgICAgIGNvbnRhY3Q6IChfdGhpczckY29udGFjdE9iaiA9IF90aGlzNy5jb250YWN0T2JqKSA9PT0gbnVsbCB8fCBfdGhpczckY29udGFjdE9iaiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXM3JGNvbnRhY3RPYmouZm9ybWF0dGVkTnVtYmVyLAogICAgICAgICAgICAgICAgICB1bmlxdWVJRDogKF90aGlzNyRjb250YWN0T2JqMiA9IF90aGlzNy5jb250YWN0T2JqKSA9PT0gbnVsbCB8fCBfdGhpczckY29udGFjdE9iajIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzNyRjb250YWN0T2JqMi5uYXRpb25hbE51bWJlciwKICAgICAgICAgICAgICAgICAgdmVoaWNsZU5vOiBfdGhpczcubGljZW5jZVBsYXRlLnRvVXBwZXJDYXNlKCksCiAgICAgICAgICAgICAgICAgIGxvY2F0aW9uQ29kZTogX3RoaXM3LnpvbmVEZXRhaWxzLnpjb2RlLAogICAgICAgICAgICAgICAgICB6aWQ6IF90aGlzNy56b25lRGV0YWlscy56aWQsCiAgICAgICAgICAgICAgICAgIGVudHJ5dGltZTogZm9ybWF0KG5ldyBEYXRlKG5ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoImVuLVVTIiwgewogICAgICAgICAgICAgICAgICAgIHRpbWVab25lOiBfdGhpczcuem9uZURldGFpbHMudGltZXpvbmUKICAgICAgICAgICAgICAgICAgfSkpLCAieXl5eS1NTS1kZCBISDptbTpzcyIpLAogICAgICAgICAgICAgICAgICBzb3VyY2U6ICJhcHBjbGlwIiwKICAgICAgICAgICAgICAgICAgd2ViVmlldzogIjEiLAogICAgICAgICAgICAgICAgICB0eXBlOiAiMiIsCiAgICAgICAgICAgICAgICAgIHN0YXRlOiAyLAogICAgICAgICAgICAgICAgICBwYXltZW50X3N0YXR1czogMCwKICAgICAgICAgICAgICAgICAgdHhuSURfYWRkQ0M6IDAKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgaWYgKF90aGlzNy5yZUVudGVyUGxhdGUpIHsKICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihwb3N0T2JqLCB7CiAgICAgICAgICAgICAgICAgICAgY3JlYXRlTmV3U2Vzc2lvbjogMQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDcucHJldiA9IDM7CiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDY7CiAgICAgICAgICAgICAgICByZXR1cm4gQVBJSGVscGVyKCJQT1NUIiwgIi9hcGkvdjEvYWRkQm9va2luZyIsIHBvc3RPYmopOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBzZXNzaW9uID0gX2NvbnRleHQ3LnNlbnQ7CiAgICAgICAgICAgICAgICBiaWQgPSBzZXNzaW9uID09PSBudWxsIHx8IHNlc3Npb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfc2Vzc2lvbiRkYXRhID0gc2Vzc2lvbi5kYXRhKSA9PT0gbnVsbCB8fCBfc2Vzc2lvbiRkYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfc2Vzc2lvbiRkYXRhLnJlZm5vOwoKICAgICAgICAgICAgICAgIGlmICghKHNlc3Npb24uZGF0YS5zdGF0dXMgPT09IGZhbHNlKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczcuZXJyTXNnID0gc2Vzc2lvbiAhPT0gbnVsbCAmJiBzZXNzaW9uICE9PSB2b2lkIDAgJiYgKF9zZXNzaW9uJGRhdGEyID0gc2Vzc2lvbi5kYXRhKSAhPT0gbnVsbCAmJiBfc2Vzc2lvbiRkYXRhMiAhPT0gdm9pZCAwICYmIF9zZXNzaW9uJGRhdGEyLm1lc3NhZ2UgPyBzZXNzaW9uLmRhdGEubWVzc2FnZSA6ICIiOwoKICAgICAgICAgICAgICAgIGlmICghKHNlc3Npb24gIT09IG51bGwgJiYgc2Vzc2lvbiAhPT0gdm9pZCAwICYmIChfc2Vzc2lvbiRkYXRhMyA9IHNlc3Npb24uZGF0YSkgIT09IG51bGwgJiYgX3Nlc3Npb24kZGF0YTMgIT09IHZvaWQgMCAmJiBfc2Vzc2lvbiRkYXRhMy5zaG93Q3JlYXRlTmV3U2Vzc2lvblBvcHVwICYmIHNlc3Npb24uZGF0YS5zaG93Q3JlYXRlTmV3U2Vzc2lvblBvcHVwID09IDEpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzNy5wb3N0VG9Mb2dnZXJBUEkoewogICAgICAgICAgICAgICAgICBwaG9uZTogKF90aGlzNyRjb250YWN0T2JqMyA9IF90aGlzNy5jb250YWN0T2JqKSA9PT0gbnVsbCB8fCBfdGhpczckY29udGFjdE9iajMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzNyRjb250YWN0T2JqMy5uYXRpb25hbE51bWJlciwKICAgICAgICAgICAgICAgICAgcGxhdGU6IF90aGlzNy5saWNlbmNlUGxhdGUudG9VcHBlckNhc2UoKSwKICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogIlBhcmtlciBzZXNzaW9uIG5vdCBmb3VuZCBpbiB0aGUgc3lzdGVtLiIKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIF90aGlzNy5jb25maXJtQ3JlYXRlU2Vzc2lvbkRpYWxvZyA9IHRydWU7CiAgICAgICAgICAgICAgICBfdGhpczcuYWRkTGljZW5jZVBsYXRlQnRuTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgX3RoaXM3LmVyckRpYWxvZyA9IHRydWU7CiAgICAgICAgICAgICAgICBfdGhpczcuYWRkTGljZW5jZVBsYXRlQnRuTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyMDsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczcuZ2V0Qm9va2luZ0RldGFpbHMoYmlkKTsKCiAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICAgIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4gKyAiL2cvIiArIGJpZDsKICAgICAgICAgICAgICAgIF90aGlzNy5hZGRMaWNlbmNlUGxhdGVCdG5Mb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICBfdGhpczcucmVFbnRlclBsYXRlID8gX3RoaXM3LnBvc3RUb0xvZ2dlckFQSSh7CiAgICAgICAgICAgICAgICAgIHBob25lOiAoX3RoaXM3JGNvbnRhY3RPYmo0ID0gX3RoaXM3LmNvbnRhY3RPYmopID09PSBudWxsIHx8IF90aGlzNyRjb250YWN0T2JqNCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXM3JGNvbnRhY3RPYmo0Lm5hdGlvbmFsTnVtYmVyLAogICAgICAgICAgICAgICAgICByZWZJZDogYmlkLAogICAgICAgICAgICAgICAgICBpY29uOiAibG9naW4iLAogICAgICAgICAgICAgICAgICBwbGF0ZTogX3RoaXM3LmxpY2VuY2VQbGF0ZS50b1VwcGVyQ2FzZSgpLAogICAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OiAiUGFya2VyIHBsYXRlL2NvbnRhY3QgbnVtYmVyIG5vdCBmb3VuZCBpbiB0aGUgc3lzdGVtLiBQYXJrZXIgY3JlYXRlZCBhIG5ldyBzZXNzaW9uIHVzaW5nIGdlbmVyaWMgcGF5bWVudCBRUiIKICAgICAgICAgICAgICAgIH0pIDogX3RoaXM3LnBvc3RUb0xvZ2dlckFQSSh7CiAgICAgICAgICAgICAgICAgIHBob25lOiAoX3RoaXM3JGNvbnRhY3RPYmo1ID0gX3RoaXM3LmNvbnRhY3RPYmopID09PSBudWxsIHx8IF90aGlzNyRjb250YWN0T2JqNSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXM3JGNvbnRhY3RPYmo1Lm5hdGlvbmFsTnVtYmVyLAogICAgICAgICAgICAgICAgICByZWZJZDogYmlkLAogICAgICAgICAgICAgICAgICBpY29uOiAibG9naW4iLAogICAgICAgICAgICAgICAgICBwbGF0ZTogX3RoaXM3LmxpY2VuY2VQbGF0ZS50b1VwcGVyQ2FzZSgpLAogICAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OiAiUGFya2VyIHNlc3Npb24gZm91bmQuIFBhcmtlciBvcGVuZWQgaGlzL2hlciBzZXNzaW9uIHVzaW5nIGdlbmVyaWMgcGF5bWVudCBRUiIKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UodXJsKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMzA7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyNjoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5wcmV2ID0gMjY7CiAgICAgICAgICAgICAgICBfY29udGV4dDcudDAgPSBfY29udGV4dDdbImNhdGNoIl0oMyk7CiAgICAgICAgICAgICAgICBfdGhpczcuYWRkTGljZW5jZVBsYXRlQnRuTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coX2NvbnRleHQ3LnQwKTsKCiAgICAgICAgICAgICAgY2FzZSAzMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNywgbnVsbCwgW1szLCAyNl1dKTsKICAgICAgfSkpKCk7CiAgICB9LAoKICAgIC8qKgogICAgICogQG1ldGhvZCBnZXRCb29raW5nRGV0YWlscyBmZXRjaCB0aGUgYm9va2luZyBkZXRhaWxzIGFuZCBjb21taXQgU0VUX0JPT0tJTkdfREVUQUlMUyBtdXRhdGlvbi4KICAgICAqLwogICAgZ2V0Qm9va2luZ0RldGFpbHM6IGZ1bmN0aW9uIGdldEJvb2tpbmdEZXRhaWxzKGJvb2tpbmdJZCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KCkgewogICAgICAgIHZhciBfYm9va2luZ0RldGFpbHMkZGF0YSwgYm9va2luZ0RldGFpbHM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDgucHJldiA9IDA7CiAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gQVBJSGVscGVyKCJHRVQiLCAiL2FwaS92MS9ib29raW5nL2NvbmZpZy8iICsgYm9va2luZ0lkKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgYm9va2luZ0RldGFpbHMgPSBfY29udGV4dDguc2VudDsKCiAgICAgICAgICAgICAgICBfdGhpczguJHN0b3JlLmNvbW1pdCgiU0VUX0JPT0tJTkdfREVUQUlMUyIsIChfYm9va2luZ0RldGFpbHMkZGF0YSA9IGJvb2tpbmdEZXRhaWxzLmRhdGEpICE9PSBudWxsICYmIF9ib29raW5nRGV0YWlscyRkYXRhICE9PSB2b2lkIDAgJiYgX2Jvb2tpbmdEZXRhaWxzJGRhdGEuZGF0YSA/IGJvb2tpbmdEZXRhaWxzLmRhdGEuZGF0YSA6IG51bGwpOwoKICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgX2NvbnRleHQ4LnByZXYgPSA3OwogICAgICAgICAgICAgICAgX2NvbnRleHQ4LnQwID0gX2NvbnRleHQ4WyJjYXRjaCJdKDApOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coX2NvbnRleHQ4LnQwKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOCwgbnVsbCwgW1swLCA3XV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBjbG9zZUNvbmZpcm1DcmVhdGVTZXNzaW9uRGlhbG9nOiBmdW5jdGlvbiBjbG9zZUNvbmZpcm1DcmVhdGVTZXNzaW9uRGlhbG9nKCkgewogICAgICB0aGlzLmNvbmZpcm1DcmVhdGVTZXNzaW9uRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuYWRkTGljZW5jZVBsYXRlQnRuTG9hZGluZyA9IGZhbHNlOwogICAgfQogIH0KfTs="},null]}